"use strict";(self.webpackChunkadguard_knowledge_base=self.webpackChunkadguard_knowledge_base||[]).push([[8621],{4137:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>c});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),k=s(a),c=i,u=k["".concat(p,".").concat(c)]||k[c]||m[c]||r;return a?n.createElement(u,l(l({ref:t},d),{},{components:a})):n.createElement(u,l({ref:t},d))}));function c(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=k;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var s=2;s<r;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},830:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var n=a(7462),i=(a(7294),a(4137));const r={title:"How to create your own ad filters",sidebar_position:5,toc_min_heading_level:2,toc_max_heading_level:4},l=void 0,o={unversionedId:"general/ad-filtering/create-own-filters",id:"general/ad-filtering/create-own-filters",title:"How to create your own ad filters",description:"\uc774 \uae00\uc5d0\uc11c\ub294 AdGuard \uc81c\ud488\uc5d0\uc11c \uc0ac\uc6a9\uc790 \uc815\uc758 \ud544\ud130\ub9c1 \uaddc\uce59\uc744 \uc791\uc131\ud558\ub294 \ubc29\ubc95\uc744 \uc54c\ub824\ub4dc\ub9bd\ub2c8\ub2e4. To test your rules, you can download the AdGuard app",source:"@site/i18n/ko/docusaurus-plugin-content-docs/current/general/ad-filtering/create-own-filters.md",sourceDirName:"general/ad-filtering",slug:"/general/ad-filtering/create-own-filters",permalink:"/KnowledgeBase/ko/general/ad-filtering/create-own-filters",draft:!1,editUrl:"https://github.com/AdguardTeam/KnowledgeBase/edit/master/docs/general/ad-filtering/create-own-filters.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"How to create your own ad filters",sidebar_position:5,toc_min_heading_level:2,toc_max_heading_level:4},sidebar:"tutorialSidebar",previous:{title:"Tracking filter rules statistics",permalink:"/KnowledgeBase/ko/general/ad-filtering/tracking-filter-statistics"},next:{title:"AdGuard \ud544\ud130 \uc815\ucc45",permalink:"/KnowledgeBase/ko/general/ad-filtering/filter-policy"}},p={},s=[{value:"Comments",id:"comments",level:2},{value:"Examples",id:"examples",level:2},{value:"Blocking by domain name",id:"blocking-by-domain-name",level:3},{value:"Blocking exact address",id:"blocking-exact-address",level:3},{value:"Basic rule modifiers",id:"basic-rule-modifiers",level:3},{value:"Unblocking an address",id:"unblocking-an-address",level:3},{value:"Unblocking an entire website",id:"unblocking-an-entire-website",level:3},{value:"Cosmetic rule",id:"cosmetic-rule",level:3},{value:"Restrictions and limitations",id:"restrictions-and-limitations",level:2},{value:"Trusted filters",id:"trusted-filters",level:3},{value:"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30",id:"adguard-\ucf58\ud150\uce20-\ucc28\ub2e8\uae30",level:3},{value:"Basic rules",id:"basic-rules",level:2},{value:"Basic rule syntax",id:"basic-rules-syntax",level:3},{value:"Special characters",id:"basic-rules-special-characters",level:3},{value:"Regular expressions support",id:"regexp-support",level:3},{value:"Wildcard support for TLD (top-level domains)",id:"wildcard-for-tld",level:3},{value:"Basic rule examples",id:"basic-rule-examples",level:3},{value:"Basic rule modifiers",id:"basic-rule-modifiers",level:3},{value:"Basic modifiers",id:"basic-rules-basic-modifiers",level:3},{value:"<strong><code>$app</code></strong>",id:"app-modifier",level:4},{value:"<strong><code>$denyallow</code></strong>",id:"denyallow-modifier",level:4},{value:"<strong><code>$domain</code></strong>",id:"domain-modifier",level:4},{value:"<code>$domain</code> modifier limitations",id:"domain-modifier-limitations",level:5},{value:"<strong><code>$header</code></strong>",id:"header-modifier",level:4},{value:"<strong><code>$important</code></strong>",id:"important-modifier",level:4},{value:"<strong><code>$match-case</code></strong>",id:"match-case-modifier",level:4},{value:"<strong><code>$method</code></strong>",id:"method-modifier",level:4},{value:"<strong><code>$popup</code></strong>",id:"popup-modifier",level:4},{value:"<strong><code>$third-party</code></strong>",id:"third-party-modifier",level:4},{value:"<strong><code>$to</code></strong>",id:"to-modifier",level:4},{value:"Content-type modifiers",id:"content-type-modifiers",level:3},{value:"<strong><code>$document</code></strong>",id:"document-modifier",level:4},{value:"<strong><code>$font</code></strong>",id:"font-modifier",level:4},{value:"<strong><code>$image</code></strong>",id:"image-modifier",level:4},{value:"<strong><code>$media</code></strong>",id:"media-modifier",level:4},{value:"<strong><code>$object</code></strong>",id:"object-modifier",level:4},{value:"<strong><code>$other</code></strong>",id:"other-modifier",level:4},{value:"<strong><code>$ping</code></strong>",id:"ping-modifier",level:4},{value:"<strong><code>$script</code></strong>",id:"script-modifier",level:4},{value:"<strong><code>$stylesheet</code></strong>",id:"stylesheet-modifier",level:4},{value:"<strong><code>$subdocument</code></strong>",id:"subdocument-modifier",level:4},{value:"<strong><code>$websocket</code></strong>",id:"websocket-modifier",level:4},{value:"<strong><code>$xmlhttprequest</code></strong>",id:"xmlhttprequest-modifier",level:4},{value:"<strong><code>$object-subrequest</code> (removed)</strong>",id:"object-subrequest-modifier",level:4},{value:"<strong><code>$webrtc</code> (removed)</strong>",id:"webrtc-modifier",level:4},{value:"Exception rules modifiers",id:"exception-modifiers",level:3},{value:"<strong><code>$content</code></strong>",id:"content-modifier",level:4},{value:"<strong><code>$elemhide</code></strong>",id:"elemhide-modifier",level:4},{value:"<strong><code>$extension</code></strong>",id:"extension-modifier",level:4},{value:"<strong><code>$jsinject</code></strong>",id:"jsinject-modifier",level:4},{value:"<strong><code>$stealth</code></strong>",id:"stealth-modifier",level:4},{value:"<strong><code>$urlblock</code></strong>",id:"urlblock-modifier",level:4},{value:"Generic rules",id:"exception-modifiers-generic-rules",level:4},{value:"<strong><code>$genericblock</code></strong>",id:"genericblock-modifier",level:4},{value:"<strong><code>$generichide</code></strong>",id:"generichide-modifier",level:4},{value:"<strong><code>specifichide</code></strong>",id:"specifichide-modifier",level:4},{value:"Advanced capabilities",id:"advanced-modifiers",level:3},{value:"<strong><code>$all</code></strong>",id:"all-modifier",level:4},{value:"<strong><code>$badfilter</code></strong>",id:"badfilter-modifier",level:4},{value:"<strong><code>$cookie</code></strong>",id:"cookie-modifier",level:4},{value:"<strong><code>$csp</code></strong>",id:"csp-modifier",level:4},{value:"<strong><code>$hls</code></strong>",id:"hls-modifier",level:4},{value:"<strong><code>$inline-script</code></strong>",id:"inline-script-modifier",level:4},{value:"<strong><code>$inline-font</code></strong>",id:"inline-font-modifier",level:4},{value:"<strong><code>$jsonprune</code></strong>",id:"jsonprune-modifier",level:4},{value:"<strong><code>$xmlprune</code></strong>",id:"xmlprune-modifier",level:4},{value:"<strong><code>$network</code></strong>",id:"network-modifier",level:4},{value:"<strong><code>$permissions</code></strong>",id:"permissions-modifier",level:4},{value:"<code>$permissions</code> modifier limitations",id:"permissions-modifier-limitations",level:5},{value:"<strong><code>$redirect</code></strong>",id:"redirect-modifier",level:4},{value:"Disabling <code>$redirect</code> rules",id:"disabling-redirect-rules",level:5},{value:"Priorities of <code>$redirect</code> rules",id:"redirect-rule-priorities",level:5},{value:"<strong><code>$redirect-rule</code></strong>",id:"redirect-rule-modifier",level:4},{value:"<strong><code>$referrerpolicy</code></strong>",id:"referrerpolicy-modifier",level:4},{value:"<strong><code>$removeheader</code></strong>",id:"removeheader-modifier",level:4},{value:"<strong><code>$removeparam</code></strong>",id:"removeparam-modifier",level:4},{value:"<strong><code>$replace</code></strong>",id:"replace-modifier",level:4},{value:"<strong><code>urltransform</code></strong>",id:"urltransform-modifier",level:4},{value:"<strong><code>noop</code></strong>",id:"noop-modifier",level:4},{value:"<strong><code>$empty</code> (deprecated)</strong>",id:"empty-modifier",level:4},{value:"<strong><code>$mp4</code> (deprecated)</strong>",id:"mp4-modifier",level:4},{value:"Rule priorities",id:"rule-priorities",level:3},{value:"Priority calculation",id:"priority-calculation",level:4},{value:"Basic modifiers, the presence of each adds 1 to the priority",id:"priority-category-1",level:4},{value:"Defined content-type modifiers, defined methods, defined headers, $all, $popup, specific exceptions",id:"priority-category-2",level:4},{value:"<code>$domain</code> or <code>$app</code> with allowed domains or applications",id:"priority-category-3",level:4},{value:"<code>$redirect</code> rules",id:"priority-category-6",level:4},{value:"Specific exceptions",id:"priority-category-4",level:4},{value:"Allowlist rules",id:"priority-category-5",level:4},{value:"<code>$important</code> rules",id:"priority-category-7",level:4},{value:"Rules for which there is no priority weight",id:"priority-category-extra",level:4},{value:"Examples",id:"examples-1",level:4},{value:"Non-basic rules",id:"non-basic-rules",level:2},{value:"Cosmetic rules",id:"cosmetic-rules",level:2},{value:"Element hiding rules",id:"cosmetic-elemhide-rules",level:3},{value:"Syntax",id:"syntax",level:4},{value:"CSS rules",id:"cosmetic-css-rules",level:3},{value:"Extended CSS selectors",id:"extended-css-selectors",level:3},{value:"ExtendedCss Limitations",id:"extended-css-limitations",level:4},{value:"Pseudo-class <code>:has()</code>",id:"extended-css-has",level:4},{value:"<code>:has()</code> limitations",id:"extended-css-has-limitations",level:5},{value:"Pseudo-class <code>:contains()</code>",id:"extended-css-contains",level:4},{value:"Pseudo-class <code>:matches-css()</code>",id:"extended-css-matches-css",level:4},{value:"Pseudo-class <code>:matches-attr()</code>",id:"extended-css-matches-attr",level:4},{value:"Pseudo-class <code>:matches-property()</code>",id:"extended-css-property",level:4},{value:"Pseudo-class <code>:xpath()</code>",id:"extended-css-xpath",level:4},{value:"<code>:xpath()</code> limitations",id:"extended-css-xpath-limitations",level:5},{value:"Pseudo-class <code>:nth-ancestor()</code>",id:"extended-css-nth-ancestor",level:4},{value:"<code>:nth-ancestor()</code> limitations",id:"extended-css-nth-ancestor-limitations",level:5},{value:"Pseudo-class <code>:upward()</code>",id:"extended-css-upward",level:4},{value:"<code>:upward()</code> limitations",id:"extended-css-upward-limitations",level:5},{value:"Pseudo-class <code>:remove()</code> and pseudo-property <code>remove</code>",id:"remove-pseudos",level:4},{value:"<code>:remove()</code> and <code>remove</code> limitations",id:"extended-css-remove-limitations",level:5},{value:"Pseudo-class <code>:is()</code>",id:"extended-css-is",level:4},{value:"<code>:is()</code> limitations",id:"extended-css-is-limitations",level:5},{value:"Pseudo-class <code>:not()</code>",id:"extended-css-not",level:4},{value:"<code>:not()</code> limitations",id:"extended-css-not-limitations",level:5},{value:"Pseudo-class <code>:if-not()</code> (removed)",id:"extended-css-if-not",level:4},{value:"Cosmetic rules priority",id:"cosmetic-rules-priority",level:3},{value:"HTML filtering rules",id:"html-filtering-rules",level:2},{value:"Syntax",id:"syntax-1",level:3},{value:"Examples",id:"examples-2",level:3},{value:"Special attributes",id:"special-attributes",level:3},{value:"<code>tag-content</code>",id:"tag-content",level:4},{value:"<code>wildcard</code>",id:"wildcard",level:4},{value:"<code>max-length</code>",id:"max-length",level:4},{value:"<code>min-length</code>",id:"min-length",level:4},{value:"Pseudo-classes",id:"pseudo-classes",level:3},{value:"<code>:contains()</code>",id:"contains",level:4},{value:"Syntax",id:"syntax-2",level:5},{value:"Exceptions",id:"exceptions",level:3},{value:"JavaScript rules",id:"javascript-rules",level:2},{value:"Scriptlet rules",id:"scriptlets",level:2},{value:"Trusted scriptlets",id:"trusted-scriptlets",level:3},{value:"Modifiers for non-basic type of rules",id:"non-basic-rules-modifiers",level:2},{value:"<strong><code>$app</code></strong>",id:"non-basic-app-modifier",level:3},{value:"<strong><code>$domain</code></strong>",id:"non-basic-domain-modifier",level:3},{value:"<strong><code>$path</code></strong>",id:"non-basic-path-modifier",level:3},{value:"<strong><code>$url</code></strong>",id:"non-basic-url-modifier",level:3},{value:"Information for filters maintainers",id:"information-for-filters-maintainers",level:2},{value:"Preprocessor directives",id:"preprocessor-directives",level:3},{value:"Including a file",id:"include-directive",level:4},{value:"Conditions",id:"conditions-directive",level:4},{value:"Safari affinity",id:"safari-affinity-directive",level:4},{value:"Hints",id:"hints",level:3},{value:"<code>NOT_OPTIMIZED</code> hint",id:"not_optimized-hint",level:4},{value:"<code>PLATFORM</code> and <code>NOT_PLATFORM</code> hints",id:"platform-and-not_platform-hints",level:4},{value:"How to debug filtering rules",id:"how-to-debug-filtering-rules",level:2},{value:"Filtering log",id:"filtering-log",level:3},{value:"Selectors debugging mode",id:"selectors-debug-mode",level:3},{value:"Debugging scriptlets",id:"debug-scriptlets",level:3},{value:"Compatibility tables legend",id:"compatibility-tables-legend",level:2},{value:"Product shortcuts",id:"what-product",level:3},{value:"Compatibility shortcuts",id:"what-compatibility",level:3}],d={toc:s};function m(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"\uc774 \uae00\uc5d0\uc11c\ub294 AdGuard \uc81c\ud488\uc5d0\uc11c \uc0ac\uc6a9\uc790 \uc815\uc758 \ud544\ud130\ub9c1 \uaddc\uce59\uc744 \uc791\uc131\ud558\ub294 \ubc29\ubc95\uc744 \uc54c\ub824\ub4dc\ub9bd\ub2c8\ub2e4. To test your rules, you can ",(0,i.kt)("a",{parentName:"p",href:"https://agrd.io/download-kb-adblock"},"download the AdGuard app")),(0,i.kt)("p",null,":::"),(0,i.kt)("p",null,"A filter is a set of filtering rules applied to specific content, such as banners or pop-ups. AdGuard has a list of standard filters created by our team. We constantly improve and update them, striving to meet the needs of most of our users."),(0,i.kt)("p",null,"At the same time, AdGuard allows you to create your own custom filters using the same types of rules that we have in our filters."),(0,i.kt)("p",null,"To describe the syntax of our filtering rules, we use ",(0,i.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc5234"},"Augmented BNF for Syntax Specifications"),", but we do not always strictly follow this specification."),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"Originally, the AdGuard's syntax was based on the syntax of Adblock Plus rules. Later, we extended it with new types of rules for better ad filtering. Some parts of this article about the rules common both to AdGuard and ABP were taken from ",(0,i.kt)("a",{parentName:"p",href:"https://adblockplus.org/en/filters"},"the Adblock Plus guide on how to write filters"),"."),(0,i.kt)("p",null,":::"),(0,i.kt)("h2",{id:"comments"},"Comments"),(0,i.kt)("p",null,"Any line that starts with an exclamation mark is a comment. In the list of rules it is displayed in gray color. AdGuard will ignore this line, so you can write anything you want. Comments are usually placed above the rules and used to describe what a rule does."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! This is the comment. Below this line, there is an actual filtering rule.\n||example.org^\n")),(0,i.kt)("h2",{id:"examples"},"Examples"),(0,i.kt)("h3",{id:"blocking-by-domain-name"},"Blocking by domain name"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/general/0_blocking_domain.svg",alt:"Blocking by domain name"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule blocks:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://example.org/ad1.gif")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://subdomain.example.org/ad1.gif")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"https://ads.example.org:8000/"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule does not block:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://ads.example.org.us/ad1.gif")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/redirect/http://ads.example.org/"))),(0,i.kt)("p",null,"By default, such rules do not work for document requests. This means that the ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^")," rule will block a request made to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," when you try to navigate to this domain from another website, but if you type ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," into the address bar and try to navigate to it, the website will open. To block the document request, you will need to use a rule with the ",(0,i.kt)("a",{parentName:"p",href:"#document-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$document")," modifier"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$document"),"."),(0,i.kt)("h3",{id:"blocking-exact-address"},"Blocking exact address"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/general/1_exact_address.svg",alt:"Blocking exact address"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule blocks:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://example.org/"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule does not block:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"https://example.org/banner/img"))),(0,i.kt)("h3",{id:"basic-rule-modifiers"},"Basic rule modifiers"),(0,i.kt)("p",null,"Filtering rules support numerous modifiers that allow you to fine-tune the rule behavior. Here is an example of a rule with some simple modifiers."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/general/2_basic_rule_options.svg",alt:"Basic rule modifiers"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule blocks:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://example.org/script.js")," if this script is loaded from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule does not block:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"https://example.org/script.js")," if this script is loaded from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"https://example.org/banner.png")," because it is not a script.")),(0,i.kt)("h3",{id:"unblocking-an-address"},"Unblocking an address"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/general/3_basic_exception.svg",alt:"Unblocking an address"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule unblocks:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"http://example.org/banner.png")," even if there is a blocking rule for this address.")),(0,i.kt)("p",null,"Blocking rules with ",(0,i.kt)("a",{parentName:"p",href:"#important-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$important"))," modifier can override exceptions."),(0,i.kt)("h3",{id:"unblocking-an-entire-website"},"Unblocking an entire website"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/general/4_unblock_entire_website.svg",alt:"Unblocking an entire website"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"This rule unblocks")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"It disables all cosmetic rules on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),"."),(0,i.kt)("li",{parentName:"ul"},"It unblocks all requests sent from this website even if there is are blocking rules matching these requests.")),(0,i.kt)("h3",{id:"cosmetic-rule"},"Cosmetic rule"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://cdn.adtidy.org/content/kb/ad_blocker/general/5_cosmetic_rules.svg",alt:"Cosmetic rule"})),(0,i.kt)("p",null,"Cosmetic rules are based on using a special language named CSS, which every browser understands. Basically, it adds a new CSS style to the website which purpose is to hide particular elements. You can learn more about CSS in general ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Selectors"},"here"),"."),(0,i.kt)("p",null,"AdGuard ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-selectors"},"extends CSS")," and lets filters developers handle much more complicated cases. However, to use these extended rules, you need to be fluent in regular CSS."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Popular CSS selectors")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"CSS selector"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"ID selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"#banners")),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all elements with ",(0,i.kt)("inlineCode",{parentName:"td"},"id")," attribute equal to ",(0,i.kt)("inlineCode",{parentName:"td"},"banners"),".",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_id_selector.png",alt:"ID selector"}))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Class selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},".banners")),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all elements with ",(0,i.kt)("inlineCode",{parentName:"td"},"class")," attribute containing ",(0,i.kt)("inlineCode",{parentName:"td"},"banners"),".",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_selector.png",alt:"Class selector"}))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Attribute selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'div[class="banners"]')),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all ",(0,i.kt)("inlineCode",{parentName:"td"},"div")," elements with ",(0,i.kt)("inlineCode",{parentName:"td"},"class")," attribute ",(0,i.kt)("strong",{parentName:"td"},"exactly equal")," to ",(0,i.kt)("inlineCode",{parentName:"td"},"banners"),".",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_attr.png",alt:"Attribute selector"}))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Attribute substring selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'div[class^="advert1"]')),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all ",(0,i.kt)("inlineCode",{parentName:"td"},"div")," elements which ",(0,i.kt)("inlineCode",{parentName:"td"},"class")," attribute ",(0,i.kt)("strong",{parentName:"td"},"starts with")," the ",(0,i.kt)("inlineCode",{parentName:"td"},"advert1")," string.",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_attr_start.png",alt:"Attribute substring selector"}))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Attribute substring selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'div[class$="banners_ads"]')),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all ",(0,i.kt)("inlineCode",{parentName:"td"},"div")," elements which ",(0,i.kt)("inlineCode",{parentName:"td"},"class")," attribute ",(0,i.kt)("strong",{parentName:"td"},"ends with")," the ",(0,i.kt)("inlineCode",{parentName:"td"},"banners_ads")," string.",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_class_attr_end.png",alt:"Attribute substring selector"}))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Attribute substring selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'a[href^="http://example.com/"]')),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all links that are loaded from ",(0,i.kt)("inlineCode",{parentName:"td"},"http://example.com/")," domain.",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_attr_start.png",alt:"Attribute substring selector"}))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Attribute selector"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'a[href="http://example.com/"]')),(0,i.kt)("td",{parentName:"tr",align:null},"Matches all links to ",(0,i.kt)("strong",{parentName:"td"},"exactly")," the ",(0,i.kt)("inlineCode",{parentName:"td"},"http://example.com/")," address.",(0,i.kt)("br",null),(0,i.kt)("img",{parentName:"td",src:"https://cdn.adtidy.org/public/Adguard/kb/en/rules_syntax/css_attr_equal.png",alt:"Attribute selector"}))))),(0,i.kt)("h2",{id:"restrictions-and-limitations"},"Restrictions and limitations"),(0,i.kt)("h3",{id:"trusted-filters"},"Trusted filters"),(0,i.kt)("p",null,"Some rules can be used only in trusted filters. This category includes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"filter lists ",(0,i.kt)("a",{parentName:"li",href:"../adguard-filters"},"created by the AdGuard team"),","),(0,i.kt)("li",{parentName:"ul"},"custom filter lists installed as ",(0,i.kt)("inlineCode",{parentName:"li"},"trusted"),","),(0,i.kt)("li",{parentName:"ul"},"user rules.")),(0,i.kt)("h3",{id:"adguard-\ucf58\ud150\uce20-\ucc28\ub2e8\uae30"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30"),(0,i.kt)("p",null,"AdGuard Content Blocker is an extension for Samsung and Yandex browsers that can be installed from Google Play. It is not to be confused with the fully functional AdGuard for Android that can only be downloaded from ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/adguard-android/overview.html"},"our website"),". Unfortunately, AdGuard Content Blocker capabilities are limited by what the browsers allow and they only support an old Adblock Plus filters syntax:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Basic blocking rules with the following modifiers: ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$third-party"),", ",(0,i.kt)("a",{parentName:"li",href:"#content-type-modifiers"},"content-type modifiers"),"."),(0,i.kt)("li",{parentName:"ul"},"Basic exception rules with the following modifiers: ",(0,i.kt)("inlineCode",{parentName:"li"},"$document"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$elemhide"),"."),(0,i.kt)("li",{parentName:"ul"},"Basic ",(0,i.kt)("a",{parentName:"li",href:"#cosmetic-elemhide-rules"},"element hiding rules")," with no extended CSS support.")),(0,i.kt)("p",null,"Because of the limitations above AdGuard Content Blocker will not be mentioned in the compatibility notes."),(0,i.kt)("h2",{id:"basic-rules"},"Basic rules"),(0,i.kt)("p",null,"The most simple rules are so-called ",(0,i.kt)("em",{parentName:"p"},"Basic rules"),'. They are used to block requests to specific URLs. Or to unblock it, if there is a special marker "@@" at the beginning of the rule. The basic principle for this type of rules is quite simple: you have to specify the address and additional parameters that limit or expand the rule scope.'),(0,i.kt)("admonition",{title:"Sub-requests",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Basic rules for blocking requests are applied only to ",(0,i.kt)("strong",{parentName:"p"},"sub-requests"),". That means they will not block the loading of the page unless it is explicitly specified with a ",(0,i.kt)("inlineCode",{parentName:"p"},"$document")," modifier.")),(0,i.kt)("admonition",{title:"Response status",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Browser detects a blocked request as completed with an error.")),(0,i.kt)("admonition",{title:"Rule length",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Rules shorter than 4 characters are considered incorrect and will be ignored.")),(0,i.kt)("h3",{id:"basic-rules-syntax"},"Basic rule syntax"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'      rule = ["@@"] pattern [ "$" modifiers ]\nmodifiers = [modifier0, modifier1[, ...[, modifierN]]]\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"pattern"))," \u2014 an address mask. Every request URL is collated to this mask. In the template, you can also use the special characters described ",(0,i.kt)("a",{parentName:"li",href:"#basic-rules-special-characters"},"below"),". Note that AdGuard truncates URLs to a length of 4096 characters in order to speed up matching and avoid issues with ridiculously long URLs."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"@@"))," \u2014 a marker that is used in rules of exception. To turn off filtering for a request, start your rule with this marker."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"modifiers")),' \u2014 parameters that "clarify" the basic rule. Some of them limit the rule scope and some can completely change they way it works.')),(0,i.kt)("h3",{id:"basic-rules-special-characters"},"Special characters"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"*"))," \u2014 a wildcard character. It is used to represent any set of characters. This can also be an empty string or a string of any length."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"||"))," \u2014 an indication to apply the rule to the specified domain and its subdomains. With this character, you do not have to specify a particular protocol and subdomain in address mask. It means that ",(0,i.kt)("inlineCode",{parentName:"li"},"||")," stands for ",(0,i.kt)("inlineCode",{parentName:"li"},"http://*."),", ",(0,i.kt)("inlineCode",{parentName:"li"},"https://*."),", ",(0,i.kt)("inlineCode",{parentName:"li"},"ws://*."),", ",(0,i.kt)("inlineCode",{parentName:"li"},"wss://*.")," at once."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"^"))," \u2014 a separator character mark. Separator character is any character, but a letter, a digit, or one of the following: ",(0,i.kt)("inlineCode",{parentName:"li"},"_")," ",(0,i.kt)("inlineCode",{parentName:"li"},"-")," ",(0,i.kt)("inlineCode",{parentName:"li"},".")," ",(0,i.kt)("inlineCode",{parentName:"li"},"%"),". In this example separator characters are shown in bold: ",(0,i.kt)("inlineCode",{parentName:"li"},"http:"),(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"//")),(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"/?")),(0,i.kt)("inlineCode",{parentName:"li"},"t=1"),(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"&")),(0,i.kt)("inlineCode",{parentName:"li"},"t2=t3"),". The end of the address is also accepted as separator."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"|"))," \u2014 a pointer to the beginning or the end of address. The value depends on the character placement in the mask. For example, a rule ",(0,i.kt)("inlineCode",{parentName:"li"},"swf|")," corresponds to ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/annoyingflash.swf")," , but not to ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/swf/index.html"),". ",(0,i.kt)("inlineCode",{parentName:"li"},"|http://example.org")," corresponds to ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.org"),", but not to ",(0,i.kt)("inlineCode",{parentName:"li"},"http://domain.com?url=http://example.org"),".")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"|"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"||"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"^")," can only be used with rules that have a URL pattern. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com##.advert")," is incorrect and will be ignored by the blocker.")),(0,i.kt)("admonition",{title:"Visual representation",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"We also recommend to get acquainted with ",(0,i.kt)("a",{parentName:"p",href:"https://adblockplus.org/filter-cheatsheet#blocking"},"the Adblock Plus filter cheatsheet"),", for better understanding of how such rules should be made.")),(0,i.kt)("h3",{id:"regexp-support"},"Regular expressions support"),(0,i.kt)("p",null,"If you want even more flexibility in making rules, you can use ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions"},"Regular expressions")," instead of a default simplified mask with special characters."),(0,i.kt)("admonition",{title:"Performance",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Rules with regular expressions work more slowly, therefore it is recommended to avoid them or to limit their scope to specific domains.")),(0,i.kt)("p",null,"If you want a blocker to determine a regular expression, the ",(0,i.kt)("inlineCode",{parentName:"p"},"pattern")," has to look like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'pattern = "/" regexp "/"\n')),(0,i.kt)("p",null,"For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"/banner\\d+/$third-party")," this rule will apply the regular expression ",(0,i.kt)("inlineCode",{parentName:"p"},"banner\\d+")," to all third-party requests. Exclusion rule with regular expression looks like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"@@/banner\\d+/"),"."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"AdGuard Safari and AdGuard for iOS do not fully support regular expressions because of ",(0,i.kt)("a",{parentName:"p",href:"https://webkit.org/blog/3476/content-blockers-first-look/"},"Content Blocking API restrictions"),' (look for "The Regular expression format" section).')),(0,i.kt)("h3",{id:"wildcard-for-tld"},"Wildcard support for TLD (top-level domains)"),(0,i.kt)("p",null,"Wildcard characters are supported for TLDs of the domains in patterns of ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-rules"},"cosmetic"),", ",(0,i.kt)("a",{parentName:"p",href:"#html-filtering-rules"},"HTML filtering")," and ",(0,i.kt)("a",{parentName:"p",href:"#javascript-rules"},"JavaScript")," rules."),(0,i.kt)("p",null,"For cosmetic rules, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"example.*##.banner"),", multiple domains are matched due to the part ",(0,i.kt)("inlineCode",{parentName:"p"},".*"),", i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"sub.example.net"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"example.co.uk"),", etc."),(0,i.kt)("p",null,"For basic rules the described logic is applicable only for the domains specified in ",(0,i.kt)("a",{parentName:"p",href:"#domain-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$domain")," modifier"),", e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"||*/banners/*$image,domain=example.*"),"."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"In AdGuard for Windows, Mac, Android, and AdGuard Browser Extension rules with wildcard ",(0,i.kt)("inlineCode",{parentName:"p"},".*")," match any ",(0,i.kt)("a",{parentName:"p",href:"https://publicsuffix.org/list/"},"public suffix (or eTLD)"),". But for AdGuard for Safari and iOS ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/SafariConverterLib/blob/v2.0.31/Sources/ContentBlockerConverter/Compiler/BlockerEntryFactory.swift#L44"},"the supported list of top-level domains")," is limited due to Safari limitations.")),(0,i.kt)("p",null,"Rules with wildcard for TLD are not supported by AdGuard Content Blocker."),(0,i.kt)("h3",{id:"basic-rule-examples"},"Basic rule examples"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com/ads/*")," \u2014 a simple rule, which corresponds to addresses like ",(0,i.kt)("inlineCode",{parentName:"p"},"http://example.com/ads/banner.jpg")," and even ",(0,i.kt)("inlineCode",{parentName:"p"},"http://subdomain.example.com/ads/otherbanner.jpg"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$third-party")," \u2014 this rule blocks third-party requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," and its subdomains.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com$document")," \u2014 general exception rule. It completely disables filtering for ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," and all subdomains. There is a number of modifiers which can be used in exception rules. For more details, please follow the link ",(0,i.kt)("a",{parentName:"p",href:"#exception-modifiers"},"below"),"."))),(0,i.kt)("h3",{id:"basic-rule-modifiers"},"Basic rule modifiers"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#basic-rules-basic-modifiers"},"Basic modifiers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#content-type-modifiers"},"Content-type modifiers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#exception-modifiers"},"Exception modifiers"))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},'The features described in this section are intended for experienced users. They extend capabilities of "Basic rules", but in order to use them you need to have a basic understanding of the way your browser works.')),(0,i.kt)("p",null,'You can change the behavior of a "basic rule" by using additional modifiers. Modifiers should be located in the end of the rule after a ',(0,i.kt)("inlineCode",{parentName:"p"},"$")," sign and be separated by commas."),(0,i.kt)("p",null,"Example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||domain.com^$popup,third-party\n")),(0,i.kt)("h3",{id:"basic-rules-basic-modifiers"},"Basic modifiers"),(0,i.kt)("p",null,"The following modifiers are the most simple and frequently used. Basically, they just limit the scope of rule application."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Modifier \\ Products"),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for Windows, Mac, Android"},"CoreLibs apps")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Chrome and other Chromium-based browsers"},"AdGuard for Chromium")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Firefox"},"AdGuard for Firefox")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for iOS and AdGuard Pro for iOS"},"iOS\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"Safari\uc6a9 AdGuard"},"Safari\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Content Blocker for Samsung Internet and Yandex Browser on Android"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#app-modifier"},"$app")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#denyallow-modifier"},"$denyallow")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#domain-modifier"},"$domain")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 ",(0,i.kt)("a",{parentName:"td",href:"#domain-modifier-limitations"},"*")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 ",(0,i.kt)("a",{parentName:"td",href:"#domain-modifier-limitations"},"*")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#header-modifier"},"$header")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u23f3"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u23f3"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#important-modifier"},"$important")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#match-case-modifier"},"$match-case")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#method-modifier"},"$method")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#popup-modifier"},"$popup")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#third-party-modifier"},"$third-party")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#to-modifier"},"$to")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u2705 * \u2014 supported, but reliability may vary or limitations may occur; check the modifier description for more details"),(0,i.kt)("li",{parentName:"ul"},"\u23f3 \u2014 feature that has been implemented or is planned to be implemented but is not yet available in any product"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"))),(0,i.kt)("h4",{id:"app-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$app"))),(0,i.kt)("p",null,"This modifier lets you narrow the rule coverage down to a specific application (or a list of applications). This might be not too important on Windows and Mac, but this is very important on mobile devices where some of the filtering rules must be app-specific."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Android \u2014 use the app package name, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app"),"."),(0,i.kt)("li",{parentName:"ul"},"Windows \u2014 use the process name, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"chrome.exe"),"."),(0,i.kt)("li",{parentName:"ul"},"Mac \u2014 use the bundle ID or the process name, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"com.google.Chrome"),".")),(0,i.kt)("p",null,"For Mac, you can find out the bundle ID or the process name of the app by viewing the respective request details in the Filtering log."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$app=org.example.app")," \u2014 a rule to block requests that match the specified mask and are sent from the ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app")," Android app."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$app=org.example.app1|org.example.app2")," \u2014 the same rule but it works for both ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app1")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app2")," apps.")),(0,i.kt)("p",null,"If you want the rule not to be applied to certain apps, start the app name with the ",(0,i.kt)("inlineCode",{parentName:"p"},"~")," sign."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$app=~org.example.app")," \u2014 a rule to block requests that match the specified mask and are sent from any app except for the ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$app=~org.example.app1|~org.example.app2")," \u2014 same as above, but now two apps are excluded: ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app1")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app2"),".")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Apps in the modifier value cannot have a wildcard, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"$app=com.*.music"),". Rules with such modifier are considered invalid.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Only AdGuard for Windows, Mac, Android are technically capable of using rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$app")," modifier."),(0,i.kt)("li",{parentName:"ul"},"On Windows the process name is case-insensitive starting with AdGuard for Windows with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.12 or later."))),(0,i.kt)("h4",{id:"denyallow-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$denyallow"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$denyallow")," modifier allows to avoid creating additional rules when it is needed to disable a certain rule for specific domains. ",(0,i.kt)("inlineCode",{parentName:"p"},"$denyallow")," matches only target domains and not referrer domains."),(0,i.kt)("p",null,"Adding this modifier to a rule is equivalent to excluding the domains by the rule's matching pattern or to adding the corresponding exclusion rules. To add multiple domains to one rule, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"|")," character as a separator."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"This rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"*$script,domain=a.com|b.com,denyallow=x.com|y.com\n")),(0,i.kt)("p",null,"is equivalent to this one:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"/^(?!.*(x.com|y.com)).*$/$script,domain=a.com|b.com\n")),(0,i.kt)("p",null,"or to the combination of these three:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"*$script,domain=a.com|b.com\n@@||x.com$script,domain=a.com|b.com\n@@||y.com$script,domain=a.com|b.com\n")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"The rule's matching pattern cannot target any specific domains, e.g. it cannot start with ",(0,i.kt)("inlineCode",{parentName:"li"},"||"),"."),(0,i.kt)("li",{parentName:"ul"},"Domains in the modifier value cannot be negated, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"$denyallow=~x.com"),", or have a wildcard TLD, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"$denyallow=x.*"),", or be a regular expression, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"$denyallow=/\\.(com\\|org)/"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$denyallow")," cannot be used together with ",(0,i.kt)("a",{parentName:"li",href:"#to-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$to")),". It can be expressed with inverted ",(0,i.kt)("inlineCode",{parentName:"li"},"$to"),": ",(0,i.kt)("inlineCode",{parentName:"li"},"$denyallow=a.com|b.com")," is equivalent to ",(0,i.kt)("inlineCode",{parentName:"li"},"$to=~a.com|~b.com"),".")),(0,i.kt)("p",{parentName:"admonition"},"The rules which violate these restrictions are considered invalid.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$denyallow")," modifier are not supported by AdGuard for iOS, Safari, and AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"domain-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$domain"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," limits the rule scope to requests made ",(0,i.kt)("strong",{parentName:"p"},"from")," the specified domains and their subdomains (as indicated by the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer"},"Referer")," HTTP header)."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,"The modifier is a list of one or more expressions separated by the ",(0,i.kt)("inlineCode",{parentName:"p"},"|")," symbol, each of which is matched against a domain in a particular way depending on its type (see below)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'domains = ["~"] entry_0 ["|" ["~"] entry_1 ["|" ["~"]entry_2 ["|" ... ["|" ["~"]entry_N]]]]\nentry_i = ( regular_domain / any_tld_domain / regexp )\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"regular_domain"))," \u2014 a regular domain name (",(0,i.kt)("inlineCode",{parentName:"li"},"domain.com"),"). Corresponds the specified domain and its subdomains. It is matched lexicographically."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"any_tld_domain"))," \u2014 a domain name ending with a wildcard character as a ",(0,i.kt)("a",{parentName:"li",href:"https://publicsuffix.org/learn/"},"public suffix"),", e.g. for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.*")," it is ",(0,i.kt)("inlineCode",{parentName:"li"},"co.uk")," in ",(0,i.kt)("inlineCode",{parentName:"li"},"example.co.uk"),". Corresponds to the specified domain and its subdomains with any public suffix. It is matched lexicographically."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"regexp"))," \u2014 a regular expression, starts and ends with ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),". The pattern works the same way as in the basic URL rules, but the characters ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"|")," must be escaped with ",(0,i.kt)("inlineCode",{parentName:"li"},"\\"),".")),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," modifier as ",(0,i.kt)("inlineCode",{parentName:"p"},"regular_domain")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"any_tld_domain")," are supported by all AdGuard products."),(0,i.kt)("p",null,":::"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Just ",(0,i.kt)("inlineCode",{parentName:"strong"},"$domain"),":")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=example.org")," blocks requests that match the specified mask, and are sent from domain ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," or its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=example.org|example.com")," \u2014 the same rule, but it works for both ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),".")),(0,i.kt)("p",null,"If you want the rule not to be applied to certain domains, start a domain name with ",(0,i.kt)("inlineCode",{parentName:"p"},"~")," sign."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"$domain")," and negation ",(0,i.kt)("inlineCode",{parentName:"strong"},"~"),":")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=example.org")," blocks requests that match the specified mask and are sent from the ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," domain or its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=example.org|example.com")," \u2014 the same rule, but it works for both ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=~example.org")," blocks requests matching the pattern sent from any domain except ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=example.org|~foo.example.org")," blocks requests sent from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and its subdomains, except the subdomain ",(0,i.kt)("inlineCode",{parentName:"li"},"foo.example.org"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=/(^\\|.+\\.)example\\.(com\\|org)\\$/")," blocks requests sent from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," domains and all their subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||baddomain.com^$domain=~a.com|~b.*|~/(^\\|.+\\.)c\\.(com\\|org)\\$/")," blocks requests sent from any domains, except ",(0,i.kt)("inlineCode",{parentName:"li"},"a.com"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"b")," with any public suffix (",(0,i.kt)("inlineCode",{parentName:"li"},"b.com"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"b.co.uk"),", etc.), ",(0,i.kt)("inlineCode",{parentName:"li"},"c.com"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"c.org"),", and their subdomains.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"$domain")," modifier matching target domain:")),(0,i.kt)("p",null,"In some cases the ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," modifier can match not only the referrer domain, but also the target domain. This happens when all the following conditions are met:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"The request has the ",(0,i.kt)("inlineCode",{parentName:"li"},"document")," content type"),(0,i.kt)("li",{parentName:"ol"},"The rule pattern does not match any particular domains"),(0,i.kt)("li",{parentName:"ol"},"The rule pattern does not contain regular expressions"),(0,i.kt)("li",{parentName:"ol"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain")," modifier contains only excluded domains, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain=~example.org|~example.com"))),(0,i.kt)("p",null,"The following predicate should be satisfied to perform a target domain matching:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"1 AND ((2 AND 3) OR 4)\n")),(0,i.kt)("p",null,"That is, if the modifier ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," contains only excluded domains, then the rule does not need to meet the second and third conditions to match the target domain against the modifier ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain"),"."),(0,i.kt)("p",null,"If some of the conditions above are not met but the rule contains ",(0,i.kt)("a",{parentName:"p",href:"#cookie-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$cookie"))," or ",(0,i.kt)("a",{parentName:"p",href:"#csp-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$csp"))," modifier, the target domain will still be matched."),(0,i.kt)("p",null,"If the referrer matches a rule with ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," that explicitly excludes the referrer domain, then the rule will not be applied even if the target domain also matches the rule. This affects rules with ",(0,i.kt)("a",{parentName:"p",href:"#cookie-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$cookie"))," and ",(0,i.kt)("a",{parentName:"p",href:"#csp-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$csp"))," modifiers, too."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"*$cookie,domain=example.org|example.com")," will block cookies for all requests to and from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"*$document,domain=example.org|example.com")," will block all requests to and from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),".")),(0,i.kt)("p",null,"In the following examples it is implied that requests are sent from ",(0,i.kt)("inlineCode",{parentName:"p"},"http://example.org/page")," (the referrer) and the target URL is ",(0,i.kt)("inlineCode",{parentName:"p"},"http://targetdomain.com/page"),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"page$domain=example.org")," will be matched, as it matches the referrer domain."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"page$domain=targetdomain.com")," will be matched, as it matches the target domain and satisfies all requirements mentioned above."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||*page$domain=targetdomain.com")," will not be matched, as the pattern ",(0,i.kt)("inlineCode",{parentName:"li"},"||*page")," may match specific domains, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"example.page"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||*page$domain=targetdomain.com,cookie")," will be matched because the rule contains ",(0,i.kt)("inlineCode",{parentName:"li"},"$cookie")," modifier despite the pattern ",(0,i.kt)("inlineCode",{parentName:"li"},"||*page")," may match specific domains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/banner\\d+/$domain=targetdomain.com")," will not be matched as it contains a regular expression."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"page$domain=targetdomain.com|~example.org")," will not be matched because the referrer domain is explicitly excluded.")),(0,i.kt)("h5",{id:"domain-modifier-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},"$domain")," modifier limitations"),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Safari does not support the simultaneous use of allowed and disallowed domains, so rules like ",(0,i.kt)("inlineCode",{parentName:"p"},"||baddomain.com^$domain=example.org|~foo.example.org")," will not work in AdGuard for iOS and AdGuard for Safari.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with regular expressions in the ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," modifier are supported by AdGuard for Windows, AdGuard for Mac, and AdGuard for Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.11 or later, and AdGuard Browser Extension with ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v3.0.0 or later."),(0,i.kt)("p",{parentName:"admonition"},"In AdGuard for Windows, Mac and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.12 or later the ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," modifier can be alternatively spelled as ",(0,i.kt)("inlineCode",{parentName:"p"},"$from"),".")),(0,i.kt)("h4",{id:"header-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$header"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$header")," modifier allows matching the HTTP response having a specific header with (optionally) a specific value."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'$header "=" h_name [":" h_value]\nh_value = string / regexp\n')),(0,i.kt)("p",null,"where:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"h_name"))," \u2014 required, an HTTP header name. It is matched case-insesitively."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"h_value"))," \u2014 optional, an HTTP header value matching expression, it may be one of the following:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"string"))," \u2014 a sequence of characters. It is matched against the header value lexicographically;"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"regexp"))," \u2014 a regular expression, starts and ends with ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),". The pattern works the same way as in the basic URL rules, but the characters ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$")," and ",(0,i.kt)("inlineCode",{parentName:"li"},",")," must be escaped with ",(0,i.kt)("inlineCode",{parentName:"li"},"\\"),".")))),(0,i.kt)("p",null,"The modifier part, ",(0,i.kt)("inlineCode",{parentName:"p"},'":" h_value'),", may be omitted. In that case, the modifier matches the header name only."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com^$header=set-cookie:foo")," blocks requests whose responses have the ",(0,i.kt)("inlineCode",{parentName:"li"},"Set-Cookie")," header with the value matching ",(0,i.kt)("inlineCode",{parentName:"li"},"foo")," literally."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com^$header=set-cookie")," blocks requests whose responses have the ",(0,i.kt)("inlineCode",{parentName:"li"},"Set-Cookie")," header with any value."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$header=set-cookie:/foo\\, bar\\$/")," unblocks requests whose responses have the ",(0,i.kt)("inlineCode",{parentName:"li"},"Set-Cookie")," header with value matching the ",(0,i.kt)("inlineCode",{parentName:"li"},"foo, bar$")," regular expression."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$header=set-cookie")," unblocks requests whose responses have a ",(0,i.kt)("inlineCode",{parentName:"li"},"Set-Cookie")," header with any value.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$header")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.11 or later.")),(0,i.kt)("h4",{id:"important-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$important"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$important")," modifier applied to a rule increases its priority over rules without the identical modifier. Even over basic exception rules."),(0,i.kt)("p",null,"Go to ",(0,i.kt)("a",{parentName:"p",href:"#rule-priorities"},"rules priorities")," for more details."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! blocking rule will block all requests despite of the exception rule\n||example.org^$important\n@@||example.org^\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! if the exception rule also has `$important` modifier, it will prevail and requests won't be blocked\n||example.org^$important\n@@||example.org^$important\n")),(0,i.kt)("h4",{id:"match-case-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$match-case"))),(0,i.kt)("p",null,"This modifier defines a rule which applies only to addresses that match the case. Default rules are case-insensitive."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"*/BannerAd.gif$match-case")," \u2014 this rule will block ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/BannerAd.gif"),", but not ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/bannerad.gif"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$match-case")," are supported by AdGuard for iOS and AdGuard for Safari with SafariConverterLib v2.0.43 or later."),(0,i.kt)("p",{parentName:"admonition"},"All other products already support this modifier.")),(0,i.kt)("h4",{id:"method-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$method"))),(0,i.kt)("p",null,"This modifier limits the rule scope to requests that use the specified set of HTTP methods. Negated methods are allowed. The methods must be specified in all lowercase characters, but are matched case-insensitively. To add multiple methods to one rule, use the vertical bar ",(0,i.kt)("inlineCode",{parentName:"p"},"|")," as a separator."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||evil.com^$method=get|head")," blocks only GET and HEAD requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.com"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||evil.com^$method=~post|~put")," blocks any requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.com")," except POST or PUT."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||evil.com$method=get")," unblocks only GET requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.com"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||evil.com$method=~post")," unblocks any requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.com")," except POST.")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Rules with mixed negated and not negated values are considered invalid. So, for example, the rule ",(0,i.kt)("inlineCode",{parentName:"p"},"||evil.com^$method=get|~head")," will be rejected.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$method")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.12 or later and AdGuard Browser Extension for Chrome, Firefox, and Edge with ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v2.1.1 or later.")),(0,i.kt)("h4",{id:"popup-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$popup"))),(0,i.kt)("p",null,"AdGuard will try to close the browser tab with any address that matches a blocking rule with this modifier. Please note that not all the tabs can be closed."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||domain.com^$popup")," \u2014 if you try to go to ",(0,i.kt)("inlineCode",{parentName:"li"},"http://domain.com/")," from any page in the browser, a new tab in which specified site has to be opened will be closed by this rule.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$popup")," modifier works best in AdGuard Browser Extension."),(0,i.kt)("li",{parentName:"ul"},"In AdGuard for Safari and iOS, ",(0,i.kt)("inlineCode",{parentName:"li"},"$popup")," rules simply block the page right away."),(0,i.kt)("li",{parentName:"ul"},"In AdGuard for Windows, Mac, and Android, ",(0,i.kt)("inlineCode",{parentName:"li"},"$popup")," modifier may not detect a popup in some cases and it will not be blocked. ",(0,i.kt)("inlineCode",{parentName:"li"},"$popup")," modifier applies the ",(0,i.kt)("inlineCode",{parentName:"li"},"document")," content type with a special flag which is passed to a blocking page. Blocking page itself can do some checks and close the window if it is really a popup. Otherwise, page should be loaded. It can be combined with other request type modifiers, such as ",(0,i.kt)("inlineCode",{parentName:"li"},"$third-party")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"$important"),"."),(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$popup")," modifier are not supported by AdGuard Content Blocker."))),(0,i.kt)("h4",{id:"third-party-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$third-party"))),(0,i.kt)("p",null,"A restriction of third-party and own requests. A third-party request is a request from a different domain. For example, a request to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," from ",(0,i.kt)("inlineCode",{parentName:"p"},"domain.com")," is a third-party request."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"To be considered as such, a third-party request should meet one of the following conditions:"),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"Its referrer is not a subdomain of the target domain or vice versa. For example, a request to ",(0,i.kt)("inlineCode",{parentName:"li"},"subdomain.example.org")," from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," is not a third-party request"),(0,i.kt)("li",{parentName:"ol"},"Its ",(0,i.kt)("inlineCode",{parentName:"li"},"Sec-Fetch-Site")," header is set to ",(0,i.kt)("inlineCode",{parentName:"li"},"cross-site")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"$third-party"),":")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||domain.com^$third-party")," \u2014 this rule applies to all domains, except ",(0,i.kt)("inlineCode",{parentName:"li"},"domain.com")," and its subdomains. An example of a third-party request: ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.org/banner.jpg"),".")),(0,i.kt)("p",null,"If there is a ",(0,i.kt)("inlineCode",{parentName:"p"},"$~third-party")," modifier, the rule is only applied to the requests that are not from third parties. Which means, they have to be sent from the same domain."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"$~third-party"),":")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||domain.com$~third-party")," \u2014 this rule is applied exclusively to ",(0,i.kt)("inlineCode",{parentName:"li"},"domain.com"),". Example of a non third-party request: ",(0,i.kt)("inlineCode",{parentName:"li"},"http://domain.com/icon.ico"),".")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$3p"),".")),(0,i.kt)("h4",{id:"to-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$to"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$to")," limits the rule scope to requests made ",(0,i.kt)("strong",{parentName:"p"},"to")," the specified domains and their subdomains. To add multiple domains to one rule, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"|")," character as a separator."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/ads$to=evil.com|evil.org")," blocks any request to ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.com")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.org")," and their subdomains with a path matching ",(0,i.kt)("inlineCode",{parentName:"li"},"/ads"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/ads$to=~not.evil.com|evil.com")," blocks any request to ",(0,i.kt)("inlineCode",{parentName:"li"},"evil.com")," and its subdomains, with a path matching ",(0,i.kt)("inlineCode",{parentName:"li"},"/ads"),", except requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"not.evil.com")," and its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/ads$to=~good.com|~good.org")," blocks any request with a path matching ",(0,i.kt)("inlineCode",{parentName:"li"},"/ads"),", except requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"good.com")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"good.org")," and their subdomains.")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("a",{parentName:"p",href:"#denyallow-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$denyallow"))," cannot be used together with ",(0,i.kt)("inlineCode",{parentName:"p"},"$to"),". It can be expressed with inverted ",(0,i.kt)("inlineCode",{parentName:"p"},"$to"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"$denyallow=a.com|b.com")," is equivalent to ",(0,i.kt)("inlineCode",{parentName:"p"},"$to=~a.com|~b.com"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$to")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.12 or later and AdGuard Browser Extension with ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v2.1.3 or later.")),(0,i.kt)("h3",{id:"content-type-modifiers"},"Content-type modifiers"),(0,i.kt)("p",null,"There is a set of modifiers, which can be used to limit the rule's application area to certain type of content. These modifiers can also be combined to cover, for example, both images and scripts."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"There is a big difference in how AdGuard determines the content type on different platforms. For AdGuard Browser Extension, content type for every request is provided by the browser. AdGuard for Windows, Mac, and Android use the following method: first, the apps try to determine the type of the request by the ",(0,i.kt)("inlineCode",{parentName:"p"},"Sec-Fetch-Dest")," request header or by the filename extension. If the request is not blocked at this stage, the type will be determined using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," header at the beginning of the server response.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples of content-type modifiers")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$image")," \u2014 corresponds to all images from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$script,stylesheet")," \u2014 corresponds to all the scripts and styles from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$~image,~script,~stylesheet")," \u2014 corresponds to all requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," except for the images, scripts and styles.")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Modifier \\ Products"),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for Windows, Mac, Android"},"CoreLibs apps")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Chrome and other Chromium-based browsers"},"AdGuard for Chromium")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Firefox"},"AdGuard for Firefox")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for iOS and AdGuard Pro for iOS"},"iOS\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"Safari\uc6a9 AdGuard"},"Safari\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Content Blocker for Samsung Internet and Yandex Browser on Android"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#document-modifier"},"$document")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#font-modifier"},"$font")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#image-modifier"},"$image")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#media-modifier"},"$media")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#object-modifier"},"$object")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#other-modifier"},"$other")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#ping-modifier"},"$ping")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#script-modifier"},"$script")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#stylesheet-modifier"},"$stylesheet")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#subdocument-modifier"},"$subdocument")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#websocket-modifier"},"$websocket")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#xmlhttprequest-modifier"},"$xmlhttprequest")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#webrtc-modifier",title:"removed"},"$webrtc \ud83d\udeab")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#object-subrequest-modifier",title:"removed"},"$object-subrequest \ud83d\udeab")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u2705 * \u2014 supported, but reliability may vary or limitations may occur; check the modifier description for more details"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"),(0,i.kt)("li",{parentName:"ul"},"\ud83d\udeab \u2014 removed and no longer supported"))),(0,i.kt)("h4",{id:"document-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$document"))),(0,i.kt)("p",null,"The rule corresponds to the main frame document requests, i.e. HTML documents that are loaded in the browser tab. It does not match iframes, there is a ",(0,i.kt)("a",{parentName:"p",href:"#subdocument-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$subdocument")," modifier")," for these."),(0,i.kt)("p",null,'By default, AdGuard does not block the requests that are loaded in the browser tab (e.g. "main frame bypass"). The idea is not to prevent pages from loading as the user clearly indicated that they want this page to be loaded. However, if the ',(0,i.kt)("inlineCode",{parentName:"p"},"$document"),' modifier is specified explicitly, AdGuard does not use that logic and prevents the page load. Instead, it responds with a "blocking page".'),(0,i.kt)("p",null,"If this modifier is used with an exclusion rule (",(0,i.kt)("inlineCode",{parentName:"p"},"@@"),"), it completely disables blocking on corresponding pages. It is equivalent to using ",(0,i.kt)("inlineCode",{parentName:"p"},"$elemhide"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$content"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$jsinject"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$extension")," modifiers simultaneously."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^$document")," completely disables filtering on all pages at ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," and all subdomains.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$document")," blocks HTML document request to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," with a blocking page.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$document,redirect=noopframe")," redirects HTML document request to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," to an empty html document.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$document,removeparam=test")," removes ",(0,i.kt)("inlineCode",{parentName:"p"},"test")," query parameter from HTML document request to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$document,replace=/test1/test2/")," replaces ",(0,i.kt)("inlineCode",{parentName:"p"},"test1")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"test2")," in HTML document request to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),"."))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$doc"),".")),(0,i.kt)("h4",{id:"font-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$font"))),(0,i.kt)("p",null,"The rule corresponds to requests for fonts, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},".woff")," filename extension."),(0,i.kt)("h4",{id:"image-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$image"))),(0,i.kt)("p",null,"The rule corresponds to images requests."),(0,i.kt)("h4",{id:"media-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$media"))),(0,i.kt)("p",null,"The rule corresponds to requests for media files \u2014 music and video, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},".mp4")," files."),(0,i.kt)("h4",{id:"object-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$object"))),(0,i.kt)("p",null,"The rule corresponds to browser plugins resources, e.g. Java or Flash."),(0,i.kt)("h4",{id:"other-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$other"))),(0,i.kt)("p",null,"The rule applies to requests for which the type has not been determined or does not match the types listed above."),(0,i.kt)("h4",{id:"ping-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$ping"))),(0,i.kt)("p",null,"The rule corresponds to requests caused by either ",(0,i.kt)("inlineCode",{parentName:"p"},"navigator.sendBeacon()")," or the ",(0,i.kt)("inlineCode",{parentName:"p"},"ping")," attribute on links."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"AdGuard for Windows, Mac, and Android often cannot accurately detect ",(0,i.kt)("inlineCode",{parentName:"p"},"navigator.sendBeacon()"),". Using ",(0,i.kt)("inlineCode",{parentName:"p"},"$ping")," is not recommended in the filter lists that are supposed to be used by CoreLibs-based AdGuard products."),(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$ping")," modifier are not supported by AdGuard for Safari and iOS.")),(0,i.kt)("h4",{id:"script-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$script"))),(0,i.kt)("p",null,"The rule corresponds to script requests, e.g. javascript, vbscript."),(0,i.kt)("h4",{id:"stylesheet-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$stylesheet"))),(0,i.kt)("p",null,"The rule corresponds to CSS files requests."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$css"),".")),(0,i.kt)("h4",{id:"subdocument-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$subdocument"))),(0,i.kt)("p",null,"The rule corresponds to requests for built-in pages \u2014 HTML tags ",(0,i.kt)("inlineCode",{parentName:"p"},"frame")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"iframe"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com^$subdocument")," blocks built-in page requests (",(0,i.kt)("inlineCode",{parentName:"li"},"frame")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"iframe"),") to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all its subdomains anywhere."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com^$subdocument,domain=domain.com")," blocks built-in page requests (",(0,i.kt)("inlineCode",{parentName:"li"},"frame")," \u0438 ",(0,i.kt)("inlineCode",{parentName:"li"},"iframe"),") to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," (and its subdomains) from ",(0,i.kt)("inlineCode",{parentName:"li"},"domain.com")," and all its subdomains.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$frame"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"In AdGuard for Windows, Mac, and Android subdocuments are being detected by the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Dest"},"Sec-Fetch-Dest header")," if it is present. Otherwise, some main pages may be treated as subdocuments."),(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$subdocument")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"websocket-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$websocket"))),(0,i.kt)("p",null,"The rule applies only to WebSocket connections."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"$websocket")," modifier is supported in all AdGuard products except AdGuard Content Blocker. As for AdGuard for Safari and AdGuard for iOS, it's supported on devices with macOS Monterey (version 12) and iOS 16 or higher.")),(0,i.kt)("h4",{id:"xmlhttprequest-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$xmlhttprequest"))),(0,i.kt)("p",null,"The rule applies only to ajax requests (requests sent via javascript object ",(0,i.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest"),")."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$xhr"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"AdGuard for Windows, Mac, Android when filtering older browsers cannot accurately detect this type and sometimes detects it as ",(0,i.kt)("a",{parentName:"p",href:"#other-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$other"))," or ",(0,i.kt)("a",{parentName:"p",href:"#script-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$script")),". They can only reliably detect this content type when filtering modern browsers that support ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/Fetch_metadata_request_header"},"Fetch metadata request headers"),".")),(0,i.kt)("h4",{id:"object-subrequest-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$object-subrequest")," (removed)")),(0,i.kt)("admonition",{title:"Removal notice",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"$object-subrequest")," modifier is removed and is no longer supported. Rules with it are considered as invalid. The rule corresponds to requests by browser plugins (it is usually Flash).")),(0,i.kt)("h4",{id:"webrtc-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$webrtc")," (removed)")),(0,i.kt)("admonition",{title:"Removal notice",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"This modifier is removed and is no longer supported. Rules with it are considered as invalid. If you need to suppress WebRTC, consider using the ",(0,i.kt)("inlineCode",{parentName:"p"},"nowebrtc")," ",(0,i.kt)("a",{parentName:"p",href:"#scriptlets"},"scriptlet"),".")),(0,i.kt)("p",null,"The rule applies only to WebRTC connections."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com^$webrtc,domain=example.org")," blocks webRTC connections to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@*$webrtc,domain=example.org")," disables the RTC wrapper for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),".")),(0,i.kt)("h3",{id:"exception-modifiers"},"Exception rules modifiers"),(0,i.kt)("p",null,"Exception rules disable the other basic rules for the addresses to which they correspond. They begin with a ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," mark. All the basic modifiers listed above can be applied to them and they also have a few special modifiers."),(0,i.kt)("admonition",{title:"Visual representation",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"We recommend to get acquainted with ",(0,i.kt)("a",{parentName:"p",href:"https://adblockplus.org/filter-cheatsheet#blocking"},"the Adblock Plus filter cheatsheet"),", for better understanding of how exception rules should be made.")),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Modifier \\ Products"),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for Windows, Mac, Android"},"CoreLibs apps")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Chrome and other Chromium-based browsers"},"AdGuard for Chromium")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Firefox"},"AdGuard for Firefox")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for iOS and AdGuard Pro for iOS"},"iOS\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"Safari\uc6a9 AdGuard"},"Safari\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Content Blocker for Samsung Internet and Yandex Browser on Android"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#content-modifier"},"$content")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#elemhide-modifier"},"$elemhide")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#extension-modifier"},"$extension")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#jsinject-modifier"},"$jsinject")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#stealth-modifier"},"$stealth")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#urlblock-modifier"},"$urlblock")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#genericblock-modifier"},"$genericblock")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 *"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#generichide-modifier"},"$generichide")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#specifichide-modifier"},"$specifichide")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u2705 * \u2014 supported, but reliability may vary or limitations may occur; check the modifier description for more details"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"))),(0,i.kt)("h4",{id:"content-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$content"))),(0,i.kt)("p",null,"Disables ",(0,i.kt)("a",{parentName:"p",href:"#html-filtering-rules"},"HTML filtering"),", ",(0,i.kt)("a",{parentName:"p",href:"#hls-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$hls")),", ",(0,i.kt)("a",{parentName:"p",href:"#replace-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$replace")),", and ",(0,i.kt)("a",{parentName:"p",href:"#jsonprune-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$jsonprune"))," rules on the pages that match the rule."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$content")," disables all content modifying rules on pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all its subdomains.")),(0,i.kt)("h4",{id:"elemhide-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$elemhide"))),(0,i.kt)("p",null,"Disables any ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-rules"},"cosmetic rules")," on the pages matching the rule."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$elemhide")," disables all cosmetic rules on pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$ehide"),".")),(0,i.kt)("h4",{id:"extension-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$extension"))),(0,i.kt)("p",null,"Disables specific userscripts or all userscripts for a given domain."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'$extension[="userscript_name1"[|"userscript_name2"[|"userscript_name3"[...]]]]\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"userscript_name(i)")," stands for a specific userscript name to be disabled by the modifier. The modifier can contain any number of userscript names or none. In the latter case the modifier disables all the userscripts."),(0,i.kt)("p",null,"Userscript names usually contain spaces or other special characters, which is why you should enclose the name in quotes. Both single (",(0,i.kt)("inlineCode",{parentName:"p"},"'"),") and double (",(0,i.kt)("inlineCode",{parentName:"p"},'"'),") ASCII quotes are supported. Multiple userscript names should be separated with a pipe (",(0,i.kt)("inlineCode",{parentName:"p"},"|"),"). However, if a userscript name is a single word without any special characters, it can be used without quotes."),(0,i.kt)("p",null,"You can also exclude a userscript by adding a ",(0,i.kt)("inlineCode",{parentName:"p"},"~")," character before it. In this case, the userscript will not be disabled by the modifier."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$extension=~"userscript name"\n')),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When excluding a userscript, you must place ",(0,i.kt)("inlineCode",{parentName:"p"},"~")," outside the quotes.")),(0,i.kt)("p",null,"If a userscript's name includes quotes (",(0,i.kt)("inlineCode",{parentName:"p"},'"'),"), commas (",(0,i.kt)("inlineCode",{parentName:"p"},","),"), or pipes (",(0,i.kt)("inlineCode",{parentName:"p"},"|"),"), they must be escaped with a backslash (",(0,i.kt)("inlineCode",{parentName:"p"},"\\"),")."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$extension="userscript name\\, with \\"quote\\""\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'@@||example.com^$extension="AdGuard Assistant"')," disables the ",(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard Assistant")," userscript on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," website."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$extension=MyUserscript")," disables the ",(0,i.kt)("inlineCode",{parentName:"li"},"MyUserscript")," userscript on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," website."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$extension='AdGuard Assistant'|'Popup Blocker'")," disables both ",(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard Assistant")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"Popup Blocker")," userscripts on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," website."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'@@||example.com^$extension=~"AdGuard Assistant"')," disables all user scripts on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," website, except ",(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard Assistant"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'@@||example.com^$extension=~"AdGuard Assistant"|~"Popup Blocker"')," disables all user scripts on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," website, except ",(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard Assistant")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"Popup Blocker"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$extension")," no userscript will work on webpages on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'@@||example.com^$extension="AdGuard \\"Assistant\\""')," disables the ",(0,i.kt)("inlineCode",{parentName:"li"},'AdGuard "Assistant"')," userscript on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," website.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Only AdGuard for Windows, Mac, Android are technically capable of using rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$extension")," modifier."),(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$extension")," modifier with specific userscript name are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.13 or later."))),(0,i.kt)("h4",{id:"jsinject-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$jsinject"))),(0,i.kt)("p",null,"Forbids adding of javascript code to the page. You can read about scriptlets and javascript rules further."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$jsinject")," disables javascript on pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains.")),(0,i.kt)("h4",{id:"stealth-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$stealth"))),(0,i.kt)("p",null,"Disables the Stealth Mode module for all corresponding pages and requests."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"$stealth [= opt1 [| opt2 [| opt3 [...]]]]\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"opt(i)")," stand for certain Stealth Mode options disabled by the modifier. The modifier can contain any number of specific options (see below) or none. In the latter case the modifier disables all the Stealth Mode features."),(0,i.kt)("p",null,"The list of the available modifier options:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"searchqueries")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#searchqueries"},(0,i.kt)("strong",{parentName:"a"},"Hide your search queries"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"donottrack")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#donottrack"},(0,i.kt)("strong",{parentName:"a"},"Ask websites not to track you"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"3p-cookie")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#3p-cookie"},(0,i.kt)("strong",{parentName:"a"},"Self-destructing third-party cookies"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"1p-cookie")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#1p-cookie"},(0,i.kt)("strong",{parentName:"a"},"Self-destructing first-party cookies"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"3p-cache")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#3p-cache"},(0,i.kt)("strong",{parentName:"a"},"Disable cache for third-party requests"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"3p-auth")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#3p-auth"},(0,i.kt)("strong",{parentName:"a"},"Block third-party Authorization header"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"webrtc")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#webrtc"},(0,i.kt)("strong",{parentName:"a"},"Block WebRTC"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"push")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#push"},(0,i.kt)("strong",{parentName:"a"},"Block Push API"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"location")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#location"},(0,i.kt)("strong",{parentName:"a"},"Block Location API"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"flash")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#flash"},(0,i.kt)("strong",{parentName:"a"},"Block Flash"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"java")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#java"},(0,i.kt)("strong",{parentName:"a"},"Block Java"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"referrer")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#miscellaneous"},(0,i.kt)("strong",{parentName:"a"},"Hide Referer from third parties"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"useragent")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#useragent"},(0,i.kt)("strong",{parentName:"a"},"Hide your User-Agent"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ip")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#ip"},(0,i.kt)("strong",{parentName:"a"},"Hide your IP address"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"xclientdata")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#xclientdata"},(0,i.kt)("strong",{parentName:"a"},"Remove X-Client-Data header from HTTP requests"))," option"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"dpi")," disables ",(0,i.kt)("a",{parentName:"li",href:"../../stealth-mode#dpi"},(0,i.kt)("strong",{parentName:"a"},"Protect from DPI"))," option")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$stealth")," disables Stealth Mode for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," (and subdomains) requests, except for blocking cookies and hiding tracking parameters (see below)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||domain.com^$script,stealth,domain=example.com")," disables Stealth Mode only for script requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"domain.com")," (and its subdomains) on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$stealth=3p-cookie|dpi")," disables blocking third-party cookies and DPI fooling measures for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),".")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Blocking cookies and removing tracking parameters is achieved by using rules with the ",(0,i.kt)("a",{parentName:"p",href:"#cookie-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$cookie")),", ",(0,i.kt)("a",{parentName:"p",href:"#urltransform-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$urltransform"))," and ",(0,i.kt)("a",{parentName:"p",href:"#removeparam-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$removeparam"))," modifiers. Exception rules that contain only the ",(0,i.kt)("inlineCode",{parentName:"p"},"$stealth")," modifier will not do these things. If you want to completely disable all Stealth mode features for a given domain, you must include all three modifiers: ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.org^$stealth,removeparam,cookie"),".")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Modifier options must be lowercase, i.e. ",(0,i.kt)("inlineCode",{parentName:"li"},"$stealth=DPI")," will be rejected."),(0,i.kt)("li",{parentName:"ul"},"Modifier options cannot be negated, i.e. ",(0,i.kt)("inlineCode",{parentName:"li"},"$stealth=~3p-cookie")," will be rejected."),(0,i.kt)("li",{parentName:"ul"},"AdGuard Browser Extension supports only ",(0,i.kt)("inlineCode",{parentName:"li"},"searchqueries"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"donottrack"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"referrer"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"xclientdata"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"1p-cookie")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"3p-cookie")," options."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Stealth Mode is available in AdGuard for Windows, AdGuard for Mac, AdGuard for Android, and AdGuard Browser Extension. All other products will ignore the rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$stealth")," modifier."),(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$stealth")," modifier with specific options are supported by AdGuard for Windows, AdGuard for Mac, and AdGuard for Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.10 or later, and AdGuard Browser Extension with ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v3.0.0 or later."))),(0,i.kt)("h4",{id:"urlblock-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$urlblock"))),(0,i.kt)("p",null,"Disables blocking of all requests sent from the pages matching the rule and disables all ",(0,i.kt)("a",{parentName:"p",href:"#cookie-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$cookie"))," rules."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$urlblock")," \u2014 any requests sent from the pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains are not going to be blocked.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"In AdGuard for iOS and AdGuard for Safari, rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," work as ",(0,i.kt)("a",{parentName:"p",href:"#document-modifier"},"$document exclusion")," \u2014 unblock everything."),(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"exception-modifiers-generic-rules"},"Generic rules"),(0,i.kt)("p",null,"Before we can proceed to the next modifiers, we have to make a definition of ",(0,i.kt)("em",{parentName:"p"},"generic rules"),". The rule is generic if it is not limited to specific domains. Wildcard character ",(0,i.kt)("inlineCode",{parentName:"p"},"*")," is supported as well."),(0,i.kt)("p",null,"For example, these rules are generic:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"###banner\n*###banner\n#@#.adsblock\n*#@#.adsblock\n~domain.com###banner\n||domain.com^\n||domain.com^$domain=~example.com\n")),(0,i.kt)("p",null,"And these are not:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"domain.com###banner\n||domain.com^$domain=example.com\n")),(0,i.kt)("h4",{id:"genericblock-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$genericblock"))),(0,i.kt)("p",null,"Disables generic basic rules on pages that correspond to exception rule."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$genericblock")," disables generic basic rules on any pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"In AdGuard for iOS and AdGuard for Safari, rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$genericblock")," work as ",(0,i.kt)("a",{parentName:"p",href:"#document-modifier"},"$document exclusion")," \u2014 unblock everything."),(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$genericblock")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"generichide-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$generichide"))),(0,i.kt)("p",null,"Disables all generic ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-rules"},"cosmetic rules")," on pages that correspond to the exception rule."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$generichide")," disables generic cosmetic rules on any pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and its subdomains.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$ghide"),".")),(0,i.kt)("h4",{id:"specifichide-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"specifichide"))),(0,i.kt)("p",null,"Disables all specific element hiding and CSS rules, but not general ones. Has an opposite effect to ",(0,i.kt)("a",{parentName:"p",href:"#generichide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$generichide")),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$specifichide")," disables ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org##.banner")," but not ",(0,i.kt)("inlineCode",{parentName:"li"},"##.banner"),".")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"You may use a shorter name (alias) instead of using the full modifier name: ",(0,i.kt)("inlineCode",{parentName:"p"},"$shide"),".")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"All cosmetic rules \u2014 not just specific ones \u2014 can be disabled by ",(0,i.kt)("a",{parentName:"p",href:"#elemhide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$elemhide")," modifier"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$specifichide")," modifier are not supported by AdGuard for iOS, AdGuard for Safari, and AdGuard Content Blocker.")),(0,i.kt)("h3",{id:"advanced-modifiers"},"Advanced capabilities"),(0,i.kt)("p",null,"These modifiers are able to completely change the behavior of basic rules."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Modifier \\ Products"),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for Windows, Mac, Android"},"CoreLibs apps")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Chrome and other Chromium-based browsers"},"AdGuard for Chromium")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Firefox"},"AdGuard for Firefox")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for iOS and AdGuard Pro for iOS"},"iOS\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"Safari\uc6a9 AdGuard"},"Safari\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Content Blocker for Samsung Internet and Yandex Browser on Android"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#all-modifier"},"$all")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#badfilter-modifier"},"$badfilter")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#cookie-modifier"},"$cookie")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#csp-modifier"},"$csp")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#hls-modifier"},"$hls")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#inline-font-modifier"},"$inline-font")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#inline-script-modifier"},"$inline-script")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#jsonprune-modifier"},"$jsonprune")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#xmlprune-modifier"},"$xmlprune")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#network-modifier"},"$network")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permissions-modifier"},"$permissions")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705 ",(0,i.kt)("a",{parentName:"td",href:"#permissions-modifier-limitations"},"*")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\ud83e\udde9"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\ud83e\udde9 ",(0,i.kt)("a",{parentName:"td",href:"#permissions-modifier-limitations"},"*")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#redirect-modifier"},"$redirect")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#redirect-rule-modifier"},"$redirect-rule")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#referrerpolicy-modifier"},"$referrerpolicy")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#removeheader-modifier"},"$removeheader")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#removeparam-modifier"},"$removeparam")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#replace-modifier"},"$replace")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#urltransform-modifier"},"$urltransform")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#noop-modifier"},"noop")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#empty-modifier",title:"deprecated"},"$empty \ud83d\udc4e")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#mp4-modifier",title:"deprecated"},"$mp4 \ud83d\udc4e")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u2705 * \u2014 supported, but reliability may vary or limitations may occur; check the modifier description for more details"),(0,i.kt)("li",{parentName:"ul"},"\ud83e\udde9 \u2014 may already be implemented in nightly or beta versions but is not yet supported in release versions"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"),(0,i.kt)("li",{parentName:"ul"},"\ud83d\udc4e \u2014 deprecated; still supported but will be removed in the future"))),(0,i.kt)("h4",{id:"all-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$all"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$all")," modifier is made of ",(0,i.kt)("a",{parentName:"p",href:"#content-type-modifiers"},"all content-types modifiers")," and ",(0,i.kt)("a",{parentName:"p",href:"#popup-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$popup")),". E.g. rule ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$all")," is converting into rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$document,subdocument,font,image,media,object,other,ping,script,stylesheet,websocket,xmlhttprequest,popup\n")),(0,i.kt)("p",null,"This modifier cannot be used as an exception with the ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," mark."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$all")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"badfilter-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$badfilter"))),(0,i.kt)("p",null,"The rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," modifier disable other basic rules to which they refer. It means that the text of the disabled rule should match the text of the ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," rule (without the ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," modifier)."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com$badfilter")," disables ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.com")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com$image,badfilter")," disables ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.com$image")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com$badfilter")," disables ",(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com$domain=domain.com,badfilter")," disables ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.com$domain=domain.com"))),(0,i.kt)("p",null,"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," modifier can disable other basic rules for specific domains if they fulfill the following conditions:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"The rule has a ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain")," modifier"),(0,i.kt)("li",{parentName:"ol"},"The rule does not have a negated domain ",(0,i.kt)("inlineCode",{parentName:"li"},"~")," in ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain")," modifier value")),(0,i.kt)("p",null,"In that case, the ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," rule will disable the corresponding rule for domains specified in both the ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," and basic rules. Please note that ",(0,i.kt)("a",{parentName:"p",href:"#wildcard-for-tld"},"wildcard-TLD logic")," works here as well."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org|example.io")," is disabled for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," by ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com,badfilter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org|example.io")," is disabled for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," by ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org,badfilter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.io")," are disabled completely by ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org|example.io,badfilter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org|example.io")," is disabled completely by ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.*,badfilter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.*")," is disabled for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," by ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org,badfilter")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|example.org|example.io")," is NOT disabled for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," by ",(0,i.kt)("inlineCode",{parentName:"li"},"/some$domain=example.com|~example.org,badfilter")," because the value of ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain")," modifier contains a negated domain")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$badfilter")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"cookie-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$cookie"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$cookie")," modifier completely changes rule behavior. Instead of blocking a request, this modifier makes AdGuard suppress or modify the ",(0,i.kt)("inlineCode",{parentName:"p"},"Cookie")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Set-Cookie")," headers."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple rules matching a single request")),(0,i.kt)("p",null,"In case if multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$cookie")," rules match a single request, we will apply each of them one by one."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"$cookie [= name[; maxAge = seconds [; sameSite = strategy ]]]\n")),(0,i.kt)("p",null,"where:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"name"))," \u2014 optional, string or regular expression to match cookie name."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"seconds"))," \u2014 number of seconds for current time to offset the expiration date of cookie."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"strategy"))," \u2014 string for ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite"},"Same-Site")," strategy to make cookie use.")),(0,i.kt)("p",null,"For example,"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$cookie=NAME;maxAge=3600;sameSite=lax\n")),(0,i.kt)("p",null,"every time AdGuard encounters a cookie called ",(0,i.kt)("inlineCode",{parentName:"p"},"NAME")," in a request to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org"),", it will do the following:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Set its expiration date to current time plus ",(0,i.kt)("inlineCode",{parentName:"li"},"3600")," seconds"),(0,i.kt)("li",{parentName:"ul"},"Makes the cookie use ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite"},"Same-Site"),' "lax" strategy.')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Escaping special characters")),(0,i.kt)("p",null,"If regular expression ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," is used for matching, two characters must be escaped: comma ",(0,i.kt)("inlineCode",{parentName:"p"},",")," and dollar sign ",(0,i.kt)("inlineCode",{parentName:"p"},"$"),". Use backslash ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," escape each of them. For example, escaped comma looks like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"\\,"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$cookie")," blocks ",(0,i.kt)("strong",{parentName:"li"},"all")," cookies set by ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"; this is an equivalent to setting ",(0,i.kt)("inlineCode",{parentName:"li"},"maxAge=0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$cookie=__cfduid")," blocks CloudFlare cookie everywhere"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$cookie=/__utm[a-z]/")," blocks Google Analytics cookies everywhere"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||facebook.com^$third-party,cookie=c_user")," prevents Facebook from tracking you even if you are logged in")),(0,i.kt)("p",null,"There are two methods to deactivate ",(0,i.kt)("inlineCode",{parentName:"p"},"$cookie")," rules: the primary method involves using an exception marked with ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.org^$cookie"),". The alternative method employs a ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception (also included under the ",(0,i.kt)("inlineCode",{parentName:"p"},"$document")," exception alias \u2014 ",(0,i.kt)("inlineCode",{parentName:"p"},"$elemhide,jsinject,content,urlblock,extension"),"). Here's how it works:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$cookie")," unblocks all cookies set by ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$urlblock")," unblocks all cookies set by ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and disables blocking of all requests sent from ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$cookie=concept")," unblocks a single cookie named ",(0,i.kt)("inlineCode",{parentName:"li"},"concept")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$cookie=/^_ga_/")," unblocks every cookie that matches the regular expression")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"$cookie")," rules support three types of modifiers: ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$~domain"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$important"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$third-party"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"$~third-party"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$cookie")," modifier are not supported by AdGuard Content Blocker, AdGuard for iOS, and AdGuard for Safari.")),(0,i.kt)("h4",{id:"csp-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$csp"))),(0,i.kt)("p",null,"This modifier completely changes the rule behavior. If it is applied to a rule, the rule will not block the matching request. Response headers will be modified instead."),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"In order to use this type of rules, it is required to have the basic understanding of the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"},"Content Security Policy")," security layer."),(0,i.kt)("p",null,":::"),(0,i.kt)("p",null,"For the requests matching a ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," rule, we will strengthen response security policy by enhancing the content security policy, similar to the content security policy of the ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," modifier contents. ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," rules are applied independently from any other rule type. ",(0,i.kt)("strong",{parentName:"p"},"Only document-level exceptions")," can influence it (see the examples section), but no other basic rules."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple rules matching a single request")),(0,i.kt)("p",null,"In case if multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," rules match a single request, we will apply each of them."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," value syntax is similar to the Content Security Policy header syntax."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," value can be empty in the case of exception rules. See examples section below."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$csp=frame-src 'none'")," blocks all frames on example.org and its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org/page/*$csp=frame-src 'none'")," disables all rules with the ",(0,i.kt)("inlineCode",{parentName:"li"},"$csp")," modifier exactly matching ",(0,i.kt)("inlineCode",{parentName:"li"},"frame-src 'none'")," on all the pages matching the rule pattern. For instance, the rule above."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org/page/*$csp")," disables all the ",(0,i.kt)("inlineCode",{parentName:"li"},"$csp")," rules on all the pages matching the rule pattern."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$csp=script-src 'self' 'unsafe-eval' http: https:")," disables inline scripts on all the pages matching the rule pattern."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$document")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$urlblock")," disables all the ",(0,i.kt)("inlineCode",{parentName:"li"},"$csp")," rules on all the pages matching the rule pattern.")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"There are a few characters forbidden in the ",(0,i.kt)("inlineCode",{parentName:"li"},"$csp")," value: ",(0,i.kt)("inlineCode",{parentName:"li"},","),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$csp")," rules support limited list of modifiers: ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$important"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$subdocument"),"."),(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"report-*")," directives are considered invalid."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," modifier are not supported by AdGuard Content Blocker, AdGuard for iOS and AdGuard for Safari.")),(0,i.kt)("h4",{id:"hls-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$hls"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$hls")," rules modify the response of a matching request. They are intended as a convenient way to remove segments from ",(0,i.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc8216"},"HLS playlists (RFC 8216)"),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},'The word "segment" in this document means either a "Media Segment" or a "playlist" as part of a "Master Playlist": ',(0,i.kt)("inlineCode",{parentName:"p"},"$hls"),' rules do not distinguish between a "Master Playlist" and a "Media Playlist".')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$hls=urlpattern")," removes segments whose URL matches the URL pattern ",(0,i.kt)("inlineCode",{parentName:"li"},"urlpattern"),". The pattern works just like the one in basic URL rules, however, the characters ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$")," and ",(0,i.kt)("inlineCode",{parentName:"li"},",")," must be escaped with ",(0,i.kt)("inlineCode",{parentName:"li"},"\\")," inside ",(0,i.kt)("inlineCode",{parentName:"li"},"urlpattern"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$hls=/regexp/options")," removes segments where the URL or one of the tags (for certain options, if present) is matched by the regular expression ",(0,i.kt)("inlineCode",{parentName:"li"},"regexp"),". Available ",(0,i.kt)("inlineCode",{parentName:"li"},"options")," are:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"t")," \u2014 instead of testing the segment's URL, test each of the segment's tags against the regular expression. A segment with a matching tag is removed;"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"i")," \u2014 make the regular expression case-insensitive.")))),(0,i.kt)("p",null,"The characters ",(0,i.kt)("inlineCode",{parentName:"p"},"/"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," and ",(0,i.kt)("inlineCode",{parentName:"p"},",")," must be escaped with ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," inside ",(0,i.kt)("inlineCode",{parentName:"p"},"regexp"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Exceptions")),(0,i.kt)("p",null,"Basic URL exceptions shall not disable rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$hls")," modifier. They can be disabled as described below:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$hls")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rules for responses from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$hls=text")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rules with the value of the ",(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," modifier equal to ",(0,i.kt)("inlineCode",{parentName:"li"},"text")," for responses from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"$hls")," rules can also be disabled by ",(0,i.kt)("inlineCode",{parentName:"p"},"$document"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$content")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception rules.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$hls")," rules match the same request, their effect is cumulative.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$hls=\\/videoplayback^?*&source=dclk_video_ads")," removes all segments with the matching URL."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$hls=/\\/videoplayback\\/?\\?.*\\&source=dclk_video_ads/i")," achieves more or less the same with a regular expression instead of a URL pattern."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$hls=/#UPLYNK-SEGMENT:.*\\,ad/t")," removes all segments which have the matching tag.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Anatomy of an HLS playlist")),(0,i.kt)("p",null,"A quick summary of the ",(0,i.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc8216"},"specification"),":"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"An HLS playlist is a collection of text lines"),(0,i.kt)("li",{parentName:"ol"},"A line may be empty, a comment (starts with ",(0,i.kt)("inlineCode",{parentName:"li"},"#"),"), a tag (also starts with ",(0,i.kt)("inlineCode",{parentName:"li"},"#"),", can only be recognized by name) or a URL"),(0,i.kt)("li",{parentName:"ol"},'A URL line is called a "segment"'),(0,i.kt)("li",{parentName:"ol"},"Tags may apply to a single segment, i.e. the first URL line after the tag, to all segments following the tag and until the tag with the same name, or to the whole playlist")),(0,i.kt)("p",null,"Some points specific to the operation of ",(0,i.kt)("inlineCode",{parentName:"p"},"$hls")," rules:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"When a segment is removed, all of the tags that apply only to that segment are also removed"),(0,i.kt)("li",{parentName:"ol"},"When there is a tag that applies to multiple segments, and all of those segments are removed, the tag is also removed"),(0,i.kt)("li",{parentName:"ol"},"Since there is no way to recognize different kinds of tags by syntax, we recognize all of the tags specified by the RFC, plus some non-standard tags that we have seen in the field. Any lines starting with ",(0,i.kt)("inlineCode",{parentName:"li"},"#")," and not recognized as a tag are passed through without modification, and are not matched against the rules"),(0,i.kt)("li",{parentName:"ol"},"Tags will not be matched if they apply to the entire playlist, and ",(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rrules cannot be used to remove them, as these rule types are intended for segment removals. If you know what you are doing, you can use ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules to remove or rewrite just a single tag from the playlist")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"An example of a transformation done by the rules:")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Original response"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"#EXTM3U\n#EXT-X-TARGETDURATION:10\n#EXTINF,5\npreroll.ts\n#UPLYNK-SEGMENT:abc123,ad\n#UPLYNK-KEY:aabb1122\n#EXT-X-DISCONTINUITY\n#EXTINF,10\n01.ts\n#EXTINF,10\n02.ts\n#UPLYNK-SEGMENT:abc123,segment\n#UPLYNK-KEY:ccdd2233\n#EXT-X-DISCONTINUITY\n#EXTINF,10\n01.ts\n#EXTINF,10\n02.ts\n#EXT-X-ENDLIST\n"))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Applied rules"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$hls=preroll\n||example.org^$hls=/#UPLYNK-SEGMENT:.*\\,ad/t\n"))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Modified response"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"#EXTM3U\n#EXT-X-TARGETDURATION:10\n#UPLYNK-SEGMENT:abc123,segment\n#UPLYNK-KEY:ccdd2233\n#EXT-X-DISCONTINUITY\n#EXTINF,10\n01.ts\n#EXTINF,10\n02.ts\n#EXT-X-ENDLIST\n"))),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rules are only allowed ",(0,i.kt)("a",{parentName:"li",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"in trusted filters")),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rules are compatible with the modifiers ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$third-party"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$app"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$important"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$match-case"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"$xmlhttprequest")," only."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rules only apply to HLS playlists, which are UTF-8 encoded text starting with the line ",(0,i.kt)("inlineCode",{parentName:"li"},"#EXTM3U"),". Any other response will not be modified by these rules."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$hls")," rules do not apply if the size of the original response is more than 10 MB."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$hls")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.10 or later.")),(0,i.kt)("h4",{id:"inline-script-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$inline-script"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$inline-script")," modifier is designed to block inline JavaScript embedded into the web page, using Content Security Policy (CSP). It improves security and privacy by preventing application of inline ads or potentially malicious scripts. The rule ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$inline-script")," is converting into the CSP-syntax rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$csp=script-src 'self' 'unsafe-eval' http: https: data: blob: mediastream: filesystem:\n")),(0,i.kt)("h4",{id:"inline-font-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$inline-font"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$inline-font")," modifier is designed to block inline fonts embedded into the web page, using Content Security Policy (CSP). It improves security and privacy by preventing application of inline fonts that could be used for data collection and fingerprinting. The rule ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$inline-font")," is converting into the CSP-syntax rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$csp=font-src 'self' 'unsafe-eval' http: https: data: blob: mediastream: filesystem:\n")),(0,i.kt)("h4",{id:"jsonprune-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$jsonprune"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$jsonprune")," rules modify the response to a matching request by removing JSON items that match a modified ",(0,i.kt)("a",{parentName:"p",href:"https://goessner.net/articles/JsonPath/"},"JSONPath")," expression. They do not modify responses which are not valid JSON documents."),(0,i.kt)("p",null,"In AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.11 or later, ",(0,i.kt)("inlineCode",{parentName:"p"},"$jsonprune")," also supports modifying JSONP (padded JSON) documents."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$jsonprune=expression")," removes items that match the modified JSONPath expression ",(0,i.kt)("inlineCode",{parentName:"li"},"expression")," from the response.")),(0,i.kt)("p",null,"Due to the way rule parsing works, the characters ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," and ",(0,i.kt)("inlineCode",{parentName:"p"},",")," must be escaped with ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," inside ",(0,i.kt)("inlineCode",{parentName:"p"},"expression"),"."),(0,i.kt)("p",null,"The modified JSONPath syntax has the following differences from the original:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Script expressions are not supported"),(0,i.kt)("li",{parentName:"ol"},"The supported filter expressions are:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"?(has <key>)")," \u2014 true if the current object has the specified key"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"?(key-eq <key> <value>)")," \u2014 true if the current object has the specified key, and its value is equal to the specified value"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"?(key-substr <key> <value>)")," \u2014 true if the specified value is a substring of the value of the specified key of the current object"))),(0,i.kt)("li",{parentName:"ol"},"Whitespace outside of double- or single-quoted strings has no meaning"),(0,i.kt)("li",{parentName:"ol"},"Both double- and single-quoted strings can be used"),(0,i.kt)("li",{parentName:"ol"},"Expressions ending with ",(0,i.kt)("inlineCode",{parentName:"li"},"..")," are not supported"),(0,i.kt)("li",{parentName:"ol"},"Multiple array slices can be specified in square brackets")),(0,i.kt)("p",null,"There are various online tools that make working with JSONPath expressions more convenient:"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.site24x7.com/tools/jsonpath-finder-validator.html"},"https://www.site24x7.com/tools/jsonpath-finder-validator.html")," ",(0,i.kt)("a",{parentName:"p",href:"https://jsonpathfinder.com/"},"https://jsonpathfinder.com/")," ",(0,i.kt)("a",{parentName:"p",href:"https://jsonpath.com/"},"https://jsonpath.com/")),(0,i.kt)("p",null,"Keep in mind, though, that all JSONPath implementations have unique features/quirks and are subtly incompatible with each other."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Exceptions")),(0,i.kt)("p",null,"Basic URL exceptions shall not disable rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$jsonprune")," modifier. They can be disabled as described below:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$jsonprune")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$jsonprune")," rules for responses from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$jsonprune=text")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$jsonprune")," rules with the value of the ",(0,i.kt)("inlineCode",{parentName:"li"},"$jsonprune")," modifier equal to ",(0,i.kt)("inlineCode",{parentName:"li"},"text")," for responses from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$jsonprune")," rules can also be disabled by ",(0,i.kt)("inlineCode",{parentName:"p"},"$document"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$content")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception rules."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$jsonprune")," rules match the same request, they are sorted in lexicographical order, the first rule is applied to the original response, and each of the remaining rules is applied to the result of applying the previous one.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'||example.org^$jsonprune=\\$..[one\\, "two three"]'),' removes all occurrences of the keys "one" and "two three" anywhere in the JSON document.')),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "one": 1,\n    "two": {\n        "two three": 23,\n        "four five": 45\n    }\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "two": {\n        "four five": 45\n    }\n}\n'))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$jsonprune=\\$.a[?(has ad_origin)]")," removes all children of ",(0,i.kt)("inlineCode",{parentName:"li"},"a")," that have an ",(0,i.kt)("inlineCode",{parentName:"li"},"ad_origin")," key.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "a": [\n        {\n            "ad_origin": "https://example.org",\n            "b": 42\n        },\n        {\n            "b": 1234\n        }\n    ]\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "a": [\n        {\n            "b": 1234\n        }\n    ]\n}\n'))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$jsonprune=\\$.*.*[?(key-eq 'Some key' 'Some value')]"),' removes all items that are at nesting level 3 and have a property "Some key" equal to "Some value".')),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "a": {"b": {"c": {"Some key": "Some value"}, "d": {"Some key": "Other value"}}},\n    "e": {"f": [{"Some key": "Some value"}, {"Some key": "Other value"}]}\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "a": {"b": {"d": {"Some key": "Other value"}}},\n    "e": {"f": [{"Some key": "Other value"}]}\n}\n'))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Nested JSONPath expressions")),(0,i.kt)("p",null,"In AdGuard for Windows, Mac and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.11 or later, JSONPath expressions may be used as keys in filter expressions."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'||example.org^$jsonprune=\\$.elems[?(has "\\$.a.b.c")]')," removes all children of ",(0,i.kt)("inlineCode",{parentName:"li"},"elems")," which have a property selectable by the JSONPath expression ",(0,i.kt)("inlineCode",{parentName:"li"},"$.a.b.c"),".")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "elems": [\n        {\n            "a": {"b": {"c": 123}},\n            "k": "v"\n        },\n        {\n            "d": {"e": {"f": 123}},\n            "k1": "v1"\n        }\n    ]\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "elems": [\n        {\n            "d": {"e": {"f": 123}},\n            "k1": "v1"\n        }\n    ]\n}\n'))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'||example.org^$jsonprune=\\$.elems[?(key-eq "\\$.a.b.c" "abc")]')," removes all children of ",(0,i.kt)("inlineCode",{parentName:"li"},"elems")," which have a property selectable by the JSONPath expression ",(0,i.kt)("inlineCode",{parentName:"li"},"$.a.b.c")," with a value equal to ",(0,i.kt)("inlineCode",{parentName:"li"},'"abc"'),".")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "elems": [\n        {\n            "a": {"b": {"c": 123}},\n        },\n        {\n            "a": {"b": {"c": "abc"}}\n        }\n    ]\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "elems": [\n        {\n            "a": {"b": {"c": 123}}\n        }\n    ]\n}\n'))),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$jsonprune")," rules are only compatible with these modifiers: ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$third-party"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$app"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$important"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$match-case"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"$xmlhttprequest"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$jsonprune")," rules do not apply if the size of the original response is greater than 10 MB."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$jsonprune")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.10 or later.")),(0,i.kt)("h4",{id:"xmlprune-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$xmlprune"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$xmlprune")," rules modify the response to a matching request by removing XML items that match an ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/1999/REC-xpath-19991116/"},"XPath 1.0")," expression. The expression must return a ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/1999/REC-xpath-19991116/#node-sets"},"node-set"),". ",(0,i.kt)("inlineCode",{parentName:"p"},"$xmlprune")," rules do not modify responses which are not well-formed XML documents."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$xmlprune=expression")," removes items that match the XPath expression ",(0,i.kt)("inlineCode",{parentName:"li"},"expression")," from the response.")),(0,i.kt)("p",null,"Due to the way rule parsing works, the characters ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," and ",(0,i.kt)("inlineCode",{parentName:"p"},",")," must be escaped with ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," inside ",(0,i.kt)("inlineCode",{parentName:"p"},"expression"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Exceptions")),(0,i.kt)("p",null,"Basic URL exceptions shall not disable rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$xmlprune")," modifier. They can be disabled as described below:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$xmlprune")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$xmlprune")," rules for responses from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$xmlprune=text")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$xmlprune")," rules with the value of the ",(0,i.kt)("inlineCode",{parentName:"li"},"$xmlprune")," modifier equal to ",(0,i.kt)("inlineCode",{parentName:"li"},"text")," for responses from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$xmlprune")," rules can also be disabled by ",(0,i.kt)("inlineCode",{parentName:"p"},"$document"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$content")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception rules."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$xmlprune")," rules match the same request, they are applied in lexicographical order.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$xmlprune=/bookstore/book[position() mod 2 = 1]")," removes odd-numbered books from the bookstore.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n\n<bookstore>\n\n  <book category="cooking">\n    <title lang="en">Everyday Italian</title>\n    <author>Giada De Laurentiis</author>\n    <year>2005</year>\n    <price>30.00</price>\n  </book>\n\n  <book category="children">\n    <title lang="en">Harry Potter</title>\n    <author>J K. Rowling</author>\n    <year>2005</year>\n    <price>29.99</price>\n  </book>\n\n  <book category="web">\n    <title lang="en">XQuery Kick Start</title>\n    <author>James McGovern</author>\n    <author>Per Bothner</author>\n    <author>Kurt Cagle</author>\n    <author>James Linn</author>\n    <author>Vaidyanathan Nagarajan</author>\n    <year>2003</year>\n    <price>49.99</price>\n  </book>\n\n  <book category="web">\n    <title lang="en">Learning XML</title>\n    <author>Erik T. Ray</author>\n    <year>2003</year>\n    <price>39.95</price>\n  </book>\n\n</bookstore>\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n\n<bookstore>\n\n\n\n<book category="children">\n  <title lang="en">Harry Potter</title>\n  <author>J K. Rowling</author>\n  <year>2005</year>\n  <price>29.99</price>\n</book>\n\n\n\n<book category="web">\n  <title lang="en">Learning XML</title>\n  <author>Erik T. Ray</author>\n  <year>2003</year>\n  <price>39.95</price>\n</book>\n\n</bookstore>\n'))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$xmlprune=/bookstore/book[year = 2003]")," removes books from the year 2003 from the bookstore.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n\n<bookstore>\n\n  <book category="cooking">\n    <title lang="en">Everyday Italian</title>\n    <author>Giada De Laurentiis</author>\n    <year>2005</year>\n    <price>30.00</price>\n  </book>\n\n  <book category="children">\n    <title lang="en">Harry Potter</title>\n    <author>J K. Rowling</author>\n    <year>2005</year>\n    <price>29.99</price>\n  </book>\n\n  <book category="web">\n    <title lang="en">XQuery Kick Start</title>\n    <author>James McGovern</author>\n    <author>Per Bothner</author>\n    <author>Kurt Cagle</author>\n    <author>James Linn</author>\n    <author>Vaidyanathan Nagarajan</author>\n    <year>2003</year>\n    <price>49.99</price>\n  </book>\n\n  <book category="web">\n    <title lang="en">Learning XML</title>\n    <author>Erik T. Ray</author>\n    <year>2003</year>\n    <price>39.95</price>\n  </book>\n\n</bookstore>\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n\n<bookstore>\n\n<book category="cooking">\n  <title lang="en">Everyday Italian</title>\n  <author>Giada De Laurentiis</author>\n  <year>2005</year>\n  <price>30.00</price>\n</book>\n\n<book category="children">\n  <title lang="en">Harry Potter</title>\n  <author>J K. Rowling</author>\n  <year>2005</year>\n  <price>29.99</price>\n</book>\n\n\n\n\n\n</bookstore>\n'))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$xmlprune=//*/@*")," removes all attributes from all elements.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Input"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n\n<bookstore location="cy">\n\n  <book category="cooking">\n    <title lang="en">Everyday Italian</title>\n    <author>Giada De Laurentiis</author>\n    <year>2005</year>\n    <price>30.00</price>\n  </book>\n\n</bookstore>\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n\n<bookstore>\n\n  <book>\n    <title>Everyday Italian</title>\n    <author>Giada De Laurentiis</author>\n    <year>2005</year>\n    <price>30.00</price>\n  </book>\n\n</bookstore>\n'))),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$xmlprune")," rules are only compatible with these modifiers: ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$third-party"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$app"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$important"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$match-case"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"$xmlhttprequest"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$xmlprune")," rules do not apply if the size of the original response is greater than 10 MB."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$xmlprune")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.15 or later.")),(0,i.kt)("h4",{id:"network-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$network"))),(0,i.kt)("p",null,"This is basically a Firewall-like rule allowing to fully block or unblock access to a specified remote address."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"$network")," rules match ",(0,i.kt)("strong",{parentName:"li"},"IP addresses only"),"! You cannot use them to block or unblock access to a domain."),(0,i.kt)("li",{parentName:"ol"},"To match an IPv6 address, you have to use the collapsed syntax, e.g. use ",(0,i.kt)("inlineCode",{parentName:"li"},"[2001:4860:4860::8888]$network")," instead of ",(0,i.kt)("inlineCode",{parentName:"li"},"[2001:4860:4860:0:0:0:0:8888]$network"),"."),(0,i.kt)("li",{parentName:"ol"},"An allowlist ",(0,i.kt)("inlineCode",{parentName:"li"},"$network")," rule makes AdGuard bypass data to the matching endpoint, hence there will be no further filtering at all."),(0,i.kt)("li",{parentName:"ol"},"If the IP part starts and ends with ",(0,i.kt)("inlineCode",{parentName:"li"},"/")," character, it is treated as a regular expression.")),(0,i.kt)("p",null,"We recommend to get acquainted with this ",(0,i.kt)("a",{parentName:"p",href:"#regexp-support"},"article")," for better understanding of regular expressions."),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$network")," modifier can only be used in rules together with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$app")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$important")," modifiers, and not with any other modifiers.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"174.129.166.49:3478^$network")," blocks access to ",(0,i.kt)("inlineCode",{parentName:"li"},"174.129.166.49:3478")," (but not to ",(0,i.kt)("inlineCode",{parentName:"li"},"174.129.166.49:34788"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[2001:4860:4860::8888]:443^$network")," blocks access to ",(0,i.kt)("inlineCode",{parentName:"li"},"[2001:4860:4860::8888]:443"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"174.129.166.49$network")," blocks access to ",(0,i.kt)("inlineCode",{parentName:"li"},"174.129.166.49:*"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@174.129.166.49$network")," makes AdGuard bypass data to the endpoint. No other rules will be applied."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/.+:3[0-9]{4}/$network")," blocks access to any port from 30000 to 39999."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"/8.8.8.(:?8|4)/$network")," blocks access to both ",(0,i.kt)("inlineCode",{parentName:"li"},"8.8.8.8")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"8.8.8.4"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Only AdGuard for Windows, Mac, and Android are technically capable of using rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$network")," modifier.")),(0,i.kt)("h4",{id:"permissions-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$permissions"))),(0,i.kt)("p",null,"This modifier completely changes the rule behavior. If it is applied to a rule, the rule will not block the matching request. Response headers will be modified instead."),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"In order to use this type of rules, it is required to have a basic understanding of the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Permissions_Policy"},"Permissions Policy")," security layer."),(0,i.kt)("p",null,":::"),(0,i.kt)("p",null,"For the requests matching a ",(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," rule, AdGuard strengthens response's permissions policy by adding an additional permission policy equal to the ",(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," modifier contents. ",(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," rules are applied independently from any other rule type. ",(0,i.kt)("strong",{parentName:"p"},"Only document-level exceptions")," can influence it (see the examples section), but no other basic rules."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," value syntax is similar to the ",(0,i.kt)("inlineCode",{parentName:"p"},"Permissions-Policy")," header ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy"},"syntax")," with one exception: comma that separates several features ",(0,i.kt)("strong",{parentName:"p"},"MUST")," be escaped. Pipe separator ",(0,i.kt)("inlineCode",{parentName:"p"},"|")," instead of escaped comma is supported as well for better compatibility \u2014 see examples below."),(0,i.kt)("p",null,"The list of the available directives is available ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy#directives"},"here"),"."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," value can be empty in the case of exception rules \u2014 see examples below."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$permissions=autoplay=()")," disallows autoplay media requested through the ",(0,i.kt)("inlineCode",{parentName:"li"},"HTMLMediaElement")," interface across ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org/page/*$permissions=autoplay=()")," disables all rules with the ",(0,i.kt)("inlineCode",{parentName:"li"},"$permissions")," modifier exactly matching ",(0,i.kt)("inlineCode",{parentName:"li"},"autoplay=()")," on all the pages matching the rule pattern. For instance, the rule above. It is important to note that the exception rule only takes effect in the case of an ",(0,i.kt)("strong",{parentName:"li"},"exact value match"),". For example, if you want to disable the rule  ",(0,i.kt)("inlineCode",{parentName:"li"},"$permissions=a=()\\,b=()"),", you need exception rule ",(0,i.kt)("inlineCode",{parentName:"li"},"@@$permissions=a=()\\,b=()"),", and ",(0,i.kt)("strong",{parentName:"li"},"not")," ",(0,i.kt)("inlineCode",{parentName:"li"},"@@$permissions=b=()\\,a=()"),", ",(0,i.kt)("strong",{parentName:"li"},"nor")," ",(0,i.kt)("inlineCode",{parentName:"li"},"@@$permissions=b=()")," because ",(0,i.kt)("inlineCode",{parentName:"li"},"b=()\\,a=()")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"b=()")," does not match with ",(0,i.kt)("inlineCode",{parentName:"li"},"a=()\\,b=()"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org/page/*$permissions")," disables all the ",(0,i.kt)("inlineCode",{parentName:"li"},"$permissions")," rules on all the pages matching the rule pattern."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$domain=example.org|example.com,permissions=storage-access=()\\, camera=()")," disallows using the Storage Access API to request access to unpartitioned cookies and using video input devices across ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$permissions=storage-access=()|camera=()")," \u2014 for better compatibility, we also support pipe-separated values for ",(0,i.kt)("inlineCode",{parentName:"li"},"$permissions")," modifier."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$document")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$urlblock")," disables all the ",(0,i.kt)("inlineCode",{parentName:"li"},"$permission")," rules on all the pages matching the rule pattern.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," rules only take effect for main frame and sub frame requests. This means they are applied when a page is loaded or when an iframe is loaded.")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"If there are multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," rules that match the same request, multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"Permissions-Policy")," headers will be added to the response for each rule with their ",(0,i.kt)("inlineCode",{parentName:"p"},"$permissions")," value. So if you have two rules: ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$permissions=autoplay=()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$permissions=geolocation=()\\,camera=()")," that match the same request, the response will contain two ",(0,i.kt)("inlineCode",{parentName:"p"},"Permissions-Policy")," headers: ",(0,i.kt)("inlineCode",{parentName:"p"},"autoplay=()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"geolocation=()\\,camera=()"),".")),(0,i.kt)("h5",{id:"permissions-modifier-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},"$permissions")," modifier limitations"),(0,i.kt)("admonition",{title:"Limitations",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Firefox ignores the ",(0,i.kt)("inlineCode",{parentName:"p"},"Permissions-Policy")," header. For more information, see ",(0,i.kt)("a",{parentName:"p",href:"https://bugzilla.mozilla.org/show_bug.cgi?id=1694922"},"this issue"),".")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"Characters forbidden in the ",(0,i.kt)("inlineCode",{parentName:"li"},"$permissions")," value: ",(0,i.kt)("inlineCode",{parentName:"li"},"$")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"$permissions")," is compatible with three types of modifiers: ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$important"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"$subdocument"),"."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"li"},"$permissions")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.11 or later, and AdGuard Browser Extension with ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v3.0.0 or later."),(0,i.kt)("li",{parentName:"ul"},"Pipe separator ",(0,i.kt)("inlineCode",{parentName:"li"},"|")," instead of escaped comma is supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.14 or later, and AdGuard Browser Extension with ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v3.0.0 or later."))),(0,i.kt)("h4",{id:"redirect-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$redirect"))),(0,i.kt)("p",null,'AdGuard is able to redirect web requests to a local "resource".'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,"AdGuard uses the same filtering rule syntax as uBlock Origin. Also, it is compatible with ABP ",(0,i.kt)("inlineCode",{parentName:"p"},"$rewrite=abp-resource")," modifier."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," is a modifier for the ",(0,i.kt)("a",{parentName:"p",href:"#basic-rules"},"basic filtering rules")," so rules with this modifier support all other basic modifiers like ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$third-party"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$script"),", etc."),(0,i.kt)("p",null,"The value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," modifier must be the name of the resource that will be used for redirection."),(0,i.kt)("h5",{id:"disabling-redirect-rules"},"Disabling ",(0,i.kt)("inlineCode",{parentName:"h5"},"$redirect")," rules"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org/script.js$script,redirect=noopjs")," \u2014 this rule redirects all requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org/script.js")," to the resource named ",(0,i.kt)("inlineCode",{parentName:"li"},"noopjs"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org/test.mp4$media,redirect=noopmp4-1s")," \u2014 this rule redirects all requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org/test.mp4")," to the resource named ",(0,i.kt)("inlineCode",{parentName:"li"},"noopmp4-1s"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$redirect")," will disable all ",(0,i.kt)("inlineCode",{parentName:"li"},"$redirect")," rules for URLs that match ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$redirect=nooptext")," will disable all rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$redirect=nooptext")," for any request that matches ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,"More information on redirects and their usage is available ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/Scriptlets#redirect-resources"},"on GitHub"),"."),(0,i.kt)("h5",{id:"redirect-rule-priorities"},"Priorities of ",(0,i.kt)("inlineCode",{parentName:"h5"},"$redirect")," rules"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," rules have higher priority than regular basic blocking rules. This means that if there is a basic blocking rule, the ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," rule will override it. Allowlist rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," mark have higher priority than ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," rules. If a basic rule with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$important")," modifier and the ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," rule matches the same URL, the latter is overridden unless it's also marked as ",(0,i.kt)("inlineCode",{parentName:"p"},"$important"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"In short: ",(0,i.kt)("inlineCode",{parentName:"strong"},"$important")," > ",(0,i.kt)("inlineCode",{parentName:"strong"},"@@")," > ",(0,i.kt)("inlineCode",{parentName:"strong"},"$redirect")," > ",(0,i.kt)("inlineCode",{parentName:"strong"},"basic rules"),".")),(0,i.kt)("p",null,"Go to ",(0,i.kt)("a",{parentName:"p",href:"#rule-priorities"},"rules priorities")," for more details."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$redirect")," modifier are not supported by AdGuard Content Blocker, AdGuard for iOS and AdGuard for Safari."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$redirect")," in uBlock Origin supports specifying priority, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"$redirect=noopjs:42"),". AdGuard does not support it and instead just discards the priority postfix."))),(0,i.kt)("h4",{id:"redirect-rule-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$redirect-rule"))),(0,i.kt)("p",null,"This is basically an alias to ",(0,i.kt)("a",{parentName:"p",href:"#redirect-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$redirect")),' since it has the same "redirection" values and the logic is almost similar. The difference is that ',(0,i.kt)("inlineCode",{parentName:"p"},"$redirect-rule")," is applied only in the case when the target request is blocked by a different basic rule."),(0,i.kt)("p",null,"Go to ",(0,i.kt)("a",{parentName:"p",href:"#rule-priorities"},"rules priorities")," for more details."),(0,i.kt)("p",null,"Negating ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect-rule")," works exactly the same way as for regular ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," rules. Even more than that, ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.org^$redirect")," will negate both ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect-rule")," rules."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org/script.js\n||example.org^$redirect-rule=noopjs\n")),(0,i.kt)("p",null,"In this case, only requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org/script.js"),' will be "redirected" to ',(0,i.kt)("inlineCode",{parentName:"p"},"noopjs"),". All other requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," will be kept intact."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect-rule")," modifier are not supported by AdGuard Content Blocker, AdGuard for iOS, and AdGuard for Safari.")),(0,i.kt)("h4",{id:"referrerpolicy-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$referrerpolicy"))),(0,i.kt)("p",null,"These rules allow overriding of a page's ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy"},"referrer policy"),". Responses to matching requests will have all of their ",(0,i.kt)("inlineCode",{parentName:"p"},"Referrer-Policy")," headers replaced with a single header with the value equal to the matching rule's modifier value. If the response carries an HTML document with a ",(0,i.kt)("inlineCode",{parentName:"p"},'<meta name="referrer"...')," tag, the ",(0,i.kt)("inlineCode",{parentName:"p"},"content")," attribute of the tag will also be replaced with the modifier value."),(0,i.kt)("p",null,"An exception rule with a modifier value disables the blocking rule with the same modifier value. An exception rule without a modifier value disables all matched referrer-policy rules."),(0,i.kt)("p",null,"If a request matches multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$referrerpolicy")," rules not disabled by exceptions, only one of them (it is not specified which one) is applied. ",(0,i.kt)("inlineCode",{parentName:"p"},"$referrerpolicy")," rules without specified ",(0,i.kt)("a",{parentName:"p",href:"#content-type-modifiers"},"content-type modifiers")," apply to ",(0,i.kt)("inlineCode",{parentName:"p"},"$document")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$subdocument")," content types."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com^$referrerpolicy=unsafe-url")," overrides the referrer policy for ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," with ",(0,i.kt)("inlineCode",{parentName:"li"},"unsafe-url"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com^$referrerpolicy=unsafe-url")," disables the previous rule."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.com/abcd.html^$referrerpolicy")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"$referrerpolicy")," rules on ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com/abcd.html"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$referrerpolicy")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.12 or later.")),(0,i.kt)("h4",{id:"removeheader-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$removeheader"))),(0,i.kt)("p",null,"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," modifier are intended to remove headers from HTTP requests and responses. The initial motivation for this rule type is to be able to get rid of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Refresh")," header which is often used to redirect users to an undesirable location. However, this is not the only case where this modifier can be useful."),(0,i.kt)("p",null,"Just like ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"$cookie"),", this modifier exists independently, rules with it do not depend on the regular basic rules, i.e. regular exception or blocking rules will not affect it. By default, it only affects response headers. However, you can also change it to remove headers from HTTP requests as well."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Basic syntax")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$removeheader=header-name")," removes a ",(0,i.kt)("strong",{parentName:"li"},"response")," header called ",(0,i.kt)("inlineCode",{parentName:"li"},"header-name")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$removeheader=request:header-name")," removes a ",(0,i.kt)("strong",{parentName:"li"},"request")," header called ",(0,i.kt)("inlineCode",{parentName:"li"},"header-name"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," is case-insensitive, but we suggest always using lower case."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Negating ",(0,i.kt)("inlineCode",{parentName:"strong"},"$removeheader"))),(0,i.kt)("p",null,"This type of rules works pretty much the same way it works with ",(0,i.kt)("inlineCode",{parentName:"p"},"$csp")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect")," modifiers."),(0,i.kt)("p",null,"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," to negate ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$removeheader")," negates ",(0,i.kt)("strong",{parentName:"li"},"all")," ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeheader")," rules for URLs that match ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$removeheader=header")," negates the rule with ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeheader=header")," for any request matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," rules can also be disabled by ",(0,i.kt)("inlineCode",{parentName:"p"},"$document")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception rules. But basic exception rules without modifiers will not do that. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^")," will not disable ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader=p")," for requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),", but ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^$urlblock")," will."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"In case of multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," rules matching a single request, we will apply each of them one by one.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$removeheader=refresh")," removes ",(0,i.kt)("inlineCode",{parentName:"p"},"Refresh")," header from all HTTP responses returned by ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," and its subdomains.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$removeheader=request:x-client-data")," removes ",(0,i.kt)("inlineCode",{parentName:"p"},"X-Client-Data")," header from all HTTP requests.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Next block of rules removes ",(0,i.kt)("inlineCode",{parentName:"p"},"Refresh")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Location")," headers from all HTTP responses returned by ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," save for requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org/path/*"),", for which no headers will be removed:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$removeheader=refresh\n||example.org^$removeheader=location\n@@||example.org/path/$removeheader\n")))),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This type of rules can be used ",(0,i.kt)("a",{parentName:"p",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"only in trusted filters")),"."),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In order to avoid compromising the security ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," cannot remove headers from the list below:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-allow-origin")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-allow-credentials")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-allow-headers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-allow-methods")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-expose-headers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-max-age")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-request-headers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"access-control-request-method")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"origin")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"timing-allow-origin")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"allow")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cross-origin-embedder-policy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cross-origin-opener-policy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cross-origin-resource-policy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"content-security-policy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"content-security-policy-report-only")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"expect-ct")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"feature-policy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"origin-isolation")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"strict-transport-security")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"upgrade-insecure-requests")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"x-content-type-options")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"x-download-options")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"x-frame-options")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"x-permitted-cross-domain-policies")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"x-powered-by")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"x-xss-protection")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"public-key-pins")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"public-key-pins-report-only")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-websocket-key")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-websocket-extensions")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-websocket-accept")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-websocket-protocol")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-websocket-version")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"p3p")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-fetch-mode")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-fetch-dest")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-fetch-site")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sec-fetch-user")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"referrer-policy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"content-type")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"content-length")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"accept")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"accept-encoding")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"host")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"connection")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"transfer-encoding")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"upgrade")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," rules are only compatible with ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$third-party"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$app"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$important"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"$match-case"),", and ",(0,i.kt)("a",{parentName:"p",href:"#content-type-modifiers"},"content type modifiers")," such as ",(0,i.kt)("inlineCode",{parentName:"p"},"$script")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$stylesheet"),". The rules which have any other modifiers are considered invalid and will be discarded.")))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeheader")," modifier are supported by AdGuard for Windows, Mac, and Android, and AdGuard Browser Extension for Chrome, Firefox, and Edge.")),(0,i.kt)("h4",{id:"removeparam-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$removeparam"))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"$queryprune")," is an alias of ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam"),". Since ",(0,i.kt)("inlineCode",{parentName:"p"},"$queryprune")," is deprecated, avoid using it and use ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," instead.")),(0,i.kt)("p",null,"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," modifier are intended to strip query parameters from requests' URLs. Please note that such rules are only applied to ",(0,i.kt)("inlineCode",{parentName:"p"},"GET"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"HEAD"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"OPTIONS"),", and sometimes ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," requests."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," rules that do not have any ",(0,i.kt)("a",{parentName:"p",href:"#content-type-modifiers"},"content type modifiers")," will match only requests where content type is ",(0,i.kt)("inlineCode",{parentName:"p"},"document"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Basic syntax")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam=param")," removes query parameter with the name ",(0,i.kt)("inlineCode",{parentName:"li"},"param")," from URLs of any request, e.g. a request to ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/page?param=1&another=2")," will be transformed into ",(0,i.kt)("inlineCode",{parentName:"li"},"http://example.com/page?another=2"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," modifier are supported by AdGuard for Windows, Mac and, Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.7 or later and AdGuard Browser Extension v3.6 or later.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Regular expressions")),(0,i.kt)("p",null,"You can also use regular expressions to match query parameters and/or their values:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam=/regexp/[options]")," \u2014 removes query parameters that matches the ",(0,i.kt)("inlineCode",{parentName:"li"},"regexp")," regular expression from URLs of any request. Unlike basic syntax, it means ",(0,i.kt)("em",{parentName:"li"},'"remove query parameters normalized to a ',(0,i.kt)("inlineCode",{parentName:"em"},"name=value")," string which match the ",(0,i.kt)("inlineCode",{parentName:"em"},"regexp"),' regular expression"'),". ",(0,i.kt)("inlineCode",{parentName:"li"},"[options]")," here is the list of regular expression options. At the moment, the only supported option is ",(0,i.kt)("inlineCode",{parentName:"li"},"i")," which makes matching case-insensitive.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Escaping special characters")),(0,i.kt)("p",null,"Do not forget to escape special characters like ",(0,i.kt)("inlineCode",{parentName:"p"},","),", ",(0,i.kt)("inlineCode",{parentName:"p"},"/")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," in the regular expressions. Use ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," character for that purpose. For example, an escaped comma should look like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"\\,"),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Regexp-type rules target both name and value of the parameter. To minimize mistakes, it is safer to start every regexp with ",(0,i.kt)("inlineCode",{parentName:"p"},"/^")," unless you specifically target parameter values.")),(0,i.kt)("p",null,"We will try to detect and ignore unescaped ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," automatically using a simple rule of thumb \u2014 it is not an options delimiter if all three are true:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"It looks like ",(0,i.kt)("inlineCode",{parentName:"li"},"$/")),(0,i.kt)("li",{parentName:"ol"},"There is another slash character ",(0,i.kt)("inlineCode",{parentName:"li"},"/")," to the left of it"),(0,i.kt)("li",{parentName:"ol"},"There is another unescaped dollar sign ",(0,i.kt)("inlineCode",{parentName:"li"},"$")," to the left of that slash character")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Remove all query parameters")),(0,i.kt)("p",null,"Specify naked ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," to remove all query parameters:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$removeparam")," \u2014 removes all query parameters from URLs matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Inversion")),(0,i.kt)("p",null,"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"~")," to apply inversion:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam=~param")," \u2014 removes all query parameters with the name different from ",(0,i.kt)("inlineCode",{parentName:"li"},"param"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam=~/regexp/")," \u2014 removes all query parameters that do not match the ",(0,i.kt)("inlineCode",{parentName:"li"},"regexp")," regular expression.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Negating ",(0,i.kt)("inlineCode",{parentName:"strong"},"$removeparam"))),(0,i.kt)("p",null,"This sort of rules work pretty much the same way it works with ",(0,i.kt)("a",{parentName:"p",href:"#csp-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$csp"))," and ",(0,i.kt)("a",{parentName:"p",href:"#redirect-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$redirect"))," modifiers."),(0,i.kt)("p",null,"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," to negate ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$removeparam")," negates all ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam")," rules for URLs that match ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$removeparam=param")," negates the rule with ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam=param")," for any request matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$removeparam=/regexp/")," negates the rule with ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam=/regexp/")," for any request matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple rules matching a single request")),(0,i.kt)("p",null,"In the case when multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," rules match a single request, each of them will be applied one by one."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"$removeparam=/^(utm_source|utm_medium|utm_term)=/\n$removeparam=/^(utm_content|utm_campaign|utm_referrer)=/\n@@||example.com^$removeparam\n")),(0,i.kt)("p",null,"With these rules some ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/UTM_parameters"},"UTM parameters")," will be stripped out from any request, except that requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," will not be stripped at all, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"http://google.com/page?utm_source=s&utm_referrer=fb.com&utm_content=img")," will be transformed to ",(0,i.kt)("inlineCode",{parentName:"p"},"http://google.com/page"),", but ",(0,i.kt)("inlineCode",{parentName:"p"},"http://example.com/page?utm_source=s&utm_referrer=fb.com&utm_content=img")," will not be affected by the blocking rule."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam=utm_source")," removes ",(0,i.kt)("inlineCode",{parentName:"p"},"utm_source")," query parameter from all requests.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam=/utm_.*/")," removes all ",(0,i.kt)("inlineCode",{parentName:"p"},"utm_* query")," parameters from URL queries of any request, e.g. a request to ",(0,i.kt)("inlineCode",{parentName:"p"},"http://example.com/page?utm_source=test")," will be transformed to ",(0,i.kt)("inlineCode",{parentName:"p"},"http://example.com/page"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam=/^utm_source=campaign$/")," removes ",(0,i.kt)("inlineCode",{parentName:"p"},"utm_source")," query parameter with the value equal to ",(0,i.kt)("inlineCode",{parentName:"p"},"campaign"),". It does not touch other ",(0,i.kt)("inlineCode",{parentName:"p"},"utm_source")," parameters."))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Negating one ",(0,i.kt)("inlineCode",{parentName:"strong"},"$removeparam")," rule and replacing it with a different rule")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"$removeparam=/^(gclid|yclid|fbclid)=/\n@@||example.com^$removeparam=/^(gclid|yclid|fbclid)=/\n||example.com^$removeparam=/^(yclid|fbclid)=/\n")),(0,i.kt)("p",null,"With these rules, Google, Yandex, and Facebook Click IDs will be removed from all requests. There is one exception: Google Click ID (gclid) will not be removed from requests to example.com."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Negating ",(0,i.kt)("inlineCode",{parentName:"strong"},"$removeparam")," for all parameters")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"$removeparam=/^(utm_source|utm_medium|utm_term)=/\n$removeparam=/^(utm_content|utm_campaign|utm_referrer)=/\n@@||example.com^$removeparam\n")),(0,i.kt)("p",null,"With these rules, specified UTM parameters will be removed from any request save for requests to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org"),"."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam")," rules can also be disabled by ",(0,i.kt)("inlineCode",{parentName:"p"},"$document")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception rules. But basic exception rules without modifiers do not do that. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^")," will not disable ",(0,i.kt)("inlineCode",{parentName:"p"},"$removeparam=p")," for requests to ",(0,i.kt)("strong",{parentName:"p"},"example.com"),", but ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^$urlblock")," will."),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam")," modifier can be used ",(0,i.kt)("a",{parentName:"li",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"only in trusted filters")),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam")," rules are compatible with ",(0,i.kt)("a",{parentName:"li",href:"#basic-rules-basic-modifiers"},"basic modifiers"),", ",(0,i.kt)("a",{parentName:"li",href:"#content-type-modifiers"},"content-type modifiers"),", and with ",(0,i.kt)("inlineCode",{parentName:"li"},"$important")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"$app")," modifiers. Rules with any other modifiers are considered invalid and will be discarded."))),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam")," modifier are supported by AdGuard for Windows, Mac, and Android and AdGuard Browser Extension for Chrome, Firefox, and Edge."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam")," syntax for regular expressions is supported by AdGuard Browser Extension v4.0 and AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.8 or later."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"POST")," request types are supported only by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.10 or later, and AdGuard Browser Extension with ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tswebextension#tswebextension"},"TSWebExtension")," v0.4.6 or later."))),(0,i.kt)("h4",{id:"replace-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$replace"))),(0,i.kt)("p",null,"This modifier completely changes the rule behavior. If it is applied, the rule will not block the request. The response is going to be modified instead."),(0,i.kt)("p",null,"You will need some knowledge of regular expressions to use ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," modifier."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Features")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules apply to any text response, but will not apply to binary (",(0,i.kt)("inlineCode",{parentName:"li"},"media"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"image"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"object"),", etc.)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules do not apply if the size of the original response is more than 10 MB."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules have a higher priority than other basic rules (",(0,i.kt)("strong",{parentName:"li"},"including")," exception rules). So if a request corresponds to two different rules one of which has the ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," modifier, this rule will be applied."),(0,i.kt)("li",{parentName:"ul"},"Document-level exception rules with ",(0,i.kt)("inlineCode",{parentName:"li"},"$content")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"$document")," modifiers do disable ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules for requests matching them."),(0,i.kt)("li",{parentName:"ul"},"Other document-level exception rules (",(0,i.kt)("inlineCode",{parentName:"li"},"$generichide"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"$elemhide")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"$jsinject")," modifiers) are applied alongside ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules. It means that you can modify the page content with a ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rule and disable cosmetic rules there at the same time.")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," value can be empty in the case of exception rules. See examples section for further information."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple rules matching a single request")),(0,i.kt)("p",null,"In case if multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," rules match a single request, we will apply each of them. ",(0,i.kt)("strong",{parentName:"p"},"The order is defined alphabetically.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,"In general, ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," syntax is similar to replacement with regular expressions ",(0,i.kt)("a",{parentName:"p",href:"http://perldoc.perl.org/perlrequick.html#Search-and-replace"},"in Perl"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'replace = "/" regexp "/" replacement "/" modifiers\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"regexp"))," \u2014 a regular expression."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"replacement"))," \u2014 a string that will be used to replace the string corresponding to ",(0,i.kt)("inlineCode",{parentName:"li"},"regexp"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"modifiers"))," \u2014 a regular expression flags. For example, ",(0,i.kt)("inlineCode",{parentName:"li"},"i")," \u2014 insensitive search, or ",(0,i.kt)("inlineCode",{parentName:"li"},"s")," \u2014 single-line mode.")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," value, two characters must be escaped: comma ",(0,i.kt)("inlineCode",{parentName:"p"},",")," and dollar sign ",(0,i.kt)("inlineCode",{parentName:"p"},"$"),". Use backslash ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," for it. For example, an escaped comma looks like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"\\,"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$replace=/(<VAST[\\s\\S]*?>)[\\s\\S]*<\\/VAST>/\\$1<\\/VAST>/i\n")),(0,i.kt)("p",null,"There are three parts in this rule:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"regexp")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"(<VAST(.|\\s)*?>)(.|\\s)*<\\/VAST>"),";"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"replacement")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"\\$1<\\/VAST>")," where ",(0,i.kt)("inlineCode",{parentName:"li"},"$")," is escaped;"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"modifiers")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"i")," for insensitive search.")),(0,i.kt)("p",null,"You can see how this rule works here: ",(0,i.kt)("a",{parentName:"p",href:"http://regexr.com/3cesk"},"http://regexr.com/3cesk")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple ",(0,i.kt)("inlineCode",{parentName:"strong"},"$replace")," rules")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$replace=/X/Y/")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$replace=/Z/Y/")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org/page/*$replace=/Z/Y/"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Both rule 1 and 2 will be applied to all requests sent to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},"Rule 2 is disabled for requests matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org/page/"),", ",(0,i.kt)("strong",{parentName:"li"},"but rule 1 still works!"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Disabling ",(0,i.kt)("inlineCode",{parentName:"strong"},"$replace")," rules")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$replace")," will disable all ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$document")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$content")," will disable all ",(0,i.kt)("inlineCode",{parentName:"li"},"$replace")," rules ",(0,i.kt)("strong",{parentName:"li"},"originated from")," pages of ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," ",(0,i.kt)("strong",{parentName:"li"},"including the page itself"),".")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," modifier can be used ",(0,i.kt)("a",{parentName:"p",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"only in trusted filters")),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," modifier are supported by AdGuard for Windows, Mac, and Android and AdGuard Browser Extension for Firefox. Such rules do not work in extensions for other browsers because they are unable to modify content on the network level.")),(0,i.kt)("h4",{id:"urltransform-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"urltransform"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," rules allow you to modify the request URL by replacing the text matched by the regular expression."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Features")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$urltransform")," rules apply to any request URL text."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$urltransform")," rules can also ",(0,i.kt)("strong",{parentName:"li"},"modify the query part")," of the URL."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$urltransform")," will not be applied if the original URL is blocked by other rules."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"$urltransform")," will be applied before ",(0,i.kt)("inlineCode",{parentName:"li"},"$removeparam")," rules.")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," value can be empty for exception rules."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple rules matching a single request")),(0,i.kt)("p",null,"If multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," rules match a single request, we will apply each of them. ",(0,i.kt)("strong",{parentName:"p"},"The order is defined alphabetically.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," syntax is similar to replacement with regular expressions ",(0,i.kt)("a",{parentName:"p",href:"http://perldoc.perl.org/perlrequick.html#Search-and-replace"},"in Perl"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'urltransform = "/" regexp "/" replacement "/" modifiers\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"regexp"))," \u2014 a regular expression."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"replacement"))," \u2014 a string that will be used to replace the string corresponding to ",(0,i.kt)("inlineCode",{parentName:"li"},"regexp"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"modifiers"))," \u2014 a regular expression flags. For example, ",(0,i.kt)("inlineCode",{parentName:"li"},"i")," \u2014 insensitive search, or ",(0,i.kt)("inlineCode",{parentName:"li"},"s")," \u2014 single-line mode.")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," value, two characters must be escaped: the comma ",(0,i.kt)("inlineCode",{parentName:"p"},",")," and the dollar sign ",(0,i.kt)("inlineCode",{parentName:"p"},"$"),". Use the backslash character ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," for this. For example, an escaped comma looks like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"\\,"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.org^$urltransform=/(pref\\/).*\\/(suf)/\\$1\\$2/i\n")),(0,i.kt)("p",null,"There are three parts in this rule:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"regexp")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"(pref\\/).*\\/(suf)"),";"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"replacement")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"\\$1\\$2")," where ",(0,i.kt)("inlineCode",{parentName:"li"},"$")," is escaped;"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"modifiers")," \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"i")," for insensitive search.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Multiple ",(0,i.kt)("inlineCode",{parentName:"strong"},"$urltransform")," rules")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$urltransform=/X/Y/")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$urltransform=/Z/Y/")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org/page/*$urltransform=/Z/Y/"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Both rule 1 and 2 will be applied to all requests sent to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org"),"."),(0,i.kt)("li",{parentName:"ul"},"Rule 2 is disabled for requests matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org/page/"),", ",(0,i.kt)("strong",{parentName:"li"},"but rule 1 still works!"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Re-matching rules after transforming the URL")),(0,i.kt)("p",null,"If the ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," rule is applied to a request, all the rules will be re-evaluated against the new URL."),(0,i.kt)("p",null,"E.g., with the following rules:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.com^$urltransform=/firstpath/secondpath/\n||example.com/secondpath^\n")),(0,i.kt)("p",null,"the request to ",(0,i.kt)("inlineCode",{parentName:"p"},"https://example.com/firstpath")," will be blocked before it is sent."),(0,i.kt)("p",null,"However, ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," rules will ",(0,i.kt)("strong",{parentName:"p"},"not be re-applied")," in this case to avoid infinite recursion, e.g., with the following rules:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.com/firstpath^$urltransform=/firstpath/secondpath/\n||example.com/secondpath^$urltransform=/secondpath/firstpath/\n")),(0,i.kt)("p",null,"the request to ",(0,i.kt)("inlineCode",{parentName:"p"},"https://example.com/fisrtpath")," will be transformed to ",(0,i.kt)("inlineCode",{parentName:"p"},"https://example.com/secondpath")," and the second rule will not be applied."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Disabling ",(0,i.kt)("inlineCode",{parentName:"strong"},"$urltransform")," rules")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$urltransform")," will disable all ",(0,i.kt)("inlineCode",{parentName:"li"},"$urltransform")," rules matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@@||example.org^$urltransform=/Z/Y/")," will disable the rule with ",(0,i.kt)("inlineCode",{parentName:"li"},"$urltransform=/Z/Y/")," for any request matching ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^"),".")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," rules can also be disabled by ",(0,i.kt)("inlineCode",{parentName:"p"},"$document")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$urlblock")," exception rules. But basic exception rules without modifiers do not do that. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^")," will not disable ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform=/X/Y/")," for requests to ",(0,i.kt)("strong",{parentName:"p"},"example.com"),", but ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^$urlblock")," will."),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," modifier can be used ",(0,i.kt)("a",{parentName:"p",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"only in trusted filters")),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$urltransform")," modifier are supported by AdGuard for Windows, AdGuard for Mac, and AdGuard for Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.15 or later.")),(0,i.kt)("h4",{id:"noop-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"noop"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"noop")," modifier does nothing and can be used solely to increase rules' readability. It consists of a sequence of underscore characters (",(0,i.kt)("inlineCode",{parentName:"p"},"_"),") of any length and can appear in a rule as many times as needed."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"||example.com$_,removeparam=/^ss\\\\$/,_,image\n||example.com$replace=/bad/good/,___,~third-party\n")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"noop")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h4",{id:"empty-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$empty")," (deprecated)")),(0,i.kt)("admonition",{title:"Deprecation notice",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This modifier is deprecated in favor of the ",(0,i.kt)("a",{parentName:"p",href:"#redirect-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$redirect")," modifier"),". Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$empty")," are still supported and being converted into ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect=nooptext")," now but the support shall be removed in the future.")),(0,i.kt)("p",null,"Usually, blocked requests look like a server error to browser. If you use ",(0,i.kt)("inlineCode",{parentName:"p"},"$empty")," modifier, AdGuard will emulate a blank response from the server with",(0,i.kt)("inlineCode",{parentName:"p"},"200 OK")," status."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.org^$empty")," returns an empty response to all requests to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and all subdomains.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$empty")," modifier are not supported by AdGuard Content Blocker, AdGuard for iOS, and AdGuard for Safari.")),(0,i.kt)("h4",{id:"mp4-modifier"},(0,i.kt)("strong",{parentName:"h4"},(0,i.kt)("inlineCode",{parentName:"strong"},"$mp4")," (deprecated)")),(0,i.kt)("admonition",{title:"Deprecation notice",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This modifier is deprecated in favor of the ",(0,i.kt)("a",{parentName:"p",href:"#redirect-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$redirect")," modifier"),". Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$mp4")," are still supported and being converted into ",(0,i.kt)("inlineCode",{parentName:"p"},"$redirect=noopmp4-1s,media")," now but the support shall be removed in the future.")),(0,i.kt)("p",null,"As a response to blocked request AdGuard returns a short video placeholder."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"||example.com/videos/$mp4")," blocks all video downloads from ",(0,i.kt)("inlineCode",{parentName:"li"},"||example.com/videos/*")," and changes the response to a video placeholder.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$mp4")," modifier are not supported by AdGuard Content Blocker, AdGuard for iOS, and AdGuard for Safari.")),(0,i.kt)("h3",{id:"rule-priorities"},"Rule priorities"),(0,i.kt)("p",null,"Each rule has its own priority, which is necessary when several rules match the request and the filtering engine needs to select one of them. Priority is measured by a positive integer."),(0,i.kt)("admonition",{title:"Collisions",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When two rules with the same priority match the same request, it depends on the filtering engine implementation which one will be selected.")),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"The concept of rule priorities becomes increasingly important in light of Manifest V3 as the existing rules need to be converted to declarativeNetRequest rules."),(0,i.kt)("p",null,":::"),(0,i.kt)("h4",{id:"priority-calculation"},"Priority calculation"),(0,i.kt)("p",null,"To calculate priority, we've categorized modifiers into different groups. These groups are ranked based on their priority, from lowest to highest. A modifier that significantly narrows the scope of a rule adds more weight to its total priority. Conversely, if a rule applies to a broader range of requests, its priority decreases."),(0,i.kt)("p",null,"It's worth noting that there are cases where a single-parameter modifier has a higher priority than multi-parameter ones. For instance, in the case of ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain=example.com|example.org"),", a rule that includes two domains has a slightly broader effective area than a rule with one specified domain, therefore its priority is lower."),(0,i.kt)("p",null,"The base priority of any rule is 1. If the calculated priority is a floating-point number, it will be ",(0,i.kt)("strong",{parentName:"p"},"rounded up")," to the smallest integer greater than or equal to the calculated priority."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"The concept of priority has been introduced in ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/tsurlfilter/tree/master/packages/tsurlfilter#tsurlfilter"},"TSUrlFilter")," v2.1.0 and ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.13. Before that AdGuard didn't have any special priority computation algorithm and collisions handling could be different depending on AdGuard product and version."),(0,i.kt)("li",{parentName:"ul"},"AdGuard for iOS, Safari, and AdGuard Content Blocker rely on the browsers implementation and they cannot follow the rules specified here."))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Modifier aliases (",(0,i.kt)("inlineCode",{parentName:"p"},"1p"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"3p"),", etc.) are not included in these categories, however, they are utilized within the engine to compute the rule priority.")),(0,i.kt)("h4",{id:"priority-category-1"},"Basic modifiers, the presence of each adds 1 to the priority"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#app-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$app"))," with negated applications using ",(0,i.kt)("inlineCode",{parentName:"li"},"~"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#denyallow-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$denyallow")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#domain-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$domain"))," with negated domains using ",(0,i.kt)("inlineCode",{parentName:"li"},"~"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#match-case-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$match-case")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#method-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$method"))," with negated methods using ",(0,i.kt)("inlineCode",{parentName:"li"},"~"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#third-party-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$third-party")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#to-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$to")),","),(0,i.kt)("li",{parentName:"ul"},"restricted ",(0,i.kt)("a",{parentName:"li",href:"#content-type-modifiers"},"content-types")," with ",(0,i.kt)("inlineCode",{parentName:"li"},"~"),".")),(0,i.kt)("p",null,"When dealing with a negated domain, app, method, or content-type, we add ",(0,i.kt)("strong",{parentName:"p"},"1 point")," for the existence of the modifier itself, regardless of the quantity of negated domains or content-types. This is because the rule's scope is already infinitely broad. Put simply, by prohibiting multiple domains, content-types, methods or apps, the scope of the rule becomes only minimally smaller."),(0,i.kt)("h4",{id:"priority-category-2"},"Defined content-type modifiers, defined methods, defined headers, $all, $popup, specific exceptions"),(0,i.kt)("p",null,"All allowed content types:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#document-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$document")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#font-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$font")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#image-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$image")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#media-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$media")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#object-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$object")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#other-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$other")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#ping-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$ping")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#script-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$script")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#stylesheet-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$stylesheet")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#subdocument-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$subdocument")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#websocket-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$websocket")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#xmlhttprequest-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$xmlhttprequest")),";")),(0,i.kt)("p",null,"This also includes rules that implicitly add all content types:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#all-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$all")),";")),(0,i.kt)("p",null,"Or rules that implicitly add the modifier ",(0,i.kt)("inlineCode",{parentName:"p"},"$document"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#popup-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$popup")),";")),(0,i.kt)("p",null,"Or some specific exceptions that implicitly add ",(0,i.kt)("inlineCode",{parentName:"p"},"$document,subdocument"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#content-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$content")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#elemhide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$elemhide")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extension-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$extension")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#genericblock-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$genericblock")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#generichide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$generichide")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#jsinject-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$jsinject")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#specifichide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$specifichide")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#urlblock-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$urlblock")),";")),(0,i.kt)("p",null,"Or allowed methods via ",(0,i.kt)("a",{parentName:"p",href:"#method-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$method")),"."),(0,i.kt)("p",null,"Or rules with ",(0,i.kt)("a",{parentName:"p",href:"#header-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$header")),"."),(0,i.kt)("p",null,"The presence of any content-type modifiers adds ",(0,i.kt)("inlineCode",{parentName:"p"},"(50 + 50 / N)"),", where ",(0,i.kt)("inlineCode",{parentName:"p"},"N")," is the number of modifiers present, for example: ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$image,script")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"50 + 50 / 2 = 50 + 25 = 75")," to the total weight of the rule."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$all")," also belongs to this category, because it implicitly adds all content type modifiers, e.g., ",(0,i.kt)("inlineCode",{parentName:"p"},"$document,subdocument,image,script,media,<etc>")," + ",(0,i.kt)("inlineCode",{parentName:"p"},"$popup"),"."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"$popup")," also belongs to this category, because it implicitly adds the modifier ",(0,i.kt)("inlineCode",{parentName:"p"},"$document"),". Similarly, specific exceptions add ",(0,i.kt)("inlineCode",{parentName:"p"},"$document,subdocument"),"."),(0,i.kt)("p",null,"If there is a ",(0,i.kt)("inlineCode",{parentName:"p"},"$method")," modifier in the rule with allowed methods it adds ",(0,i.kt)("inlineCode",{parentName:"p"},"(50 + 50 / N)"),", where ",(0,i.kt)("inlineCode",{parentName:"p"},"N")," is the number of methods allowed, for example: ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$method=GET|POST|PUT")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"50 + 50 / 3 = 50 + 16.6 = 67")," to the total weight of the rule."),(0,i.kt)("p",null,"If there is a ",(0,i.kt)("inlineCode",{parentName:"p"},"$header")," modifier in the rule it adds ",(0,i.kt)("inlineCode",{parentName:"p"},"50"),"."),(0,i.kt)("h4",{id:"priority-category-3"},(0,i.kt)("inlineCode",{parentName:"h4"},"$domain")," or ",(0,i.kt)("inlineCode",{parentName:"h4"},"$app")," with allowed domains or applications"),(0,i.kt)("p",null,"Specified domains through ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," or specified applications through ",(0,i.kt)("inlineCode",{parentName:"p"},"$app")," add ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100 / N"),", where ",(0,i.kt)("inlineCode",{parentName:"p"},"N")," is the number of modifier values for example: ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$domain=example.com|example.org|example.net")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100 / 3 = 134.3 = 135")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$app=org.example.app1|org.example.app2")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100 / 2 = 151")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$domain=example.com,app=org.example.app1|org.example.app2")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100/1")," ($domain part) and ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100/2")," ($app part), totaling ",(0,i.kt)("inlineCode",{parentName:"p"},"350"),"."),(0,i.kt)("p",null,"Modifier values that are regexps or tld will be interpreted as normal entries of the form ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," and counted one by one, for example: ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$domain=example.*")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100 / 1 = 200")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$domain=example.*|adguard.*")," will add ",(0,i.kt)("inlineCode",{parentName:"p"},"100 + 100 / 2 = 150"),"."),(0,i.kt)("h4",{id:"priority-category-6"},(0,i.kt)("inlineCode",{parentName:"h4"},"$redirect")," rules"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#redirect-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$redirect")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#redirect-rule-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$redirect-rule")),".")),(0,i.kt)("p",null,"Each of which adds ",(0,i.kt)("inlineCode",{parentName:"p"},"10^3")," to rule priority."),(0,i.kt)("h4",{id:"priority-category-4"},"Specific exceptions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#content-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$content")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#elemhide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$elemhide")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extension-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$extension")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#genericblock-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$genericblock")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#generichide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$generichide")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#jsinject-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$jsinject")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#specifichide-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$specifichide")),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#urlblock-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$urlblock")),";")),(0,i.kt)("p",null,"Each of which adds ",(0,i.kt)("inlineCode",{parentName:"p"},"10^4")," to the priority."),(0,i.kt)("p",null,"As well as exception with ",(0,i.kt)("a",{parentName:"p",href:"#document-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$document modifier")),": because it's an alias for ",(0,i.kt)("inlineCode",{parentName:"p"},"$elemhide,content,jsinject,urlblock,extension"),". It will add ",(0,i.kt)("inlineCode",{parentName:"p"},"10^4")," for each modifier from ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-4"},"the top list"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"10^4 * 5")," in total."),(0,i.kt)("p",null,"In addition, each of these exceptions implicitly adds the two allowed content-type modifiers ",(0,i.kt)("inlineCode",{parentName:"p"},"$document,subdocument"),"."),(0,i.kt)("h4",{id:"priority-category-5"},"Allowlist rules"),(0,i.kt)("p",null,"Modifier ",(0,i.kt)("inlineCode",{parentName:"p"},"@@")," adds ",(0,i.kt)("inlineCode",{parentName:"p"},"10^5")," to rule priority."),(0,i.kt)("h4",{id:"priority-category-7"},(0,i.kt)("inlineCode",{parentName:"h4"},"$important")," rules"),(0,i.kt)("p",null,"Modifier ",(0,i.kt)("a",{parentName:"p",href:"#important-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$important"))," adds ",(0,i.kt)("inlineCode",{parentName:"p"},"10^6")," to rule priority."),(0,i.kt)("h4",{id:"priority-category-extra"},"Rules for which there is no priority weight"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"#advanced-capabilities"},"Other modifiers"),", which are supposed to perform additional post- or pre-processing of requests, do not add anything to the rules priority."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("a",{parentName:"p",href:"#replace-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$replace"))," modifier takes precedence over all blocking rules of categories 1-3, as well as exception rules from categories 3-5, ",(0,i.kt)("strong",{parentName:"p"},"except")," ",(0,i.kt)("a",{parentName:"p",href:"#content-modifier"},(0,i.kt)("inlineCode",{parentName:"a"},"$content")),", because an exception with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$content")," modifier overrides all ",(0,i.kt)("inlineCode",{parentName:"p"},"$replace")," rules.")),(0,i.kt)("h4",{id:"examples-1"},"Examples"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^")),(0,i.kt)("p",{parentName:"li"},"Weight of the rule without modifiers: ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$match-case")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + weight of the modifier from ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-1"},"category 1"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + 1 = 2"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$removeparam=p")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + 0, since $removeparam ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-extra"},"is not involved")," in the priority calculation: ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + 0 = 1"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.org^$document,redirect=nooptext")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + allowed content type, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-3"},"category 3")," + $redirect from ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-6"},"category 6"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + (100 + 100 / 1) + 1000 = 1201"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.org^$removeparam=p,document")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + allowlist rule, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-5"},"category 5")," + 0 because $removeparam ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-extra"},"is not involved")," in the priority calculation + allowed content type, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-2"},"category 2"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + 10000 + 0 + (50 + 50 / 1) = 10101"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com/ad/*$domain=example.org|example.net,important")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + allowlist rule, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-5"},"category 5")," + important rule, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-7"},"category 7")," + allowed domains, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-3"},"category 3"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + 10000 + 1000000 + (100 + 100 / 2) = 1010152"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.org^$document")," without additional modifiers is an alias for ",(0,i.kt)("inlineCode",{parentName:"p"},"@@||example.com^$elemhide,content,jsinject,urlblock,extension")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + specific exceptions, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-4"},"category 4")," + two allowed content types (document and subdocument), ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-2"},"category 2"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + 10000 * 4 + (50 + 50 / 2) = 40076"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"*$script,domain=a.com,denyallow=x.com|y.com")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + allowed content type, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-2"},"category 2")," + allowed domain, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-3"},"category 3")," + denyallow, ",(0,i.kt)("a",{parentName:"p",href:"#priority-category-1"},"category 1"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + (50 + 50/1) + (100 + 100 / 1) + 1 = 303"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$all")," \u2014 alias to ",(0,i.kt)("inlineCode",{parentName:"p"},"||example.com^$document,subdocument,image,script,media,etc. + $popup")),(0,i.kt)("p",{parentName:"li"},"Rule weight: base weight + popup (",(0,i.kt)("a",{parentName:"p",href:"#priority-category-1"},"category 1"),") + allowed content types (",(0,i.kt)("a",{parentName:"p",href:"#priority-category-2"},"category 2"),"): ",(0,i.kt)("inlineCode",{parentName:"p"},"1 + 1 + (50 + 50/12) = 55"),"."))),(0,i.kt)("h2",{id:"non-basic-rules"},"Non-basic rules"),(0,i.kt)("p",null,"However, basic rules may not be enough to block ads. Sometimes you need to hide an element or change part of the HTML code of a web page without breaking anything. The rules described in this section are created specifically for this purpose."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Categories \\ Products"),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for Windows, Mac, Android"},"CoreLibs apps")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Chrome and other Chromium-based browsers"},"AdGuard for Chromium")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Firefox"},"AdGuard for Firefox")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for iOS and AdGuard Pro for iOS"},"iOS\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"Safari\uc6a9 AdGuard"},"Safari\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Content Blocker for Samsung Internet and Yandex Browser on Android"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#cosmetic-elemhide-rules"},"Element hiding")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#cosmetic-css-rules"},"CSS rules")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#extended-css-selectors"},"Extended CSS")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#html-filtering-rules"},"HTML filtering")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#javascript-rules"},"JavaScript")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#scriptlets"},"Scriptlets")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"))),(0,i.kt)("h2",{id:"cosmetic-rules"},"Cosmetic rules"),(0,i.kt)("p",null,":::\uc815\ubcf4"),(0,i.kt)("p",null,"Work with non-basic rules requires the basic knowledge of HTML and CSS. So, if you want to learn how to make such rules, we recommend to get acquainted with ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_started/What_is_CSS"},"this documentation"),"."),(0,i.kt)("p",null,":::"),(0,i.kt)("h3",{id:"cosmetic-elemhide-rules"},"Element hiding rules"),(0,i.kt)("p",null,"Element hiding rules are used to hide the elements of web pages. It is similar to applying ",(0,i.kt)("inlineCode",{parentName:"p"},"{ display: none; }")," style to selected element."),(0,i.kt)("p",null,"Element hiding rules may operate differently ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-rules-priority"},"depending on the platform"),"."),(0,i.kt)("h4",{id:"syntax"},"Syntax"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'   rule = [domains] "##" selector\ndomains = [domain0, domain1[, ...[, domainN]]]\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"selector"))," \u2014 ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_Started/Selectors"},"CSS selector"),", defines the elements to be hidden."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"domains"))," \u2014 domain restriction for the rule.")),(0,i.kt)("p",null,"If you want to limit the rule application area to certain domains, just enter them separated with commas. For example: ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org,example.com##selector"),"."),(0,i.kt)("p",null,"This rule will be also applied to all subdomains of ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),"."),(0,i.kt)("p",null,"If you want the rule not to be applied to certain domains, start a domain name with ",(0,i.kt)("inlineCode",{parentName:"p"},"~")," sign. For example: ",(0,i.kt)("inlineCode",{parentName:"p"},"~example.org##selector"),"."),(0,i.kt)("p",null,"You can use both approaches in a single rule. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org,~subdomain.example.org##domain")," will work for ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," and all subdomains, ",(0,i.kt)("strong",{parentName:"p"},"except ",(0,i.kt)("inlineCode",{parentName:"strong"},"subdomain.example.org")),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Element hiding rules are not dependent on each other. If there is a rule ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org##selector")," in the filter and you add ",(0,i.kt)("inlineCode",{parentName:"p"},"~example.org##selector")," both rules will be applied independently.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"example.com##div.textad")," \u2014 hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"example.com,example.org###adblock")," \u2014 hides an element with attribute ",(0,i.kt)("inlineCode",{parentName:"li"},"id")," equals ",(0,i.kt)("inlineCode",{parentName:"li"},"adblock")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and all subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"~example.com##.textad")," \u2014 hides an element with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at all domains, except ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and its subdomains.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\uc81c\ud55c")),(0,i.kt)("p",null,"Safari does not support both permitted and restricted domains. So the rules like ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org,~foo.example.org##.textad")," are invalid in AdGuard for Safari."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Exceptions")),(0,i.kt)("p",null,"Exceptions can disable some rules on particular domains. They are very similar to usual exception rules, but instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"##")," you have to use ",(0,i.kt)("inlineCode",{parentName:"p"},"#@#"),"."),(0,i.kt)("p",null,"For example, there is a rule in filter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"##.textad\n")),(0,i.kt)("p",null,"If you want to disable it for ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),", you can create an exception rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"example.com#@#.textad\n")),(0,i.kt)("p",null,"Sometimes, it may be necessary to disable all restriction rules. For example, to conduct tests. To do this, use the exclusion rule without specifying a domain. It will completely disable matching CSS elemhide rule on ALL domains:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"#@#.textad\n")),(0,i.kt)("p",null,"The same can be achieved by adding this rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"*#@#.textad\n")),(0,i.kt)("p",null,"We recommend to use this kind of exceptions only if it is not possible to change the hiding rule itself. In other cases it is better to change the original rule, using domain restrictions."),(0,i.kt)("h3",{id:"cosmetic-css-rules"},"CSS rules"),(0,i.kt)("p",null,"Sometimes, simple hiding of an element is not enough to deal with advertising. For example, blocking an advertising element can just break the page layout. In this case AdGuard can use rules that are much more flexible than hiding rules. With these rules you can basically add any CSS styles to the page."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'   rule = [domains] "#$#" selector "{" style "}"\ndomains = [domain0, domain1[, ...[, domainN]]]\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"selector"))," \u2014 ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Getting_Started/Selectors"},"CSS selector"),", that defines the elements we want to apply the style to."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"domains"))," \u2014 domain restriction for the rule. Same principles as in ",(0,i.kt)("a",{parentName:"li",href:"#cosmetic-elemhide-rules"},"element hiding rules"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"style"))," \u2014 CSS style, that we want to apply to selected elements.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"example.com#$#body { background-color: #333!important; }\n")),(0,i.kt)("p",null,"This rule will apply a style ",(0,i.kt)("inlineCode",{parentName:"p"},"background-color: #333!important;")," to the ",(0,i.kt)("inlineCode",{parentName:"p"},"body")," element at ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com")," and all subdomains."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Exceptions")),(0,i.kt)("p",null,"Just like with element hiding, there is a type of rules that disable the selected CSS style rule for particular domains. Exception rule syntax is almost the same, you just have to change ",(0,i.kt)("inlineCode",{parentName:"p"},"#$#")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"#@$#"),"."),(0,i.kt)("p",null,"For example, there is a rule in filter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"#$#.textad { visibility: hidden; }\n")),(0,i.kt)("p",null,"If you want to disable it for ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),", you can create an exception rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"example.com#@$#.textad { visibility: hidden; }\n")),(0,i.kt)("p",null,"We recommend to use this kind of exceptions only if it is not possible to change the CSS rule itself. In other cases it is better to change the original rule, using domain restrictions."),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Styles that lead to loading any resource are forbidden. Basically, it means that you cannot use any ",(0,i.kt)("inlineCode",{parentName:"p"},"<url>")," type of value in the style.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"CSS rules are not supported by AdGuard Content Blocker."),(0,i.kt)("p",{parentName:"admonition"},"CSS rules may operate differently ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-rules-priority"},"depending on the platform"),".")),(0,i.kt)("h3",{id:"extended-css-selectors"},"Extended CSS selectors"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-limitations"},"\uc81c\ud55c")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-has"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":has()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-contains"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":contains()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-matches-css"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":matches-css()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-matches-attr"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":matches-attr()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-property"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":matches-property()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-xpath"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":xpath()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-nth-ancestor"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":nth-ancestor()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-upward"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":upward()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#remove-pseudos"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":remove()")," and pseudo-property ",(0,i.kt)("inlineCode",{parentName:"a"},"remove"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-is"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":is()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-not"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":not()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#extended-css-if-not"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"a"},":if-not()")," (removed)"))),(0,i.kt)("p",null,"CSS 3.0 is not always enough to block ads. To solve this problem AdGuard extends CSS capabilities by adding support for the new pseudo-elements. We have developed a separate ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/ExtendedCss"},"open-source library")," for non-standard element selecting and applying CSS styles with extended properties."),(0,i.kt)("p",null,"The idea of extended capabilities is an opportunity to match DOM elements with selectors based on their own representation (style, text content, etc.) or relations with other elements. There is also an opportunity to apply styles with non-standard CSS properties."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Application area")),(0,i.kt)("p",null,"Extended selectors can be used in any cosmetic rule, whether they are ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-elemhide-rules"},"element hiding rules")," or ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-css-rules"},"CSS rules"),"."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with extended CSS selectors are not supported by AdGuard Content Blocker.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("p",null,"Regardless of the CSS pseudo-classes you are using in the rule, you can use special markers to force applying these rules by ExtendedCss. It is recommended to use these markers for all extended CSS cosmetic rules so that it was easier to find them."),(0,i.kt)("p",null,"The syntax for extended CSS rules:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"#?#")," \u2014 for element hiding, ",(0,i.kt)("inlineCode",{parentName:"li"},"#@?#")," \u2014 for exceptions"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"#$?#")," \u2014 for CSS rules, ",(0,i.kt)("inlineCode",{parentName:"li"},"#@$?#")," \u2014 for exceptions")),(0,i.kt)("p",null,"We ",(0,i.kt)("strong",{parentName:"p"},"strongly recommend")," using these markers any time when you use an extended CSS selector."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'example.org#?#div:has(> a[target="_blank"][rel="nofollow"])')," \u2014 this rule blocks all ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," elements containing a child node that has a link with the attributes ",(0,i.kt)("inlineCode",{parentName:"li"},'[target="_blank"][rel="nofollow"]'),". The rule applies only to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"example.com#$?#h3:contains(cookies) { display: none!important; }")," \u2014 this rule sets the style ",(0,i.kt)("inlineCode",{parentName:"li"},"display: none!important")," to all ",(0,i.kt)("inlineCode",{parentName:"li"},"h3")," elements that contain the word ",(0,i.kt)("inlineCode",{parentName:"li"},"cookies"),". The rule applies only to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"example.net#?#.banner:matches-css(width: 360px)")," \u2014 this rule blocks all ",(0,i.kt)("inlineCode",{parentName:"li"},".banner")," elements with the style property ",(0,i.kt)("inlineCode",{parentName:"li"},"width: 360px"),". The rule applies only to ",(0,i.kt)("inlineCode",{parentName:"li"},"example.net")," and its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"example.net#@?#.banner:matches-css(width: 360px)")," \u2014 this rule will disable the previous rule.")),(0,i.kt)("p",null,"You can apply standard CSS selectors using the ExtendedCss library by using the rule marker ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#"),", e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#div.banner"),"."),(0,i.kt)("p",null,"Learn more about ",(0,i.kt)("a",{parentName:"p",href:"#selectors-debugging-mode"},"how to debug extended selectors"),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Some pseudo-classes do not require selector before it. Still adding the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#the-universal-selector"},"universal selector")," ",(0,i.kt)("inlineCode",{parentName:"p"},"*")," makes an extended selector easier to read, even though it has no effect on the matching behavior. So selector ",(0,i.kt)("inlineCode",{parentName:"p"},"#block :has(> .inner)")," works exactly like ",(0,i.kt)("inlineCode",{parentName:"p"},"#block *:has(> .inner)")," but second one is more obvious."),(0,i.kt)("p",{parentName:"admonition"},"Pseudo-class names are case-insensitive, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},":HAS()")," works as ",(0,i.kt)("inlineCode",{parentName:"p"},":has()"),". Still the lower-case names are used commonly.")),(0,i.kt)("h4",{id:"extended-css-limitations"},"ExtendedCss Limitations"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"CSS ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/Comments"},"comments")," and ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/At-rule"},"at-rules")," are not supported.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Specific pseudo-class may have its own limitations: ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-has-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":has()")),", ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-xpath-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":xpath()")),", ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-nth-ancestor-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":nth-ancestor()")),", ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-upward-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":upward()")),", ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-is-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":is()")),", ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-not-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":not()")),", and ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-remove-limitations"},(0,i.kt)("inlineCode",{parentName:"a"},":remove()")),"."))),(0,i.kt)("h4",{id:"extended-css-has"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":has()")),(0,i.kt)("p",null,"Draft CSS 4.0 specification describes the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#relational"},(0,i.kt)("inlineCode",{parentName:"a"},":has()")," pseudo-class"),". Unfortunately, ",(0,i.kt)("a",{parentName:"p",href:"https://caniuse.com/css-has"},"it is not yet supported")," by all popular browsers."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," pseudo-class must use the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/:has"},"native implementation of ",(0,i.kt)("inlineCode",{parentName:"a"},":has()"))," if they use ",(0,i.kt)("inlineCode",{parentName:"p"},"##")," marker and if it is possible, i.e. with no other extended selectors inside. To force applying of ExtendedCss rules with ",(0,i.kt)("inlineCode",{parentName:"p"},":has()"),", use ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"#$?#")," marker explicitly.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Compatibility with other pseudo-classes")),(0,i.kt)("p",null,"Synonyms ",(0,i.kt)("inlineCode",{parentName:"p"},":-abp-has()")," is supported by ExtendedCss for better compatibility."),(0,i.kt)("admonition",{title:"Removal notice",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},":if()")," is no longer supported as a synonym for ",(0,i.kt)("inlineCode",{parentName:"p"},":has()"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"[target]:has(selector)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"selector")," \u2014 required, standard or extended CSS selector")),(0,i.kt)("p",null,"The pseudo-class ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," selects the ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," elements that fit to the ",(0,i.kt)("inlineCode",{parentName:"p"},"selector"),". Also the ",(0,i.kt)("inlineCode",{parentName:"p"},"selector")," can start with a combinator."),(0,i.kt)("p",null,"A selector list can be set in ",(0,i.kt)("inlineCode",{parentName:"p"},"selector")," as well. In this case ",(0,i.kt)("strong",{parentName:"p"},"all")," selectors in the list are being matched for now. In the future it will be fixed for ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#typedef-forgiving-relative-selector-list"},(0,i.kt)("inlineCode",{parentName:"a"},"<forgiving-relative-selector-list>"))," as argument."),(0,i.kt)("h5",{id:"extended-css-has-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":has()")," limitations"),(0,i.kt)("p",null,"Usage of the ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," pseudo-class is ",(0,i.kt)("a",{parentName:"p",href:"https://bugs.chromium.org/p/chromium/issues/detail?id=669058#c54"},"restricted for some cases (2, 3)"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"disallow ",(0,i.kt)("inlineCode",{parentName:"li"},":has()")," inside the pseudos accepting only compound selectors;"),(0,i.kt)("li",{parentName:"ul"},"disallow ",(0,i.kt)("inlineCode",{parentName:"li"},":has()")," after regular pseudo-elements.")),(0,i.kt)("p",null,"Native ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," pseudo-class does not allow ",(0,i.kt)("inlineCode",{parentName:"p"},":has()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},":is()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},":where()")," inside ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," argument to avoid increasing the ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," invalidation complexity (",(0,i.kt)("a",{parentName:"p",href:"https://bugs.chromium.org/p/chromium/issues/detail?id=669058#c54"},"case 1"),"). But ExtendedCss did not have such limitation earlier and filter lists already contain such rules, so we have not added this limitation to ExtendedCss and allow to use ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," inside ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," as it was possible before. To use it, just force ExtendedCss usage by setting ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"#$?#")," rule marker."),(0,i.kt)("p",null,"Native implementation does not allow any usage of ",(0,i.kt)("inlineCode",{parentName:"p"},":scope")," inside the ",(0,i.kt)("inlineCode",{parentName:"p"},":has()")," argument (",(0,i.kt)("a",{parentName:"p",href:"https://github.com/w3c/csswg-drafts/issues/7211"},"[1]"),", ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/w3c/csswg-drafts/issues/6399"},"[2]"),"). Still, there are some such rules in filter lists: ",(0,i.kt)("inlineCode",{parentName:"p"},"div:has(:scope a)")," which we continue to support by simply converting them to ",(0,i.kt)("inlineCode",{parentName:"p"},"div:has(> a)"),", as it used to be done previously."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"div:has(.banner)")," selects all ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements which ",(0,i.kt)("strong",{parentName:"p"},"include")," an element with the ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," class:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>Not selected</div>\n<div>Selected\n  <span class="banner">inner element</span>\n</div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"div:has(> .banner)")," selects all ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements which ",(0,i.kt)("strong",{parentName:"p"},"include")," an ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," class element as a ",(0,i.kt)("em",{parentName:"p"},"direct child")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"div"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>Not selected</div>\n<div>Selected\n  <p class="banner">child element</p>\n</div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"div:has(+ .banner)")," selects all ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements ",(0,i.kt)("strong",{parentName:"p"},"preceding")," ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," class element which ",(0,i.kt)("em",{parentName:"p"},"immediately follows")," the ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," and both are children of the same parent:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>Not selected</div>\n<div>Selected</div>\n<p class="banner">adjacent sibling</p>\n<span>Not selected</span>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"div:has(~ .banner)")," selects all ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements ",(0,i.kt)("strong",{parentName:"p"},"preceding")," ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," class element which ",(0,i.kt)("em",{parentName:"p"},"follows")," the ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," but ",(0,i.kt)("em",{parentName:"p"},"not necessarily immediately")," and both are children of the same parent:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>Not selected</div>\n<div>Selected</div>\n<span>Not selected</span>\n<p class="banner">general sibling</p>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"div:has(span, .banner)")," selects all ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements which ",(0,i.kt)("strong",{parentName:"p"},"include both")," ",(0,i.kt)("inlineCode",{parentName:"p"},"span")," element and ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," class element:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>Not selected</div>\n<div>Selected\n  <span>child span</span>\n  <p class="banner">child .banner</p>\n</div>\n')),(0,i.kt)("admonition",{title:"Old syntax",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/ExtendedCss#old-syntax-has"},"Backward compatible syntax for ",(0,i.kt)("inlineCode",{parentName:"a"},":has()"))," is supported but ",(0,i.kt)("strong",{parentName:"p"},"not recommended"),".")),(0,i.kt)("h4",{id:"extended-css-contains"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":contains()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class principle is very simple: it allows to select the elements that contain specified text or which content matches a specified regular expression. Regexp flags are supported."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class uses the ",(0,i.kt)("inlineCode",{parentName:"p"},"textContent")," element property for matching, not the ",(0,i.kt)("inlineCode",{parentName:"p"},"innerHTML"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Compatibility with other pseudo-classes")),(0,i.kt)("p",null,"Synonyms ",(0,i.kt)("inlineCode",{parentName:"p"},":-abp-contains()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},":has-text()")," are supported for better compatibility."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"[target]:contains(match)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"match")," \u2014 required, string or regular expression for matching element ",(0,i.kt)("inlineCode",{parentName:"li"},"textContent"),". Regular expression flags are supported.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"For such DOM:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>Not selected</div>\n<div id="match">Selected as IT contains "banner"</div>\n<div>Not selected <div class="banner"></div></div>\n')),(0,i.kt)("p",null,"the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#match")," can be selected by any of these extended selectors:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! plain text\ndiv:contains(banner)\n\n! regular expression\ndiv:contains(/as .* banner/)\n\n! regular expression with flags\ndiv:contains(/it .* banner/gi)\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Only the ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," with ",(0,i.kt)("inlineCode",{parentName:"p"},"id=match")," is selected because the next element does not contain any text, and ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," is a part of code, not a text.")),(0,i.kt)("admonition",{title:"Old syntax",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/ExtendedCss#old-syntax-contains"},"Backward compatible syntax for ",(0,i.kt)("inlineCode",{parentName:"a"},":contains()"))," is supported but ",(0,i.kt)("strong",{parentName:"p"},"not recommended"),".")),(0,i.kt)("h4",{id:"extended-css-matches-css"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":matches-css()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":matches-css()")," pseudo-class allows to match the element by its current style properties. The work of the pseudo-class is based on using the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle"},(0,i.kt)("inlineCode",{parentName:"a"},"Window.getComputedStyle()"))," method."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"[target]:matches-css([pseudo-element, ] property: pattern)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pseudo-element")," \u2014 optional, valid standard pseudo-element, e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"before"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"after"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"first-line"),", etc."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"property")," \u2014 required, a name of CSS property to check the element for"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pattern")," \u2014 required, a value pattern that is using the same simple wildcard matching as in the basic url filtering rules OR a regular expression. For this type of matching, AdGuard always does matching in a case-insensitive manner. In the case of a regular expression, the pattern looks like ",(0,i.kt)("inlineCode",{parentName:"li"},"/regexp/"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Special characters escaping and unescaping")),(0,i.kt)("p",null,"For ",(0,i.kt)("strong",{parentName:"p"},"non-regexp")," patterns ",(0,i.kt)("inlineCode",{parentName:"p"},"("),",",(0,i.kt)("inlineCode",{parentName:"p"},")"),",",(0,i.kt)("inlineCode",{parentName:"p"},"["),",",(0,i.kt)("inlineCode",{parentName:"p"},"]")," must be ",(0,i.kt)("strong",{parentName:"p"},"unescaped"),", e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},":matches-css(background-image:url(data:*))"),"."),(0,i.kt)("p",null,"For ",(0,i.kt)("strong",{parentName:"p"},"regexp")," patterns ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," should be ",(0,i.kt)("strong",{parentName:"p"},"escaped"),", e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},':matches-css(background-image: /^url\\\\("data:image\\\\/gif;base64.+/)'),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"For such DOM:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<style type="text/css">\n    #matched::before {\n        content: "Block me"\n    }\n</style>\n<div id="matched"></div>\n<div id="not-matched"></div>\n')),(0,i.kt)("p",null,"the ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements with pseudo-element ",(0,i.kt)("inlineCode",{parentName:"p"},"::before")," and with specified ",(0,i.kt)("inlineCode",{parentName:"p"},"content")," property can be selected by any of these extended selectors:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! string pattern\ndiv:matches-css(before, content: block me)\n\n! string pattern with wildcard\ndiv:matches-css(before, content: block*)\n\n! regular expression pattern\ndiv:matches-css(before, content: /block me/)\n")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Regexp patterns ",(0,i.kt)("strong",{parentName:"p"},"do not support")," flags.")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Obsolete pseudo-classes ",(0,i.kt)("inlineCode",{parentName:"p"},":matches-css-before()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},":matches-css-after()")," are no longer recommended but still are supported for better compatibility.")),(0,i.kt)("admonition",{title:"Old syntax",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/ExtendedCss#old-syntax-matches-css"},"Backward compatible syntax for ",(0,i.kt)("inlineCode",{parentName:"a"},":matches-css()"))," is supported but ",(0,i.kt)("strong",{parentName:"p"},"not recommended"),".")),(0,i.kt)("h4",{id:"extended-css-matches-attr"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":matches-attr()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":matches-attr()")," pseudo-class allows selecting an element by its attributes, especially if they are randomized."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'[target]:matches-attr("name"[="value"])\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name")," \u2014 required, simple string ",(0,i.kt)("em",{parentName:"li"},"or")," string with wildcard ",(0,i.kt)("em",{parentName:"li"},"or")," regular expression for attribute name matching"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"value")," \u2014 optional, simple string ",(0,i.kt)("em",{parentName:"li"},"or")," string with wildcard ",(0,i.kt)("em",{parentName:"li"},"or")," regular expression for attribute value matching")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Escaping special characters")),(0,i.kt)("p",null,"For ",(0,i.kt)("strong",{parentName:"p"},"regexp")," patterns ",(0,i.kt)("inlineCode",{parentName:"p"},'"')," and ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," should be ",(0,i.kt)("strong",{parentName:"p"},"escaped"),", e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"div:matches-attr(class=/[\\\\w]{5}/)"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'div:matches-attr("ad-link")')," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target1" ad-link="1random23-banner_240x400"></div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'div:matches-attr("data-*"="adBanner")')," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target2"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target2" data-1random23="adBanner"></div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"div:matches-attr(*unit*=/^click$/)")," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target3"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target3" random123-unit094="click"></div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'*:matches-attr("/.{5,}delay$/"="/^[0-9]*$/")')," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"#target4"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div>\n  <inner-random23 id="target4" nt4f5be90delay="1000"></inner-random23>\n</div>\n')),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Regexp patterns ",(0,i.kt)("strong",{parentName:"p"},"do not support")," flags.")),(0,i.kt)("h4",{id:"extended-css-property"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":matches-property()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":matches-property()")," pseudo-class allows selecting an element by matching its properties."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'[target]:matches-property("name"[="value"])\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name")," \u2014 required, simple string ",(0,i.kt)("em",{parentName:"li"},"or")," string with wildcard ",(0,i.kt)("em",{parentName:"li"},"or")," regular expression for element property name matching"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"value")," \u2014 optional, simple string ",(0,i.kt)("em",{parentName:"li"},"or")," string with wildcard ",(0,i.kt)("em",{parentName:"li"},"or")," regular expression for element property value matching")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Escaping special characters")),(0,i.kt)("p",null,"For ",(0,i.kt)("strong",{parentName:"p"},"regexp")," patterns ",(0,i.kt)("inlineCode",{parentName:"p"},'"')," and ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," must be escaped, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"div:matches-property(prop=/[\\\\w]{4}/)"),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Regexp patterns are supported in ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," for any property in chain, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"prop./^unit[\\\\d]{4}$/.type"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"An element with such properties:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"divProperties = {\n  id: 1,\n  check: {\n    track: true,\n    unit_2random1: true,\n  },\n  memoizedProps: {\n    key: null,\n    tag: 12,\n    _owner: {\n      effectTag: 1,\n      src: 'ad.com',\n    },\n  },\n};\n")),(0,i.kt)("p",null,"can be selected by any of these extended selectors:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'div:matches-property(check.track)\n\ndiv:matches-property("check./^unit_.{4,8}$/")\n\ndiv:matches-property("check.unit_*"=true)\n\ndiv:matches-property(memoizedProps.key="null")\n\ndiv:matches-property(memoizedProps._owner.src=/ad/)\n')),(0,i.kt)("admonition",{title:"For filters maintainers",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"To check properties of a specific element, do the following:"),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},"Inspect the page element or select it in ",(0,i.kt)("inlineCode",{parentName:"li"},"Elements")," tab of browser DevTools"),(0,i.kt)("li",{parentName:"ol"},"Run ",(0,i.kt)("inlineCode",{parentName:"li"},"console.dir($0)")," in ",(0,i.kt)("inlineCode",{parentName:"li"},"Console")," tab"))),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Regexp patterns ",(0,i.kt)("strong",{parentName:"p"},"do not support")," flags.")),(0,i.kt)("h4",{id:"extended-css-xpath"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":xpath()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":xpath()")," pseudo-class allows selecting an element by evaluating an XPath expression."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"[target]:xpath(expression)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target"),"- optional, standard or extended CSS selector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"expression")," \u2014 required, valid XPath expression")),(0,i.kt)("h5",{id:"extended-css-xpath-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":xpath()")," limitations"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"target"),' can be omitted so it is optional. For any other pseudo-class that would mean "apply to ',(0,i.kt)("em",{parentName:"p"},"all"),' DOM nodes", but in case of ',(0,i.kt)("inlineCode",{parentName:"p"},":xpath()"),' it just means "apply to the ',(0,i.kt)("em",{parentName:"p"},"whole")," document\", and such applying slows elements selecting significantly. That's why rules like ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#:xpath(expression)")," are limited to looking inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"body")," tag. For example, rule ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#:xpath(//div[@data-st-area=\\'Advert\\'])")," is parsed as ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#body:xpath(//div[@data-st-area=\\'Advert\\'])"),"."),(0,i.kt)("p",null,"Extended selectors with defined ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," as ",(0,i.kt)("em",{parentName:"p"},"any")," selector \u2014 ",(0,i.kt)("inlineCode",{parentName:"p"},"*:xpath(expression)")," \u2014 can still be used but it is not recommended, so ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," should be specified instead."),(0,i.kt)("p",null,"Works properly only at the end of selector, except for ",(0,i.kt)("a",{parentName:"p",href:"#remove-pseudos"},"pseudo-class :remove()"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},':xpath(//*[@class="banner"])')," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target1" class="banner"></div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},':xpath(//*[@class="inner"]/..)')," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target2"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target2">\n  <div class="inner"></div>\n</div>\n')),(0,i.kt)("h4",{id:"extended-css-nth-ancestor"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":nth-ancestor()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":nth-ancestor()")," pseudo-class allows to lookup the ",(0,i.kt)("em",{parentName:"p"},"nth")," ancestor relative to the previously selected element."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"subject:nth-ancestor(n)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"subject")," \u2014 required, standard or extended CSS selector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"n")," \u2014 required, number >= 1 and < 256, distance to the needed ancestor from the element selected by ",(0,i.kt)("inlineCode",{parentName:"li"},"subject"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"subject:nth-ancestor(n)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"subject")," \u2014 required, standard or extended CSS selector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"n")," \u2014 required, number >= 1 and < 256, distance to the needed ancestor from the element selected by ",(0,i.kt)("inlineCode",{parentName:"li"},"subject"))),(0,i.kt)("h5",{id:"extended-css-nth-ancestor-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":nth-ancestor()")," limitations"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":nth-ancestor()")," pseudo-class is not supported inside the argument of the ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-not"},(0,i.kt)("inlineCode",{parentName:"a"},":not()")," pseudo-class"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"For such DOM:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target1">\n  <div class="child"></div>\n\n  <div id="target2">\n    <div>\n      <div>\n        <div class="inner"></div>\n      </div>\n    </div>\n  </div>\n</div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},".child:nth-ancestor(1)")," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),", ",(0,i.kt)("inlineCode",{parentName:"p"},'div[class="inner"]:nth-ancestor(3)')," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target2"),"."),(0,i.kt)("h4",{id:"extended-css-upward"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":upward()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":upward()")," pseudo-class allows to lookup the ancestor relative to the previously selected element."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"subject:upward(ancestor)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"subject")," \u2014 required, standard or extended CSS selector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ancestor")," \u2014 required, specification for the ancestor of the element selected by ",(0,i.kt)("inlineCode",{parentName:"li"},"subject"),", can be set as:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"number")," >= 1 and < 256 for\xa0distance to the needed ancestor, same as ",(0,i.kt)("a",{parentName:"li",href:"#extended-css-nth-ancestor"},(0,i.kt)("inlineCode",{parentName:"a"},":nth-ancestor()"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("em",{parentName:"li"},"standard CSS selector")," for matching closest ancestor")))),(0,i.kt)("h5",{id:"extended-css-upward-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":upward()")," limitations"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":upward()")," pseudo-class is not supported inside the argument of the ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-not"},(0,i.kt)("inlineCode",{parentName:"a"},":not()")," pseudo-class"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"For such DOM:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="target1" data="true">\n  <div class="child"></div>\n\n  <div id="target2">\n    <div>\n      <div>\n        <div class="inner"></div>\n      </div>\n    </div>\n  </div>\n</div>\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},".inner:upward(div[data])")," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),", ",(0,i.kt)("inlineCode",{parentName:"p"},".inner:upward(div[id])")," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target2"),", ",(0,i.kt)("inlineCode",{parentName:"p"},".child:upward(1)")," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),", ",(0,i.kt)("inlineCode",{parentName:"p"},".inner:upward(3)")," selects the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target2"),"."),(0,i.kt)("h4",{id:"remove-pseudos"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":remove()")," and pseudo-property ",(0,i.kt)("inlineCode",{parentName:"h4"},"remove")),(0,i.kt)("p",null,"Sometimes, it is necessary to remove a matching element instead of hiding it or applying custom styles. In order to do it, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},":remove()")," pseudo-class as well as the ",(0,i.kt)("inlineCode",{parentName:"p"},"remove")," pseudo-property."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"strong"},":remove()")," can be placed only at the end of a selector.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"! pseudo-class\nselector:remove()\n\n! pseudo-property\nselector { remove: true; }\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"selector")," \u2014 required, standard or extended CSS selector")),(0,i.kt)("h5",{id:"extended-css-remove-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":remove()")," and ",(0,i.kt)("inlineCode",{parentName:"h5"},"remove")," limitations"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":remove()")," pseudo-class is limited to work properly only at the end of selector."),(0,i.kt)("p",null,"For applying the ",(0,i.kt)("inlineCode",{parentName:"p"},":remove()")," pseudo-class to any element, the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#the-universal-selector"},"universal selector")," ",(0,i.kt)("inlineCode",{parentName:"p"},"*")," should be used. Otherwise such extended selector may be considered as invalid, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},".banner > :remove()")," is not valid for removing any child element of ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," class element, so it should look like ",(0,i.kt)("inlineCode",{parentName:"p"},".banner > *:remove()"),"."),(0,i.kt)("p",null,"If the ",(0,i.kt)("inlineCode",{parentName:"p"},":remove()")," pseudo-class or the ",(0,i.kt)("inlineCode",{parentName:"p"},"remove")," pseudo-property is used, all style properties are ignored except for the ",(0,i.kt)("a",{parentName:"p",href:"#selectors-debug-mode"},(0,i.kt)("inlineCode",{parentName:"a"},"debug")," pseudo-property"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"div.banner:remove()\ndiv:has(> div[ad-attr]):remove()\n\ndiv:contains(advertisement) { remove: true; }\ndiv[class]:has(> a > img) { remove: true; }\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"remove")," pseudo-property must use ",(0,i.kt)("inlineCode",{parentName:"p"},"#$?#")," marker: ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," for CSS-style rule syntax, ",(0,i.kt)("inlineCode",{parentName:"p"},"?")," for ExtendedCss syntax.")),(0,i.kt)("h4",{id:"extended-css-is"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":is()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":is()")," pseudo-class allows to match any element that can be selected by any of selectors passed to it. Invalid selectors are skipped and the pseudo-class deals with valid ones with no error thrown. Our implementation of the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/:is"},"native ",(0,i.kt)("inlineCode",{parentName:"a"},":is()")," pseudo-class"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"[target]:is(selectors)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"selectors")," \u2014 ",(0,i.kt)("a",{parentName:"li",href:"https://drafts.csswg.org/selectors-4/#typedef-forgiving-selector-list"},(0,i.kt)("em",{parentName:"a"},"forgiving selector list"))," of standard or extended selectors. For extended selectors, only compound selectors are supported, not complex.")),(0,i.kt)("h5",{id:"extended-css-is-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":is()")," limitations"),(0,i.kt)("p",null,"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},":is()")," pseudo-class must use the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/:is"},"native implementation of ",(0,i.kt)("inlineCode",{parentName:"a"},":is()"))," if rules use ",(0,i.kt)("inlineCode",{parentName:"p"},"##")," marker and it is possible, i.e. with no other extended selectors inside. To force applying ExtendedCss rules with ",(0,i.kt)("inlineCode",{parentName:"p"},":is()"),", use ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"#$?#")," marker explicitly."),(0,i.kt)("p",null,"If the ",(0,i.kt)("inlineCode",{parentName:"p"},":is()")," pseudo-class argument ",(0,i.kt)("inlineCode",{parentName:"p"},"selectors")," is an extended selector, due to the way how the ",(0,i.kt)("inlineCode",{parentName:"p"},":is()")," pseudo-class is implemented in ExtendedCss v2.0, it is impossible to apply it to the top DOM node which is ",(0,i.kt)("inlineCode",{parentName:"p"},"html"),", i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#html:is(<extended-selectors>)")," does not work. So if ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," is not defined or defined as the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#the-universal-selector"},"universal selector")," ",(0,i.kt)("inlineCode",{parentName:"p"},"*"),", the extended pseudo-class applying is limited to ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"html"),"'s children"),", e.g. rules ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#:is(...)")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#*:is(...)")," are parsed as ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#html *:is(...)"),". Please note that there is no such limitation for a standard selector argument, i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#html:is(.locked)")," works fine."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#complex"},"Complex selectors")," with extended pseudo-classes are not supported as ",(0,i.kt)("inlineCode",{parentName:"p"},"selectors")," argument for ",(0,i.kt)("inlineCode",{parentName:"p"},":is()")," pseudo-class, only ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#compound"},"compound ones")," are allowed. Check examples below for more details."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"#container *:is(.inner, .footer)")," selects only the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="container">\n  <div data="true">\n    <div>\n      <div id="target1" class="inner"></div>\n    </div>\n  </div>\n</div>\n')),(0,i.kt)("p",null,"Due to limitations ",(0,i.kt)("inlineCode",{parentName:"p"},":is(*:not([class]) > .banner)'")," does not work but ",(0,i.kt)("inlineCode",{parentName:"p"},":is(*:not([class]):has(> .banner))")," can be used instead of it to select the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target2"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<span class="span">text</span>\n<div id="target2">\n  <p class="banner">inner paragraph</p>\n</div>\n')),(0,i.kt)("h4",{id:"extended-css-not"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":not()")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":not()")," pseudo-class allows to select elements which are ",(0,i.kt)("em",{parentName:"p"},"not matched")," by selectors passed as argument. Invalid argument selectors are not allowed and error is to be thrown. Our implementation of the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/:not"},(0,i.kt)("inlineCode",{parentName:"a"},":not()")," pseudo-class"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"[target]:not(selectors)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"target")," \u2014 optional, standard or extended CSS selector, can be skipped for checking ",(0,i.kt)("em",{parentName:"li"},"any")," element"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"selectors")," \u2014 list of standard or extended selectors")),(0,i.kt)("h5",{id:"extended-css-not-limitations"},(0,i.kt)("inlineCode",{parentName:"h5"},":not()")," limitations"),(0,i.kt)("p",null,"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},":not()")," pseudo-class must use the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/:not"},"native implementation of ",(0,i.kt)("inlineCode",{parentName:"a"},":not()"))," if rules use ",(0,i.kt)("inlineCode",{parentName:"p"},"##")," marker and it is possible, i.e. with no other extended selectors inside. To force applying ExtendedCss rules with ",(0,i.kt)("inlineCode",{parentName:"p"},":not()"),", use ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"#$?#")," marker explicitly."),(0,i.kt)("p",null,"If the ",(0,i.kt)("inlineCode",{parentName:"p"},":not()")," pseudo-class argument ",(0,i.kt)("inlineCode",{parentName:"p"},"selectors")," is an extended selector, due to the way how the ",(0,i.kt)("inlineCode",{parentName:"p"},":not()")," pseudo-class is implemented in ExtendedCss v2.0, it is impossible to apply it to the top DOM node which is ",(0,i.kt)("inlineCode",{parentName:"p"},"html"),", i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#html:not(<extended-selectors>)")," does not work. So if ",(0,i.kt)("inlineCode",{parentName:"p"},"target")," is not defined or defined as the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/selectors-4/#the-universal-selector"},"universal selector")," ",(0,i.kt)("inlineCode",{parentName:"p"},"*"),", the extended pseudo-class applying is limited to ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"html"),"'s children"),", e.g. rules ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#:not(...)")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#*:not(...)")," are parsed as ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#html *:not(...)"),". Please note that there is no such limitation for a standard selector argument, i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"#?#html:not(.locked)")," works fine."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":not()")," is considered as a standard CSS pseudo-class inside the argument of the ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-upward"},(0,i.kt)("inlineCode",{parentName:"a"},":upward()")," pseudo-class")," because ",(0,i.kt)("inlineCode",{parentName:"p"},":upward()")," supports only standard selectors."),(0,i.kt)("p",null,'"Up-looking" pseudo-classes which are ',(0,i.kt)("a",{parentName:"p",href:"#extended-css-nth-ancestor"},(0,i.kt)("inlineCode",{parentName:"a"},":nth-ancestor()"))," and ",(0,i.kt)("a",{parentName:"p",href:"#extended-css-upward"},(0,i.kt)("inlineCode",{parentName:"a"},":upward()"))," are not supported inside ",(0,i.kt)("inlineCode",{parentName:"p"},"selectors")," argument for ",(0,i.kt)("inlineCode",{parentName:"p"},":not()")," pseudo-class."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"#container > *:not(h2, .text)")," selects only the element ",(0,i.kt)("inlineCode",{parentName:"p"},"div#target1"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- HTML code --\x3e\n<div id="container">\n  <h2>Header</h2>\n  <div id="target1"></div>\n  <span class="text">text</span>\n</div>\n')),(0,i.kt)("h4",{id:"extended-css-if-not"},"Pseudo-class ",(0,i.kt)("inlineCode",{parentName:"h4"},":if-not()")," (removed)"),(0,i.kt)("admonition",{title:"Removal notice",type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},":if-not()")," pseudo-class is removed and is no longer supported. Rules with it are considered as invalid.")),(0,i.kt)("p",null,"This pseudo-class was basically a shortcut for ",(0,i.kt)("inlineCode",{parentName:"p"},":not(:has())"),". It was supported by ExtendedCss for better compatibility with some filters subscriptions."),(0,i.kt)("h3",{id:"cosmetic-rules-priority"},"Cosmetic rules priority"),(0,i.kt)("p",null,"The way ",(0,i.kt)("strong",{parentName:"p"},"element hiding")," and ",(0,i.kt)("strong",{parentName:"p"},"CSS rules")," are applied is platform-specific."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"In AdGuard for Windows, Mac, and Android"),", we use a stylesheet injected into the page. The priority of cosmetic rules is the same as any other websites' CSS stylesheet. But there is a limitation: ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-elemhide-rules"},"element hiding")," and ",(0,i.kt)("a",{parentName:"p",href:"#cosmetic-css-rules"},"CSS rules")," cannot override inline styles. In such cases, it is recommended to use extended selectors or HTML filtering."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"In AdGuard Browser Extension"),', the so called "user stylesheets" are used. They have higher priority than even the inline styles.'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Extended CSS selectors")," use JavaScript to work and basically add an inline style themselves, therefore they can override any style."),(0,i.kt)("h2",{id:"html-filtering-rules"},"HTML filtering rules"),(0,i.kt)("p",null,"In most cases, the basis and cosmetic rules are enough to filter ads. But sometimes it is necessary to change the HTML-code of the page itself before it is loaded. This is when you need filtering rules for HTML content. They allow to indicate the HTML elements to be cut out before the browser loads the page."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"HTML filtering rules are supported by AdGuard for Windows, Mac, Android, and AdGuard Browser Extension for Firefox. Such rules do not work in extensions for other browsers because they are unable to modify content on network level.")),(0,i.kt)("h3",{id:"syntax-1"},"Syntax"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'     selector = [tagName] [attributes] [pseudoClasses]\n   combinator = ">"\n         rule = [domains] "$$" selector *(combinator selector)\n      domains = [domain0, domain1[, ...[, domainN]]]\n   attributes = "[" name0 = value0 "]" "[" name1 = value2 "]" ... "[" nameN = valueN "]"\npseudoClasses = pseudoClass *pseudoClass\n  pseudoClass = ":" pseudoName [ "(" pseudoArgs ")" ]\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"tagName"))," \u2014 name of the element in lower case, for example, ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"script"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"domains"))," \u2014 domain restriction for the rule. Same principles as in ",(0,i.kt)("a",{parentName:"li",href:"#cosmetic-elemhide-rules"},"element hiding rule syntax"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"attributes"))," \u2014 a list of attributes that limit the selection of elements. ",(0,i.kt)("inlineCode",{parentName:"li"},"name")," \u2014 attribute name, ",(0,i.kt)("inlineCode",{parentName:"li"},"value")," \u2014 substring, that is contained in attribute value."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"pseudoName"))," \u2014 the name of a pseudo-class."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"pseudoArgs"))," \u2014 the arguments of a function-style pseudo-class."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"combinator"))," \u2014 an operator that works similarly to the ",(0,i.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/CSS/Child_combinator"},"CSS child combinator"),": that is, the ",(0,i.kt)("inlineCode",{parentName:"li"},"selector")," on the right of the ",(0,i.kt)("inlineCode",{parentName:"li"},"combinator")," will only match an element whose direct parent matches the ",(0,i.kt)("inlineCode",{parentName:"li"},"selector")," on the left of the ",(0,i.kt)("inlineCode",{parentName:"li"},"combinator"),".")),(0,i.kt)("h3",{id:"examples-2"},"Examples"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"HTML code:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script data-src="/banner.js"><\/script>\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Rule:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'example.org$$script[data-src="banner"]\n')),(0,i.kt)("p",null,"This rule removes all ",(0,i.kt)("inlineCode",{parentName:"p"},"script")," elements with the attribute ",(0,i.kt)("inlineCode",{parentName:"p"},"data-src")," containing the substring ",(0,i.kt)("inlineCode",{parentName:"p"},"banner"),". The rule applies only to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," and all its subdomains."),(0,i.kt)("h3",{id:"special-attributes"},"Special attributes"),(0,i.kt)("p",null,"In addition to usual attributes, which value is every element checked for, there is a set of special attributes that change the way a rule works. Below there is a list of these attributes:"),(0,i.kt)("h4",{id:"tag-content"},(0,i.kt)("inlineCode",{parentName:"h4"},"tag-content")),(0,i.kt)("admonition",{title:"Deprecation notice",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This special attribute may become unsupported in the future. Prefer using the ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class where it is available.")),(0,i.kt)("p",null,"This is the most frequently used special attribute. It limits selection with those elements whose innerHTML code contains the specified substring."),(0,i.kt)("p",null,"You must use ",(0,i.kt)("inlineCode",{parentName:"p"},'""')," to escape ",(0,i.kt)("inlineCode",{parentName:"p"},'"'),", for instance: ",(0,i.kt)("inlineCode",{parentName:"p"},'$$script[tag-content="alert(""this is ad"")"]')),(0,i.kt)("p",null,"For example, take a look at this HTML code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script type="text/javascript">\n    document.write(\'<div>banner text</div>" />\');\n<\/script>\n')),(0,i.kt)("p",null,"Following rule will delete all ",(0,i.kt)("inlineCode",{parentName:"p"},"script")," elements with a ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," substring in their code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$$script[tag-content="banner"]\n')),(0,i.kt)("admonition",{title:"Limitations",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"tag-content")," special attribute must not appear in a selector to the left of a ",(0,i.kt)("inlineCode",{parentName:"p"},">")," combinator.")),(0,i.kt)("h4",{id:"wildcard"},(0,i.kt)("inlineCode",{parentName:"h4"},"wildcard")),(0,i.kt)("admonition",{title:"Deprecation notice",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This special attribute may become unsupported in the future. Prefer using the ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class where it is available.")),(0,i.kt)("p",null,"This special attribute works almost like ",(0,i.kt)("inlineCode",{parentName:"p"},"tag-content")," and allows you to check the innerHTML code of the document. Rule will check if HTML code of the element fits to the ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Glob_(programming)"},"search pattern"),"."),(0,i.kt)("p",null,"You must use ",(0,i.kt)("inlineCode",{parentName:"p"},'""')," to escape ",(0,i.kt)("inlineCode",{parentName:"p"},'"'),", for instance: ",(0,i.kt)("inlineCode",{parentName:"p"},'$$script[wildcard=""banner""]')),(0,i.kt)("p",null,"For example: ",(0,i.kt)("inlineCode",{parentName:"p"},'$$script[wildcard="*banner*text*"]')),(0,i.kt)("p",null,"It checks if the element code contains the two consecutive substrings ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"text"),"."),(0,i.kt)("admonition",{title:"Limitations",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"wildcard")," special attribute must not appear in a selector to the left of a ",(0,i.kt)("inlineCode",{parentName:"p"},">")," combinator.")),(0,i.kt)("h4",{id:"max-length"},(0,i.kt)("inlineCode",{parentName:"h4"},"max-length")),(0,i.kt)("admonition",{title:"Deprecation notice",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This special attribute may become unsupported in the future. Prefer using the ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class with a regular expression where it is available.")),(0,i.kt)("p",null,"Specifies the maximum length for content of HTML element. If this parameter is set and the content length exceeds the value, a rule does not apply to the element."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Default value")),(0,i.kt)("p",null,"If this parameter is not specified, the ",(0,i.kt)("inlineCode",{parentName:"p"},"max-length")," is considered to be 8192."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$$div[tag-content="banner"][max-length="400"]\n')),(0,i.kt)("p",null,"This rule will remove all the ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements, whose code contains the substring ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," and the length of which does not exceed ",(0,i.kt)("inlineCode",{parentName:"p"},"400")," characters."),(0,i.kt)("admonition",{title:"Limitations",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"max-length")," special attribute must not appear in a selector to the left of a ",(0,i.kt)("inlineCode",{parentName:"p"},">")," combinator.")),(0,i.kt)("h4",{id:"min-length"},(0,i.kt)("inlineCode",{parentName:"h4"},"min-length")),(0,i.kt)("admonition",{title:"Deprecation notice",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"This special attribute may become unsupported in the future. Prefer using the ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class with a regular expression where it is available.")),(0,i.kt)("p",null,"Specifies the minimum length for content of HTML element. If this parameter is set and the content length is less than preset value, a rule does not apply to the element."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$$div[tag-content="banner"][min-length="400"]\n')),(0,i.kt)("p",null,"This rule will remove all the ",(0,i.kt)("inlineCode",{parentName:"p"},"div")," elements, whose code contains the substring ",(0,i.kt)("inlineCode",{parentName:"p"},"banner")," and the length of which exceeds ",(0,i.kt)("inlineCode",{parentName:"p"},"400")," characters."),(0,i.kt)("admonition",{title:"Limitations",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"min-length")," special attribute must not appear in a selector to the left of a ",(0,i.kt)("inlineCode",{parentName:"p"},">")," combinator.")),(0,i.kt)("h3",{id:"pseudo-classes"},"Pseudo-classes"),(0,i.kt)("h4",{id:"contains"},(0,i.kt)("inlineCode",{parentName:"h4"},":contains()")),(0,i.kt)("h5",{id:"syntax-2"},"Syntax"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},":contains(unquoted text)\n")),(0,i.kt)("p",null,"or"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},":contains(/reg(ular )?ex(pression)?/)\n")),(0,i.kt)("admonition",{title:"Compatibility",type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},":-abp-contains()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},":has-text()")," are synonyms for ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class is supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.13 or later.")),(0,i.kt)("p",null,"Requires that the inner HTML of the element contains the specified text or matches the specified regular expression."),(0,i.kt)("admonition",{title:"Limitations",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"A ",(0,i.kt)("inlineCode",{parentName:"p"},":contains()")," pseudo-class must not appear in a selector to the left of a ",(0,i.kt)("inlineCode",{parentName:"p"},">")," combinator.")),(0,i.kt)("h3",{id:"exceptions"},"Exceptions"),(0,i.kt)("p",null,"Similar to hiding rules, there is a special type of rules that disable the selected HTML filtering rule for particular domains. The syntax is the same, you just have to change ",(0,i.kt)("inlineCode",{parentName:"p"},"$$")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"$@$"),"."),(0,i.kt)("p",null,"For example, there is a rule in filter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$$script[tag-content="banner"]\n')),(0,i.kt)("p",null,"If you want to disable it for ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),", you can create an exception rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'example.com$@$script[tag-content="banner"]\n')),(0,i.kt)("p",null,"Sometimes, it may be necessary to disable all restriction rules. For example, to conduct tests. To do this, use the exclusion rule without specifying a domain."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'$@$script[tag-content="banner"]\n')),(0,i.kt)("p",null,"We recommend to use this kind of exceptions only if it is not possible to change the hiding rule itself. In other cases it is better to change the original rule, using domain restrictions."),(0,i.kt)("h2",{id:"javascript-rules"},"JavaScript rules"),(0,i.kt)("p",null,"AdGuard supports a special type of rules that allows you to inject any javascript code to websites pages."),(0,i.kt)("p",null,"We ",(0,i.kt)("strong",{parentName:"p"},"strongly recommend")," using ",(0,i.kt)("a",{parentName:"p",href:"#scriptlets"},"scriptlets")," instead of JavaScript rules whenever possible. JS rules are supposed to help with debugging, but as a long-time solution a scriptlet rule should be used."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'rule = [domains] "#%#" script\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"domains"))," \u2014 domain restriction for the rule. Same principles as in ",(0,i.kt)("a",{parentName:"li",href:"#cosmetic-elemhide-rules"},"element hiding rules"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"script"))," \u2014 arbitrary javascript code ",(0,i.kt)("strong",{parentName:"li"},"in one string"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"example.org#%#window.__gaq = undefined;")," executes the code ",(0,i.kt)("inlineCode",{parentName:"li"},"window.__gaq = undefined;")," on all pages at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and all subdomains.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Exceptions")),(0,i.kt)("p",null,"Similar to hiding rules, there is a special type of rules that disable the selected javascript rule for particular domains. The syntax is the same, you just have to change ",(0,i.kt)("inlineCode",{parentName:"p"},"#%#")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"#@%#"),"."),(0,i.kt)("p",null,"For example, there is a rule in filter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"#%#window.__gaq = undefined;\n")),(0,i.kt)("p",null,"If you want to disable it for ",(0,i.kt)("inlineCode",{parentName:"p"},"example.com"),", you can create an exception rule:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"example.com#@%#window.__gaq = undefined;\n")),(0,i.kt)("p",null,"Sometimes, it may be necessary to disable all restriction rules. For example, to conduct tests. To do this, use the exclusion rule without specifying a domain."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"#@%#window.__gaq = undefined;\n")),(0,i.kt)("p",null,"We recommend to use this kind of exceptions only if it is not possible to change the hiding rule itself. In other cases it is better to change the original rule, using domain restrictions."),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"JavaScript rules can be used ",(0,i.kt)("a",{parentName:"p",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"only in trusted filters")),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"JavaScript rules are not supported by AdGuard Content Blocker.")),(0,i.kt)("h2",{id:"scriptlets"},"Scriptlet rules"),(0,i.kt)("p",null,"Scriptlet is a JavaScript function that provides extended capabilities for content blocking. These functions can be used in a declarative manner in AdGuard filtering rules."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"AdGuard supports a lot of different scriptlets. In order to achieve cross-blocker compatibility, we also support syntax of uBO and ABP.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'rule = [domains] "#%#//scriptlet(" scriptletName arguments ")"\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"scriptletName"))," \u2014 required, a name of the scriptlet from AdGuard's Scriptlets library"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"arguments"))," \u2014 optional, a list of ",(0,i.kt)("inlineCode",{parentName:"li"},"string")," arguments (no other types of arguments are supported)")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},'example.org#%#//scriptlet("abort-on-property-read", "alert")\n')),(0,i.kt)("p",null,"This rule will be applied to ",(0,i.kt)("inlineCode",{parentName:"p"},"example.org")," and subdomains pages and will execute the ",(0,i.kt)("inlineCode",{parentName:"p"},"abort-on-property-read")," scriptlet with the ",(0,i.kt)("inlineCode",{parentName:"p"},"alert")," parameter."),(0,i.kt)("p",null,"Learn more about ",(0,i.kt)("a",{parentName:"p",href:"#debug-scriptlets"},"how to debug scriptlets"),"."),(0,i.kt)("p",null,"More information about scriptlets can be found ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/Scriptlets#scriptlets"},"on GitHub"),"."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Scriptlet rules are not supported by AdGuard Content Blocker.")),(0,i.kt)("h3",{id:"trusted-scriptlets"},"Trusted scriptlets"),(0,i.kt)("p",null,"Trusted scriptlets are ",(0,i.kt)("a",{parentName:"p",href:"#scriptlets"},"scriptlets")," with extended functionality. It means the same syntax and restrictions. Trusted scriptlet names are prefixed with ",(0,i.kt)("inlineCode",{parentName:"p"},"trusted-"),", e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"trusted-set-cookie"),", to be easily distinguished from common scriptlets."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Trusted scriptlets are not compatible with other ad blockers except AdGuard.")),(0,i.kt)("admonition",{title:"Restrictions",type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Trusted scriptlets rules can be used ",(0,i.kt)("a",{parentName:"p",href:"#trusted-filters"},(0,i.kt)("strong",{parentName:"a"},"only in trusted filters")),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Trusted scriptlets rules are not supported by AdGuard Content Blocker.")),(0,i.kt)("p",null,"Learn more about ",(0,i.kt)("a",{parentName:"p",href:"#debug-scriptlets"},"how to debug scriptlets"),"."),(0,i.kt)("p",null,"More information about trusted scriptlets can be found ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/Scriptlets#trusted-scriptlets"},"on GitHub"),"."),(0,i.kt)("h2",{id:"non-basic-rules-modifiers"},"Modifiers for non-basic type of rules"),(0,i.kt)("p",null,"Each rule can be modified using the modifiers described in the following paragraphs."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")," {#non-basic-rules-modifiers-syntax}"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'rule = "[$" modifiers "]" [rule text]\nmodifiers = modifier0[, modifier1[, ...[, modifierN]]]\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"modifier"))," \u2014 set of the modifiers described below."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"rule text"))," \u2014 a rule to be modified.")),(0,i.kt)("p",null,"For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"[$domain=example.com,app=test_app]##selector"),"."),(0,i.kt)("p",null,"In the modifiers values, the following characters must be escaped: ",(0,i.kt)("inlineCode",{parentName:"p"},"["),", ",(0,i.kt)("inlineCode",{parentName:"p"},"]"),", ",(0,i.kt)("inlineCode",{parentName:"p"},","),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," (unless it is used for the escaping). Use ",(0,i.kt)("inlineCode",{parentName:"p"},"\\")," to escape them. For example, an escaped bracket looks like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"\\]"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Modifier \\ Products"),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for Windows, Mac, Android"},"CoreLibs apps")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Chrome and other Chromium-based browsers"},"AdGuard for Chromium")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Browser Extension for Firefox"},"AdGuard for Firefox")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard for iOS and AdGuard Pro for iOS"},"iOS\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"Safari\uc6a9 AdGuard"},"Safari\uc6a9 AdGuard")),(0,i.kt)("th",{parentName:"tr",align:"center"},(0,i.kt)("a",{parentName:"th",href:"#what-product",title:"AdGuard Content Blocker for Samsung Internet and Yandex Browser on Android"},"AdGuard \ucf58\ud150\uce20 \ucc28\ub2e8\uae30")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#non-basic-app-modifier"},"$app")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#non-basic-domain-modifier"},"$domain")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#non-basic-path-modifier"},"$path")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#non-basic-url-modifier"},"$url")),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u2705"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u23f3"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u23f3"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,i.kt)("td",{parentName:"tr",align:"center"},"\u274c")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u23f3 \u2014 feature that has been implemented or is planned to be implemented but is not yet available in any product"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"))),(0,i.kt)("h3",{id:"non-basic-app-modifier"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"$app"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$app")," modifier lets you narrow the rule coverage down to a specific application or a list of applications. The modifier's behavior and syntax perfectly match the corresponding ",(0,i.kt)("a",{parentName:"p",href:"#app-modifier"},"basic rules ",(0,i.kt)("inlineCode",{parentName:"a"},"$app")," modifier"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$app=org.example.app]example.com##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains in requests sent from the ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app")," Android app."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$app=~org.example.app1|~org.example.app2]example.com##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains in requests sent from any app except ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app1")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app2"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$app=com.apple.Safari]example.org#%#//scriptlet('prevent-setInterval', 'check', '!300')")," applies scriptlet ",(0,i.kt)("inlineCode",{parentName:"li"},"prevent-setInterval")," only in Safari browser on Mac."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$app=org.example.app]#@#.textad")," disables all ",(0,i.kt)("inlineCode",{parentName:"li"},"##.textad")," rules for all domains while using ",(0,i.kt)("inlineCode",{parentName:"li"},"org.example.app"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Such rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$app")," modifier are supported by AdGuard for Windows, Mac, and Android.")),(0,i.kt)("h3",{id:"non-basic-domain-modifier"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"$domain"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," modifier limits the rule application area to a list of domains and their subdomains. The modifier's behavior and syntax perfectly match the corresponding ",(0,i.kt)("a",{parentName:"p",href:"#domain-modifier"},"basic rules ",(0,i.kt)("inlineCode",{parentName:"a"},"$domain")," modifier"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$domain=example.com]##.textad")," \u2014 hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$domain=example.com|example.org]###adblock")," \u2014 hides an element with attribute ",(0,i.kt)("inlineCode",{parentName:"li"},"id")," equals ",(0,i.kt)("inlineCode",{parentName:"li"},"adblock")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and all subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$domain=~example.com]##.textad")," \u2014 this rule hides ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," elements of the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," for all domains, except ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and its subdomains.")),(0,i.kt)("p",null,"There are 2 ways to specify domain restrictions for non-basic rules:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},'the "classic" way is to specify domains before rule mask and attributes: ',(0,i.kt)("inlineCode",{parentName:"li"},"example.com##.textad"),";"),(0,i.kt)("li",{parentName:"ol"},"the modifier approach is to specify domains via ",(0,i.kt)("inlineCode",{parentName:"li"},"$domain")," modifier: ",(0,i.kt)("inlineCode",{parentName:"li"},"[$domain=example.com]##.textad"),".")),(0,i.kt)("p",null,"But rules with mixed style domains restriction are considered invalid. So, for example, the rule ",(0,i.kt)("inlineCode",{parentName:"p"},"[$domain=example.org]example.com##.textad")," will be ignored."),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Such rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$domain")," modifier are supported by AdGuard for Windows, Mac, Android, and AdGuard Browser Extension for Chrome, Firefox, Edge.")),(0,i.kt)("h3",{id:"non-basic-path-modifier"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"$path"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$path")," modifier limits the rule application area to specific locations or pages on websites."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'$path ["=" pattern]\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pattern")," \u2014 optional, a path mask to which the rule is restricted. Its syntax and behavior are pretty much the same as with the ",(0,i.kt)("a",{parentName:"p",href:"#basic-rules-syntax"},"pattern for basic rules"),". You can also use ",(0,i.kt)("a",{parentName:"p",href:"#basic-rules-special-characters"},"special characters"),", except for ",(0,i.kt)("inlineCode",{parentName:"p"},"||"),", which does not make any sense in this case (see examples below)."),(0,i.kt)("p",null,"If ",(0,i.kt)("inlineCode",{parentName:"p"},"pattern")," is not set for ",(0,i.kt)("inlineCode",{parentName:"p"},"$path"),", rule will apply only on the main page of website."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$path")," modifier matches the query string as well."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$path")," modifier supports regular expressions in ",(0,i.kt)("a",{parentName:"p",href:"#regexp-support"},"the same way")," basic rules do."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path=page.html]##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html?<query>")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/sub/page.html")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/another_page.html")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path=/page.html]##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html?<query>")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/sub/page.html")," of any domain but not at ",(0,i.kt)("inlineCode",{parentName:"li"},"/another_page.html")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path=|/page.html]##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html?<query>")," of any domain but not at ",(0,i.kt)("inlineCode",{parentName:"li"},"/sub/page.html")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path=/page.html|]##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/sub/page.html")," of any domain but not at ",(0,i.kt)("inlineCode",{parentName:"li"},"/page.html?<query>")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path=/page*.html]example.com##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"/page1.html")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"/page2.html")," or any other path matching ",(0,i.kt)("inlineCode",{parentName:"li"},"/page<...>.html")," of ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path]example.com##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at the main page of ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$domain=example.com,path=/page.html]##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"page.html")," of ",(0,i.kt)("inlineCode",{parentName:"li"},"example.com")," and all subdomains but not at ",(0,i.kt)("inlineCode",{parentName:"li"},"another_page.html")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$path=/\\\\/(sub1|sub2)\\\\/page\\\\.html/]##.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at both ",(0,i.kt)("inlineCode",{parentName:"li"},"/sub1/page.html")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"/sub2/page.html")," of any domain (please note the ",(0,i.kt)("a",{parentName:"li",href:"#non-basic-rules-modifiers-syntax"},"escaped special characters"),")")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with ",(0,i.kt)("inlineCode",{parentName:"p"},"$path")," modifier are not supported by AdGuard Content Blocker.")),(0,i.kt)("h3",{id:"non-basic-url-modifier"},(0,i.kt)("strong",{parentName:"h3"},(0,i.kt)("inlineCode",{parentName:"strong"},"$url"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"$url")," modifier limits the rule application area to URLs matching the specified mask."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},"url = pattern\n")),(0,i.kt)("p",null,"where ",(0,i.kt)("inlineCode",{parentName:"p"},"pattern")," is pretty much the same as ",(0,i.kt)("a",{parentName:"p",href:"#basic-rules-syntax"},(0,i.kt)("inlineCode",{parentName:"a"},"pattern")," of the basic rules")," assuming that ",(0,i.kt)("a",{parentName:"p",href:"#non-basic-rules-modifiers-syntax"},"some characters")," must be escaped. The ",(0,i.kt)("a",{parentName:"p",href:"#basic-rules-special-characters"},"special characters")," and ",(0,i.kt)("a",{parentName:"p",href:"#regexp-support"},"regular expressions")," are supported as well."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$url=||example.com/content/*]##div.textad")," hides a ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," with the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," at addresses like ",(0,i.kt)("inlineCode",{parentName:"li"},"https://example.com/content/article.html")," and even ",(0,i.kt)("inlineCode",{parentName:"li"},"https://subdomain.example.com/content/article.html"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$url=||example.org^]###adblock")," hides an element with attribute ",(0,i.kt)("inlineCode",{parentName:"li"},"id")," equal to ",(0,i.kt)("inlineCode",{parentName:"li"},"adblock")," at ",(0,i.kt)("inlineCode",{parentName:"li"},"example.org")," and its subdomains."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[$url=/\\[a-z\\]+\\\\.example\\\\.com^/]##.textad")," hides ",(0,i.kt)("inlineCode",{parentName:"li"},"div")," elements of the class ",(0,i.kt)("inlineCode",{parentName:"li"},"textad")," for all domains matching the regular expression ",(0,i.kt)("inlineCode",{parentName:"li"},"[a-z]+\\.example\\.com^"),".")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Rules with the ",(0,i.kt)("inlineCode",{parentName:"p"},"$url")," modifier are supported by AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"p",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.11 or later.")),(0,i.kt)("h2",{id:"information-for-filters-maintainers"},"Information for filters maintainers"),(0,i.kt)("p",null,"If you maintain a third-party filter that is known to AdGuard, you might be interested in the information presented in this section. Please note that hints will be applied to registered filters only. The filter is considered to be registered and known by AdGuard, if it is present in the ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/chromium/filters.json"},"known filters index"),". If you want your filter to be registered, please file an issue to ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/AdguardFilters"},"AdguardFilters repo"),"."),(0,i.kt)("h3",{id:"preprocessor-directives"},"Preprocessor directives"),(0,i.kt)("p",null,"We provide preprocessor directives that can be used by filters maintainers to improve compatibility with different ad blockers and provide:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#include-directive"},"including a file")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#conditions-directive"},"applying rules conditionally by ad blocker type")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#safari-affinity-directive"},"content blocker specifying for rules applying in Safari"))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Any mistake in a preprocessor directive will lead to AdGuard failing the filter update in the same way as if the filter URL was unavailable."),(0,i.kt)("p",{parentName:"admonition"},"Preprocessor directives can be used in the user rules or in the custom filters.")),(0,i.kt)("h4",{id:"include-directive"},"Including a file"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"!#include")," directive allows to include contents of a specified file into the filter. It supports only files from the same origin to make sure that the filter maintainer is in control of the specified file. The included file can also contain pre- directives (even other ",(0,i.kt)("inlineCode",{parentName:"p"},"!#include")," directives). Ad blockers should consider the case of recursive ",(0,i.kt)("inlineCode",{parentName:"p"},"!#include")," and implement a protection mechanism."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!#include file_path\n")),(0,i.kt)("p",null,"where ",(0,i.kt)("inlineCode",{parentName:"p"},"file_path")," is a same origin absolute or relative file path to be included."),(0,i.kt)("p",null,"The files must originate from the same domain but may be located in a different folder."),(0,i.kt)("p",null,"If included file is not found or unavailable, the whole filter update should fail."),(0,i.kt)("p",null,"Same-origin limitation should be disabled for local custom filters."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"Filter URL: ",(0,i.kt)("inlineCode",{parentName:"p"},"https://example.org/path/filter.txt")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! Valid (same origin):\n!#include https://example.org/path/includedfile.txt\n!\n! Valid (relative path):\n!#include /includedfile.txt\n!#include ../path2/includedfile.txt\n!\n! Invalid (another origin):\n!#include https://domain.com/path/includedfile.txt\n")),(0,i.kt)("h4",{id:"conditions-directive"},"Conditions"),(0,i.kt)("p",null,"Filters maintainers can use conditions to supply different rules depending on the ad blocker type. A conditional directive beginning with an ",(0,i.kt)("inlineCode",{parentName:"p"},"!#if")," directive must explicitly be terminated with an ",(0,i.kt)("inlineCode",{parentName:"p"},"!#endif")," directive. Conditions support all basic logical operators."),(0,i.kt)("p",null,"There are two possible scenarios:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"When an ad blocker encounters an ",(0,i.kt)("inlineCode",{parentName:"p"},"!#if")," directive and no ",(0,i.kt)("inlineCode",{parentName:"p"},"!#else")," directive, it will compile the code between ",(0,i.kt)("inlineCode",{parentName:"p"},"!#if")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"!#endif")," directives only if the specified condition is true.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If there is an ",(0,i.kt)("inlineCode",{parentName:"p"},"!#else")," directive, the code between ",(0,i.kt)("inlineCode",{parentName:"p"},"!#if")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"!#else")," will be compiled if the condition is true; otherwise, the code between ",(0,i.kt)("inlineCode",{parentName:"p"},"!#else")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"!#endif")," will be compiled."))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Whitespaces matter. ",(0,i.kt)("inlineCode",{parentName:"p"},"!#if")," is a valid directive, while ",(0,i.kt)("inlineCode",{parentName:"p"},"!# if")," is not.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!#if (conditions)\nrules_list\n!#endif\n")),(0,i.kt)("p",null,"or"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!#if (conditions)\ntrue_conditions_rules_list\n!#else\nfalse_conditions_rules_list\n!#endif\n")),(0,i.kt)("p",null,"where:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"!#if (conditions)")," \u2014 start of the block when conditions are true"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"conditions")," \u2014 just like in some popular programming languages, preprocessor conditions are based on constants declared by ad blockers. Authors of ad blockers define on their own what exact constants they declare. Possible values:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard")," always declared; shows maintainers that this is one of AdGuard products; should be enough in 95% of cases"),(0,i.kt)("li",{parentName:"ul"},"product-specific constants for cases when you need a rule to work (or not work \u2014 then ",(0,i.kt)("inlineCode",{parentName:"li"},"!")," should be used before constant) in a specific product only:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_app_windows")," \u2014 AdGuard for Windows"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_app_mac")," \u2014 AdGuard for Mac"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_app_android")," \u2014 AdGuard for Android"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_app_ios")," \u2014 AdGuard for iOS"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_ext_safari")," \u2014 AdGuard for Safari"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_ext_chromium")," \u2014 AdGuard Browser Extension for Chrome (and chromium-based browsers, e.g. new Microsoft Edge)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_ext_firefox")," \u2014 AdGuard Browser Extension for Firefox"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_ext_edge")," \u2014 AdGuard Browser Extension for Edge Legacy"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_ext_opera")," \u2014 AdGuard Browser Extension for Opera"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"adguard_ext_android_cb")," \u2014 AdGuard Content Blocker for mobile Samsung and Yandex browsers"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ext_ublock")," \u2014 special case; this one is declared when a uBlock version of a filter is compiled by the ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/FiltersRegistry"},"FiltersRegistry")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"cap_html_filtering")," \u2014 products that support HTML filtering rules: AdGuard for Windows, AdGuard for Mac, and AdGuard for Android"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"!#else")," \u2014 start of the block when conditions are false"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rules_list"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"true_conditions_rules_list"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"false_conditions_rules_list")," \u2014 lists of rules"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"!#endif")," \u2014 end of the block")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! for all AdGuard products except AdGuard for Safari\n!#if (adguard && !adguard_ext_safari)\n||example.org^$third-party\ndomain.com##div.ad\n!#endif\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! directives even can be combined\n!#if (adguard_app_android)\n!#include /androidspecific.txt\n!#endif\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!#if (adguard && !adguard_ext_safari)\n! for all AdGuard products except AdGuard for Safari\n||example.org^$third-party\ndomain.com##div.ad\n!#else\n! for AdGuard for Safari only\n||subdomain.example.org^$third-party\n!#endif\n")),(0,i.kt)("admonition",{title:"Compatibility",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"!#else")," directive is supported by the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/FiltersDownloader"},"FiltersDownloader")," v1.1.20 or later."),(0,i.kt)("p",{parentName:"admonition"},"It is already supported for filter lists compiled by the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/FiltersRegistry"},"FiltersRegistry"),", but it still may not be supported by AdGuard products when adding a filter list with ",(0,i.kt)("inlineCode",{parentName:"p"},"!#else")," as a custom one. The following products will support it in the mentioned versions or later:"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"AdGuard for Windows, Mac, and Android with ",(0,i.kt)("a",{parentName:"li",href:"https://adguard.com/en/blog/introducing-corelibs.html"},"CoreLibs")," v1.13;"),(0,i.kt)("li",{parentName:"ul"},"AdGuard Browser Extension v4.2.208;"),(0,i.kt)("li",{parentName:"ul"},"AdGuard v1.11.16 for Safari."))),(0,i.kt)("h4",{id:"safari-affinity-directive"},"Safari affinity"),(0,i.kt)("p",null,"Safari's limit for each content blocker is 150,000 active rules. But in AdGuard for Safari and AdGuard for iOS, we've split the rules into 6 content blockers, thus increasing the rule limit to 900,000."),(0,i.kt)("p",null,"Here is the composition of each content blocker:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"AdGuard General \u2014 Ad Blocking, Language-specific"),(0,i.kt)("li",{parentName:"ul"},"AdGuard Privacy \u2014 Privacy"),(0,i.kt)("li",{parentName:"ul"},"AdGuard Social \u2014 Social Widgets, Annoyances"),(0,i.kt)("li",{parentName:"ul"},"AdGuard Security \u2014 Security"),(0,i.kt)("li",{parentName:"ul"},"AdGuard Other \u2014 Other"),(0,i.kt)("li",{parentName:"ul"},"AdGuard Custom \u2014 Custom")),(0,i.kt)("p",null,"User rules and allowlist are added to every content blocker."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"The main disadvantage of using multiple content blockers is that rules from different blockers are applied independently. Blocking rules are not affected by this, but unblocking rules may cause problems. If a blocking rule is in one content blocker and an exception is in another, the exception will not work. Filter maintainers use ",(0,i.kt)("inlineCode",{parentName:"p"},"!#safari_cb_affinity")," to define Safari content blocker affinity for the rules inside of the directive block.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!#safari_cb_affinity(content_blockers)\nrules_list\n!#safari_cb_affinity\n")),(0,i.kt)("p",null,"where:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"!#safari_cb_affinity(content_blockers)")," \u2014 start of the block"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"content_blockers")," \u2014 comma-separated list of content blockers. Possible values:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"general")," \u2014 AdGuard General content blocker"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"privacy")," \u2014 AdGuard Privacy content blocker"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"social")," \u2014 AdGuard Social content blocker"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"security")," \u2014 AdGuard Security content blocker"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"other")," \u2014 AdGuard Other content blocker"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"custom")," \u2014 AdGuard Custom content blocker"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"all")," \u2014 special keyword that means that the rules must be included into ",(0,i.kt)("strong",{parentName:"li"},"all")," content blockers"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rules_list")," \u2014 list of rules"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"!#safari_cb_affinity")," \u2014 end of the block")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! to unhide specific element which is hidden by AdGuard Base filter:\n!#safari_cb_affinity(general)\nexample.org#@#.adBanner\n!#safari_cb_affinity\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"! to allowlist basic rule from AdGuard Tracking Protection filter:\n!#safari_cb_affinity(privacy)\n@@||example.org^\n!#safari_cb_affinity\n")),(0,i.kt)("h3",{id:"hints"},"Hints"),(0,i.kt)("p",null,'"Hint" is a special comment, instruction to the filters compiler used on the server side (see ',(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/FiltersRegistry"},"FiltersRegistry"),")."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Syntax")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!+ HINT_NAME1(PARAMS) HINT_NAME2(PARAMS)\n")),(0,i.kt)("p",null,"Multiple hints can be applied."),(0,i.kt)("h4",{id:"not_optimized-hint"},(0,i.kt)("inlineCode",{parentName:"h4"},"NOT_OPTIMIZED")," hint"),(0,i.kt)("p",null,"For each filter, AdGuard compiles two versions: full and optimized. Optimized version is much more lightweight and does not contain rules which are not used at all or used rarely."),(0,i.kt)("p",null,"Rules usage frequency comes from the collected ",(0,i.kt)("a",{parentName:"p",href:"../tracking-filter-statistics"},"filter rules statistics"),". But filters optimization is based on more than that \u2014 some filters have specific configuration. This is how it looks like for Base filter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'"filter": AdGuard Base filter,\n"percent": 30,\n"minPercent": 20,\n"maxPercent": 40,\n"strict": true\n')),(0,i.kt)("p",null,"where:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"filter")," \u2014 filter identifier"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"percent")," \u2014 expected optimization percent ",(0,i.kt)("inlineCode",{parentName:"li"},"~= (rules count in optimized filter) / (rules count in original filter) * 100")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"minPercent")," \u2014 lower bound of ",(0,i.kt)("inlineCode",{parentName:"li"},"percent")," value"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"maxPercent")," \u2014 upper bound of ",(0,i.kt)("inlineCode",{parentName:"li"},"percent")," value"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"strict")," \u2014 if ",(0,i.kt)("inlineCode",{parentName:"li"},"percent < minPercent")," OR ",(0,i.kt)("inlineCode",{parentName:"li"},"percent > maxPercent")," and strict mode is on then filter compilation should fail, otherwise original rules must be used")),(0,i.kt)("p",null,"In other words, ",(0,i.kt)("inlineCode",{parentName:"p"},"percent"),' is the "compression level". For instance, for the Base filter it is configured to 40%. It means that optimization algorithm should strip 60% of rules.'),(0,i.kt)("p",null,"Eventually, here are the two versions of the Base filter for AdGuard Browser Extension:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"full: ",(0,i.kt)("a",{parentName:"li",href:"https://filters.adtidy.org/extension/chromium/filters/2.txt"},"https://filters.adtidy.org/extension/chromium/filters/2.txt")),(0,i.kt)("li",{parentName:"ul"},"optimized: ",(0,i.kt)("a",{parentName:"li",href:"https://filters.adtidy.org/extension/chromium/filters/2_optimized.txt"},"https://filters.adtidy.org/extension/chromium/filters/2_optimized.txt"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"If you want to add a rule which should not be removed at optimization use the ",(0,i.kt)("inlineCode",{parentName:"strong"},"NOT_OPTIMIZED")," hint:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!+ NOT_OPTIMIZED\n||example.org^\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"And this rule will not be optimized only for AdGuard for Android:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!+ NOT_OPTIMIZED PLATFORM(android)\n||example.org^\n")),(0,i.kt)("h4",{id:"platform-and-not_platform-hints"},(0,i.kt)("inlineCode",{parentName:"h4"},"PLATFORM")," and ",(0,i.kt)("inlineCode",{parentName:"h4"},"NOT_PLATFORM")," hints"),(0,i.kt)("p",null,"Used to specify the platforms to apply the rules. List of existing platforms and links to Base filter, for example, for each of them:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"windows")," \u2014 AdGuard for Windows \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/windows/filters/2.txt"},"https://filters.adtidy.org/windows/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"mac")," \u2014 AdGuard for Mac \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/mac_v2/filters/2.txt"},"https://filters.adtidy.org/mac_v2/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"android")," \u2014 AdGuard for Android \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/android/filters/2.txt"},"https://filters.adtidy.org/android/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ios")," \u2014 AdGuard for iOS \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/ios/filters/2.txt"},"https://filters.adtidy.org/ios/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_chromium")," \u2014 AdGuard Browser Extension for Chrome \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/chromium/filters/2.txt"},"https://filters.adtidy.org/extension/chromium/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_chromium_mv3")," \u2014 AdGuard Browser Extension for Chrome MV3 \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/chromium-mv3/filters/2.txt"},"https://filters.adtidy.org/extension/chromium-mv3/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_ff")," \u2014 AdGuard Browser Extension for Firefox \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/firefox/filters/2.txt"},"https://filters.adtidy.org/extension/firefox/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_edge")," \u2014 AdGuard Browser Extension for Edge \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/edge/filters/2.txt"},"https://filters.adtidy.org/extension/edge/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_opera")," \u2014 AdGuard Browser Extension for Opera \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/opera/filters/2.txt"},"https://filters.adtidy.org/extension/opera/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_safari")," \u2014 AdGuard for Safari \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/safari/filters/2.txt"},"https://filters.adtidy.org/extension/safari/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_android_cb")," \u2014 AdGuard Content Blocker \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/android-content-blocker/filters/2.txt"},"https://filters.adtidy.org/extension/android-content-blocker/filters/2.txt"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"ext_ublock")," \u2014 uBlock Origin \u2014 ",(0,i.kt)("a",{parentName:"p",href:"https://filters.adtidy.org/extension/ublock/filters/2.txt"},"https://filters.adtidy.org/extension/ublock/filters/2.txt")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,"This rule will be available only in AdGuard for Windows, Mac, Android:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!+ PLATFORM(windows,mac,android)\n||example.org^\n")),(0,i.kt)("p",null,"Except for AdGuard for Safari, AdGuard Content Blocker, and AdGuard for iOS, this rule is available on all platforms:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"!+ NOT_PLATFORM(ext_safari, ext_android_cb, ios)\n||example.org^\n")),(0,i.kt)("h2",{id:"how-to-debug-filtering-rules"},"How to debug filtering rules"),(0,i.kt)("p",null,'It may be possible to create simple filtering rules "in your head" but for anything even slightly more complicated you will need additional tools to debug and iterate them. There are tools to assist you with that. You can use DevTools in Chrome and its analogs in other browsers but most AdGuard products provide another one \u2014 Filtering log.'),(0,i.kt)("h3",{id:"filtering-log"},"Filtering log"),(0,i.kt)("p",null,"Filtering log is an advanced tool that will be helpful mostly to filter developers. It lists all web requests that pass through AdGuard, gives you exhaustive information on each of them, offers multiple sorting options, and has other useful features."),(0,i.kt)("p",null,"Depending on which AdGuard product you are using, Filtering log can be located in different places."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"In ",(0,i.kt)("strong",{parentName:"li"},"AdGuard for Windows"),", you can find it in the ",(0,i.kt)("em",{parentName:"li"},"Ad Blocker")," tab or via the tray menu"),(0,i.kt)("li",{parentName:"ul"},"In ",(0,i.kt)("strong",{parentName:"li"},"AdGuard for Mac"),", it is located in ",(0,i.kt)("em",{parentName:"li"},"Settings \u2192 Advanced \u2192 Filtering log")),(0,i.kt)("li",{parentName:"ul"},"In ",(0,i.kt)("strong",{parentName:"li"},"AdGuard for Android"),", you can find it under ",(0,i.kt)("em",{parentName:"li"},"Statistics \u2192 Recent activity"),". ",(0,i.kt)("em",{parentName:"li"},"Recent activity")," can also be accessed from the ",(0,i.kt)("em",{parentName:"li"},"Assistant")),(0,i.kt)("li",{parentName:"ul"},"In ",(0,i.kt)("strong",{parentName:"li"},"AdGuard Browser Extension"),", it is accessible from the ",(0,i.kt)("em",{parentName:"li"},"Miscellaneous")," settings tab or by right-clicking the extension icon. Only Chromium- and Firefox-based web browsers show applied ",(0,i.kt)("strong",{parentName:"li"},"element hiding rules")," (including CSS, ExtCSS) and ",(0,i.kt)("strong",{parentName:"li"},"JS rules and scriptlets")," in their Filtering logs")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"In ",(0,i.kt)("strong",{parentName:"p"},"AdGuard for iOS")," and ",(0,i.kt)("strong",{parentName:"p"},"AdGuard for Safari"),", Filtering log does not exist because of the way content blockers are implemented in Safari. AdGuard does not see the web requests and therefore cannot display them.")),(0,i.kt)("h3",{id:"selectors-debug-mode"},"Selectors debugging mode"),(0,i.kt)("p",null,"Sometimes, you might need to check the performance of a given selector or a stylesheet. In order to do it without interacting with JavaScript directly, you can use a special ",(0,i.kt)("inlineCode",{parentName:"p"},"debug")," style property. When ",(0,i.kt)("inlineCode",{parentName:"p"},"ExtendedCss")," meets this property, it enables the debugging mode either for a single selector or for all selectors, depending on the ",(0,i.kt)("inlineCode",{parentName:"p"},"debug")," value."),(0,i.kt)("p",null,"Open the browser console while on a web page to see the timing statistics for selector(s) that were applied there. Debugging mode displays the following stats as object where each of the debugged selectors are keys, and value is an object with such properties:"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Always printed:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"selectorParsed")," \u2014 text of eventually parsed selector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"timings")," \u2014 list of DOM nodes matched by the selector",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"appliesCount")," \u2014 total number of times that the selector has been applied on the page"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"appliesTimings")," \u2014 time that it took to apply the selector on the page, for each of the instances that it has been applied (in milliseconds)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"meanTiming")," \u2014 mean time that it took to apply the selector on the page"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"standardDeviation")," \u2014 standard deviation"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"timingsSum")," \u2014 total time it took to apply the selector on the page across all instances")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Printed only for remove pseudos:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"removed")," \u2014 flag to signal if elements were removed")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Printed if elements are not removed:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"matchedElements")," \u2014 list of DOM nodes matched by the selector"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"styleApplied")," \u2014 parsed rule style declaration related to the selector")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Debugging a single selector:")),(0,i.kt)("p",null,"When the value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"debug")," property is ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", only information about this selector will be shown in the browser console."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"#$?#.banner { display: none; debug: true; }\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Enabling global debug:")),(0,i.kt)("p",null,"When the value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"debug")," property is ",(0,i.kt)("inlineCode",{parentName:"p"},"global"),", the console will display information about all extended CSS selectors that have matches on the current page, for all the rules from any of the enabled filters."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-adblock"},"#$?#.banner { display: none; debug: global; }\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Testing extended selectors without AdGuard")),(0,i.kt)("p",null,"ExtendedCss can be executed on any page without using any AdGuard product. In order to do that you should copy and execute the following code in a browser console:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'!function(e,t,d){C=e.createElement(t),C.src=d,C.onload=function(){alert("ExtendedCss loaded successfully")},s=e.getElementsByTagName(t)[0],s?s.parentNode.insertBefore(C,s):(h=e.getElementsByTagName("head")[0],h.appendChild(C))}(document,"script","https://AdguardTeam.github.io/ExtendedCss/extended-css.min.js");\n')),(0,i.kt)("p",null,"Alternatively, install the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/Userscripts/blob/master/extendedCssDebugger/extended-css.debugger.user.js"},"ExtendedCssDebugger userscript"),"."),(0,i.kt)("p",null,"Now you can now use the ",(0,i.kt)("inlineCode",{parentName:"p"},"ExtendedCss")," from global scope, and run its method ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/AdguardTeam/ExtendedCss#extended-css-query"},(0,i.kt)("inlineCode",{parentName:"a"},"query()"))," as ",(0,i.kt)("inlineCode",{parentName:"p"},"Document.querySelectorAll()"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Examples")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const selector = 'div.block:has=(.header:matches-css(after, content: Ads))';\n\n// array of HTMLElements matched the `selector` is to be returned\nExtendedCss.query(selector);\n")),(0,i.kt)("h3",{id:"debug-scriptlets"},"Debugging scriptlets"),(0,i.kt)("p",null,"If you are using AdGuard Browser Extension and want to debug a ",(0,i.kt)("a",{parentName:"p",href:"#scriptlets"},"scriptlet")," or a ",(0,i.kt)("a",{parentName:"p",href:"#trusted-scriptlets"},"trusted scriptlet")," rule, you can get additional information by opening the Filtering log. In that case, scriptlets will switch to debug mode and there will be more information in the browser console."),(0,i.kt)("p",null,"The following scriptlets are especially developed for debug purposes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#debug-current-inline-script"},(0,i.kt)("inlineCode",{parentName:"a"},"debug-current-inline-script"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#debug-on-property-read"},(0,i.kt)("inlineCode",{parentName:"a"},"debug-on-property-read"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#abort-on-property-write"},(0,i.kt)("inlineCode",{parentName:"a"},"debug-on-property-write"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log-addEventListener"},(0,i.kt)("inlineCode",{parentName:"a"},"log-addEventListener"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log-on-stack-trace"},(0,i.kt)("inlineCode",{parentName:"a"},"log-on-stack-trace"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log-eval"},(0,i.kt)("inlineCode",{parentName:"a"},"log-eval"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#log"},(0,i.kt)("inlineCode",{parentName:"a"},"log")))),(0,i.kt)("p",null,"The following scriptlets also may be used for debug purposes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#json-prune"},(0,i.kt)("inlineCode",{parentName:"a"},"json-prune"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-fetch"},(0,i.kt)("inlineCode",{parentName:"a"},"prevent-fetch"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-requestanimationframe"},(0,i.kt)("inlineCode",{parentName:"a"},"prevent-requestAnimationFrame"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-setinterval"},(0,i.kt)("inlineCode",{parentName:"a"},"prevent-setInterval"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-settimeout"},(0,i.kt)("inlineCode",{parentName:"a"},"prevent-setTimeout"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-window-open"},(0,i.kt)("inlineCode",{parentName:"a"},"prevent-window-open"))," with specified ",(0,i.kt)("inlineCode",{parentName:"li"},"replacement")," parameter"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-scriptlets.md#prevent-xhr"},(0,i.kt)("inlineCode",{parentName:"a"},"prevent-xhr"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-trusted-scriptlets.md#trusted-replace-fetch-response"},(0,i.kt)("inlineCode",{parentName:"a"},"trusted-replace-fetch-response"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/AdguardTeam/Scriptlets/blob/master/wiki/about-trusted-scriptlets.md#trusted-replace-xhr-response"},(0,i.kt)("inlineCode",{parentName:"a"},"trusted-replace-xhr-response")))),(0,i.kt)("h2",{id:"compatibility-tables-legend"},"Compatibility tables legend"),(0,i.kt)("h3",{id:"what-product"},"Product shortcuts"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"CoreLibs apps")," \u2014 AdGuard for Windows, AdGuard for Mac, and AdGuard for Android"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard for Chromium")," \u2014 AdGuard Browser Extension for Chrome and other Chromium-based browsers such as Microsoft Edge, Opera"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard for Firefox")," \u2014 AdGuard Browser Extension for Firefox"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard for iOS")," \u2014 AdGuard for iOS and AdGuard Pro for iOS (for mobile Safari browser)"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard for Safari")," \u2014 AdGuard for desktop Safari browser ",(0,i.kt)("inlineCode",{parentName:"li"},"AdGuard Content Blocker")," \u2014 Content Blocker for Android mobile browsers: Samsung Internet and Yandex Browser")),(0,i.kt)("h3",{id:"what-compatibility"},"Compatibility shortcuts"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"\u2705 \u2014 fully supported"),(0,i.kt)("li",{parentName:"ul"},"\u2705 * \u2014 supported, but reliability may vary or limitations may occur; check the modifier description for more details"),(0,i.kt)("li",{parentName:"ul"},"\ud83e\udde9 \u2014 may already be implemented in nightly or beta versions but is not yet supported in release versions"),(0,i.kt)("li",{parentName:"ul"},"\u23f3 \u2014 feature that has been implemented or is planned to be implemented but is not yet available in any product"),(0,i.kt)("li",{parentName:"ul"},"\u274c \u2014 not supported"),(0,i.kt)("li",{parentName:"ul"},"\ud83d\udc4e \u2014 deprecated; still supported but will be removed in the future"),(0,i.kt)("li",{parentName:"ul"},"\ud83d\udeab \u2014 removed and no longer supported"))))}m.isMDXComponent=!0}}]);